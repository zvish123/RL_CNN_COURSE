<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<title>××¦×’×ª ××™× ×˜×¨××§×˜×™×‘×™×ª â€“ Win32 API ×‘×¤×™×™×ª×•×Ÿ</title>

<style>
    body { font-family: 'Segoe UI', Tahoma; margin: 30px; background:#fafafa; }
    h1,h2,h3 { color:#1a237e; }
    .card {
        background:white; padding:20px; border-radius:12px;
        box-shadow:0 0 10px rgba(0,0,0,0.15); margin-bottom:20px;
    }
    button {
        padding:7px 14px; border:none; border-radius:8px;
        background:#3949ab; color:white; cursor:pointer;
        margin-top:10px;
    }
    pre {
        background:#212121;
        color:#e3e3e3;
        padding:18px;
        border-radius:8px;
        overflow-x:auto;
        font-size:15px;        /* â† ×¤×•× ×˜ ××•×’×“×œ */
        direction:ltr;
        text-align:left;
        line-height:1.4;
    }
    .hidden {
        display:none; !important;  /* â† ×©×œ×™×˜×” ××•×—×œ×˜×ª */
    }
</style>

<script>
function toggle(id){
    const el = document.getElementById(id);
    el.classList.toggle("hidden");
}
</script>
</head>
<body>

<h1>ğŸ› Win32 API â€“ ××¦×’×ª ××™× ×˜×¨××§×˜×™×‘×™×ª ×œ×ª×œ××™×“</h1>
<p>×©×™××•×©×™× ×××™×ª×™×™×, ×“×•×’×××•×ª ××ª×§×“××•×ª, ×•×§×•×“ ×©××™ ××¤×©×¨ ×œ×‘×¦×¢ ×‘×©×•× ×“×¨×š ××—×¨×ª.</p>



<!--  SLIDE: ××” ×–×” WinAPI -->
<div class="card">
<h2>××” ×–×” Win32 API?</h2>
<p>
Win32 API ×”×•× ×××©×§ ×”×ª×›× ×•×ª ×”×¨×©××™ ×©×œ Windows ×”×××¤×©×¨ ×©×œ×™×˜×” ××œ××” ×‘××¢×¨×›×ª ×”×”×¤×¢×œ×”:
×—×œ×•× ×•×ª, ×ª×”×œ×™×›×™×, ×¨×©×ª, ×§×‘×¦×™×, ×¨×’'×™×¡×˜×¨×™, ×”×¨×©××•×ª ×•×¢×•×“.
</p>

<button onclick="toggle('why')">×”×¦×’ ×™×ª×¨×•× ×•×ª</button>
<div id="why" class="hidden">
<ul>
<li>××¤×©×¨×•×™×•×ª ×©×œ×™×˜×” ×©××™×Ÿ ×œ×©×•× ×©×¤×” ×¨×’×™×œ×” (Python/Java/C#)</li>
<li>×‘×™×¦×•×¢×™× ×’×‘×•×”×™× ×•×’×™×©×” ×œÖ¾Kernel</li>
<li>×©×™××•×© ×‘×›×œ×™ ××¢×¨×›×ª ×¤× ×™××™×™×</li>
<li>×—×™×•× ×™ ×œ××•×˜×•××¦×™×”, ××‘×˜×—×” ×•×¡×™×™×‘×¨</li>
</ul>
</div>
</div>



<!-- SLIDE ×—×œ×•× ×•×ª -->
<div class="card">
<h2>×©×œ×™×˜×” ×‘×—×œ×•× ×•×ª â€“ ×©×™× ×•×™ ×˜×§×¡×˜, ××™×§×•×, ××™×§×•×“</h2>

<button onclick="toggle('win_code1')">×”×¦×’ ×§×•×“</button>
<div id="win_code1" class="hidden">
<pre>
import win32gui
import win32con

hwnd = win32gui.FindWindow(None, "××—×©×‘×•×Ÿ")
if hwnd:
    win32gui.SetWindowText(hwnd, "××—×©×‘×•×Ÿ â€“ ×›×•×ª×¨×ª ×—×“×©×”")
    win32gui.MoveWindow(hwnd, 200, 200, 400, 300, True)
    win32gui.SetForegroundWindow(hwnd)
else:
    print("×”×—×œ×•×Ÿ ×œ× × ××¦×")
</pre>
</div>
</div>



<!-- SLIDE messagebox -->
<div class="card">
<h2>×—×œ×•×Ÿ ×”×•×“×¢×” â€“ MessageBox</h2>

<button onclick="toggle('msgbox')">×”×¦×’ ×§×•×“</button>
<div id="msgbox" class="hidden">
<pre>
import win32gui
import win32con

result = win32gui.MessageBox(
    0, "×”×× ×œ×”××©×™×š?",
    "××™×©×•×¨",
    win32con.MB_YESNO | win32con.MB_ICONQUESTION |
    win32con.MB_RTLREADING | win32con.MB_RIGHT
)
</pre>
</div>
</div>



<!-- SLIDE files -->
<div class="card">
<h2>×’×™×©×” ×œ×§×‘×¦×™× ×‘×¨××ª ××¢×¨×›×ª</h2>

<button onclick="toggle('files')">×”×¦×’ ×§×•×“</button>
<div id="files" class="hidden">
<pre>
import win32file
import win32con

h = win32file.CreateFile(
    r"C:\example.txt",
    win32con.GENERIC_WRITE,
    0, None,
    win32con.CREATE_ALWAYS,
    win32con.FILE_ATTRIBUTE_NORMAL,
    None
)
win32file.WriteFile(h, b"Hello from WinAPI!")
win32file.CloseHandle(h)
</pre>
</div>
</div>



<!-- SLIDE registry -->
<div class="card">
<h2>×¢×‘×•×“×” ×¢× ×¨×’'×™×¡×˜×¨×™</h2>

<button onclick="toggle('reg')">×”×¦×’ ×§×•×“</button>
<div id="reg" class="hidden">
<pre>
import winreg

key = winreg.OpenKey(
    winreg.HKEY_CURRENT_USER,
    r"Software\Microsoft\Windows\CurrentVersion\Run",
    0,
    winreg.KEY_READ | winreg.KEY_WRITE
)

value, type_id = winreg.QueryValueEx(key, "ExampleApp")
print(value)
</pre>
</div>
</div>



<!-- SLIDE network -->
<div class="card">
<h2>×©×™×¨×•×ª×™ ×¨×©×ª â€“ SMB, Winsock, ××™×¤×•×™ ×›×•× × ×™×</h2>

<button onclick="toggle('net')">×”×¦×’ ×§×•×“</button>
<div id="net" class="hidden">
<pre>
import win32wnet

win32wnet.WNetAddConnection2(
    0, None,
    r"\\SERVER\SharedFolder",
    "Z:"
)
print("××—×•×‘×¨ ×œ×›×•× ×Ÿ ×¨×©×ª")
</pre>
</div>
</div>




<!-- =============================== -->
<!-- === REAL IMPOSSIBLE USE-CASES === -->
<!-- =============================== -->

<h1>ğŸš€ ×©×™××•×©×™× ×××™×ª×™×™× â€“ ×“×‘×¨×™× ×©××™ ××¤×©×¨ ×œ×‘×¦×¢ ×œ×œ× WinAPI</h1>


<!-- 1. Hook ××§×œ×“×ª -->
<div class="card">
<h2>1. Hook ×œ××§×œ×“×ª â€“ ×™×™×¨×•×˜ ×›×œ ×”×”×§×œ×“×•×ª ×‘××¢×¨×›×ª</h2>

<p>× ×™×ª×Ÿ ×¨×§ ×¢× WinAPI (SetWindowsHookEx) â€“ ××™×Ÿ ×œ×–×” ××§×‘×™×œ×” ×‘×¤×™×™×ª×•×Ÿ/Java.</p>

<button onclick="toggle('hook')">×”×¦×’ ×§×•×“</button>
<div id="hook" class="hidden">
<pre>
import ctypes
import ctypes.wintypes as wintypes

WH_KEYBOARD_LL = 13
WM_KEYDOWN = 0x0100

user32 = ctypes.windll.user32
kernel32 = ctypes.windll.kernel32

def low_level_kb(nCode, wParam, lParam):
    if wParam == WM_KEYDOWN:
        key = ctypes.cast(lParam, ctypes.POINTER(ctypes.c_ulong)).contents.value
        print("Key:", key)
    return user32.CallNextHookEx(None, nCode, wParam, lParam)

HOOKPROC = ctypes.WINFUNCTYPE(ctypes.c_int, ctypes.c_int, ctypes.c_int, ctypes.c_void_p)
hook = user32.SetWindowsHookExW(WH_KEYBOARD_LL, HOOKPROC(low_level_kb),
                                kernel32.GetModuleHandleW(None), 0)

msg = wintypes.MSG()
user32.GetMessageW(ctypes.byref(msg), 0, 0, 0)
</pre>
</div>
</div>



<!-- 2. IP Helper API -->
<div class="card">
<h2>2. ×’×™×©×” ×œ×˜×‘×œ×ª TCP/UDP ××§×¨× ×œ Windows (IPHelper API)</h2>

<button onclick="toggle('iphelper')">×”×¦×’ ×§×•×“</button>
<div id="iphelper" class="hidden">
<pre>
import ctypes
from ctypes import wintypes

iphlp = ctypes.windll.iphlpapi

class MIB_TCPROW_OWNER_PID(ctypes.Structure):
    _fields_ = [
        ("state", wintypes.DWORD),
        ("localAddr", wintypes.DWORD),
        ("localPort", wintypes.DWORD),
        ("remoteAddr", wintypes.DWORD),
        ("remotePort", wintypes.DWORD),
        ("owningPid", wintypes.DWORD),
    ]

buffer = ctypes.create_string_buffer(65535)
size = wintypes.DWORD(len(buffer))

iphlp.GetExtendedTcpTable(buffer, ctypes.byref(size), False, 2, 5, 0)
table = ctypes.cast(buffer, ctypes.POINTER(MIB_TCPROW_OWNER_PID)).contents
</pre>
</div>
</div>



<!-- 3. ×©×™× ×•×™ ×›×•×ª×¨×ª ×—×œ×•×Ÿ ×©×œ ×ª×•×›× ×” ×–×¨×” -->
<div class="card">
<h2>3. ×©×™× ×•×™ ×›×•×ª×¨×ª ×—×œ×•×Ÿ ×©×œ ×ª×•×›× ×” ×–×¨×”</h2>

<button onclick="toggle('titleset')">×”×¦×’ ×§×•×“</button>
<div id="titleset" class="hidden">
<pre>
import ctypes

user32 = ctypes.windll.user32

hwnd = user32.FindWindowW(None, "Notepad")
if hwnd:
    user32.SetWindowTextW(hwnd, "Controlled by Python!")
</pre>
</div>
</div>



<!-- 4. Named Pipe -->
<div class="card">
<h2>4. Named Pipes â€“ IPC ×××™×ª×™ ×©×œ Windows</h2>

<button onclick="toggle('pipe')">×”×¦×’ ×§×•×“</button>
<div id="pipe" class="hidden">
<pre>
import win32pipe, win32file

pipe = win32pipe.CreateNamedPipe(
    r'\\.\pipe\MyPipe',
    win32pipe.PIPE_ACCESS_DUPLEX,
    win32pipe.PIPE_TYPE_MESSAGE | win32pipe.PIPE_WAIT,
    1, 65536, 65536, 0, None
)

win32pipe.ConnectNamedPipe(pipe, None)
print("Client connected!")
win32file.WriteFile(pipe, b"Hello Pipe!")
</pre>
</div>
</div>



<!-- 5. Impersonation -->
<div class="card">
<h2>5. Impersonation â€“ ×¨×™×¦×” ×›××©×ª××© ××—×¨</h2>

<button onclick="toggle('imp')">×”×¦×’ ×§×•×“</button>
<div id="imp" class="hidden">
<pre>
import win32security
import win32con

token = win32security.LogonUser(
    "Administrator",
    ".",
    "Password123",
    win32con.LOGON32_LOGON_INTERACTIVE,
    win32con.LOGON32_PROVIDER_DEFAULT
)
win32security.ImpersonateLoggedOnUser(token)
print("Now running as Administrator!")
</pre>
</div>
</div>




<!-- 6. Enumerate Hidden Processes -->
<div class="card">
<h2>6. ×”×©×’×ª ×¨×©×™××ª ×ª×”×œ×™×›×™× ×›×•×œ×œ ××•×¡×ª×¨×™×</h2>

<button onclick="toggle('proc_list')">×”×¦×’ ×§×•×“</button>
<div id="proc_list" class="hidden">
<pre>
import win32process
import win32api

for pid in win32process.EnumProcesses():
    try:
        h = win32api.OpenProcess(0x0400 | 0x0010, False, pid)
        print(pid, win32process.GetModuleFileNameEx(h, 0))
        win32api.CloseHandle(h)
    except:
        pass
</pre>
</div>
</div>




<!-- 7. ××—×™×§×ª ×§×•×‘×¥ × ×¢×•×œ -->
<div class="card">
<h2>7. ××—×™×§×ª ×§×•×‘×¥ "× ×¢×•×œ" ×¢"×™ ×ª×”×œ×™×š ××—×¨</h2>

<button onclick="toggle('locked')">×”×¦×’ ×§×•×“</button>
<div id="locked" class="hidden">
<pre>
import win32file
import win32con

h = win32file.CreateFile(
    r"C:\locked.txt",
    win32con.GENERIC_WRITE,
    win32con.FILE_SHARE_DELETE | win32con.FILE_SHARE_READ |
    win32con.FILE_SHARE_WRITE,
    None,
    win32con.OPEN_EXISTING,
    win32con.FILE_FLAG_DELETE_ON_CLOSE,
    None
)

print("File will be deleted when all handles close")
win32file.CloseHandle(h)
</pre>
</div>
</div>



<!-- ×©××œ×•×ª -->
<div class="card">
<h2>×©××œ×•×ª ×œ×“×™×•×Ÿ ×‘×›×™×ª×”</h2>
<ul>
<li>×œ××” ××™ ××¤×©×¨ ×œ×‘×¦×¢ Hook ×œ××§×œ×“×ª ×‘×œ×™ WinAPI?</li>
<li>××” ×”×”×‘×“×œ ×‘×™×Ÿ IPC ×¨×’×™×œ ×œÖ¾Named Pipes?</li>
<li>×œ××” ×’×™×©×ª ×¨×’'×™×¡×˜×¨×™ ×§×¨×™×˜×™×ª ×¢×‘×•×¨ ×›×œ×™ ×¡×™×™×‘×¨?</li>
<li>×œ××” ×“×¤×“×¤×Ÿ ××• Java ×œ× ×™×›×•×œ×™× ×œ×§×¨×•× ××ª ×˜×‘×œ××•×ª TCP?</li>
</ul>
</div>

</body>
</html>
