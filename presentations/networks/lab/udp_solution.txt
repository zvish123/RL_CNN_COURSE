â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ×¤×ª×¨×•×Ÿ ××œ× ×œ×“×£ ×¢×‘×•×“×”: ×¤×¨×•×˜×•×§×•×œ UDP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

×¤×¨×˜×™ ×”×ª×œ××™×“/×”:
------------------
×©× ××œ×: ×™×•×¡×™ ×›×”×Ÿ
×›×™×ª×”: ×™×'2
×ª×¢×•×“×ª ×–×”×•×ª: 123456789
×ª××¨×™×š ×”×’×©×”: 2026-01-15

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    ×—×œ×§ 1: ×ª×™××•×¨×™×”
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

×©××œ×” 1.1: ×”×¡×‘×¨ ××” ×”×”×‘×“×œ ×”××¨×›×–×™ ×‘×™×Ÿ TCP ×œ-UDP
----------------------------------------------------
TCP ×”×•× ×¤×¨×•×˜×•×§×•×œ connection-oriented, ×›×œ×•××¨ ×”×•× ××§×™× ×—×™×‘×•×¨ ×œ×¤× ×™ ×©×œ×™×—×ª × ×ª×•× ×™× 
×‘×××¦×¢×•×ª 3-way handshake. ×œ××—×¨ ××›×Ÿ ×”×•× ××‘×˜×™×— ×©×›×œ ×”×× ×•×ª ××’×™×¢×•×ª ×œ×™×¢×“ ×•×‘×¡×“×¨ ×”× ×›×•×Ÿ.
×× ×× ×” ××•×‘×“×ª, TCP ×©×•×œ×— ××•×ª×” ×©×•×‘ (retransmission). ×–×” ×“×•×¨×© ×”××•×Ÿ overhead -
×× ×’× ×•× ×™ ××™×©×•×¨×™× (ACK), ××¢×§×‘ ××—×¨ sequence numbers, × ×™×”×•×œ ×—×œ×•×Ÿ (window), 
×•×¢×•×“. Header ×©×œ TCP ×”×•× 20+ bytes.

UDP ×œ×¢×•××ª ×–××ª ×”×•× connectionless - ×”×•× ×¤×©×•×˜ ×–×•×¨×§ ×× ×•×ª ×œ×¨×©×ª ×‘×œ×™ ×œ×‘×“×•×§ ×× 
×”×Ÿ ×”×’×™×¢×•. ××™×Ÿ handshake, ××™×Ÿ ××™×©×•×¨×™×, ××™×Ÿ retransmission. Header ×§×˜×Ÿ - 
×¨×§ 8 bytes. ×–×” ×”×•×¤×š ××ª UDP ×œ××”×™×¨ ×”×¨×‘×” ×™×•×ª×¨ ×›×™:
1. ××™×Ÿ overhead ×©×œ ×”×§××ª ×—×™×‘×•×¨
2. ××™×Ÿ ×”××ª× ×” ×œ××™×©×•×¨×™×
3. ××™×Ÿ retransmissions ×©×××˜×™×
4. Header ×§×˜×Ÿ = ×¤×—×•×ª × ×ª×•× ×™× ×œ×©×“×¨

×œ×›×Ÿ UDP ××ª××™× ×œ××¤×œ×™×§×¦×™×•×ª ×©×¦×¨×™×›×•×ª ××”×™×¨×•×ª ×•×™×›×•×œ×•×ª ×œ×¡×¤×•×’ ××•×‘×“×Ÿ ×× ×•×ª ××–×“××Ÿ,
×›××• ×•×™×“××•/××•×“×™×• streaming.

×©××œ×” 1.2: ×—×™×©×•×‘ ×’×•×“×œ ×× ×”
---------------------------
×× ×ª UDP ×¢× 512 bytes ×©×œ × ×ª×•× ×™×:

×—×™×©×•×‘:
- ×’×•×“×œ Header: 8 bytes (×§×‘×•×¢)
- ×’×•×“×œ Data: 512 bytes
- ×¡×”"×›: 8 + 512 = 520 bytes

×”×¢×¨×š ×‘×©×“×” Length ×™×”×™×”: 520

×”×¡×‘×¨: ×©×“×” Length ×›×•×œ×œ ××ª ×›×œ ×”×× ×” - ×’× ××ª ×”-header ×•×’× ××ª ×”× ×ª×•× ×™×.
×–×” ×—×©×•×‘ ×›×“×™ ×©×”×¦×“ ×”××§×‘×œ ×™×“×¢ ××™×¤×” ×”×× ×” ××¡×ª×™×™××ª.

×©××œ×” 1.3: ×©×™×¨×•×ª×™× ×”××©×ª××©×™× ×‘-UDP
------------------------------------
1. DNS (Domain Name System) - ×¤×•×¨×˜ 53
   ××“×•×¢ UDP? DNS queries ×”× ×§×¦×¨×™× ×××•×“ (×©× ×“×•××™×™×Ÿ -> IP), ××– ××™×Ÿ ×¦×•×¨×š 
   ×‘×—×™×‘×•×¨ ××œ×. ×× Query ××•×‘×“, ×¤×©×•×˜ ×©×•×œ×—×™× ×©×•×‘. ××”×™×¨×•×ª ×—×©×•×‘×” ×™×•×ª×¨ ××××™× ×•×ª.

2. VoIP (Voice over IP) - ×©×™×—×•×ª ××™× ×˜×¨× ×˜ ×›××• WhatsApp, Zoom
   ××“×•×¢ UDP? ×‘×©×™×—×” ×—×™×”, ×¢×“×™×£ ×œ××‘×“ ×›××” ××œ×¤×™×•×ª ×©× ×™×™×” ×©×œ ××•×“×™×• ×××©×¨ 
   ×œ×—×›×•×ª ×œretransmission ×©×™×’×¨×•× ×œ×¢×™×›×•×‘. ×”××•×–×Ÿ ×”×× ×•×©×™×ª ××©×œ×™××” ×¤×¢×¨×™× ×§×˜× ×™×.

3. ×¡×˜×¨×™××™× ×’ ×•×™×“××• - Netflix, YouTube Live
   ××“×•×¢ UDP? ×›××• VoIP, ×¢×“×™×£ frame ××˜×•×©×˜×© ××¢×™×›×•×‘ ×‘×¡×¨×˜×•×Ÿ. ×× frame ××•×‘×“,
   ×××©×™×›×™× ×”×œ××” - ×¦×•×¤×” ×œ× ×™×¨×’×™×© ×‘×‘×¢×™×” ×§×˜× ×”.

4. ××©×—×§×™× ××§×•×•× ×™× - Fortnite, Call of Duty
   ××“×•×¢ UDP? ×‘××©×—×§ ××”×™×¨ ×¦×¨×™×š latency × ××•×š ×××•×“. ×× ×× ×” ×¢× ××™×§×•× ×©×—×§×Ÿ 
   ××‘×“×”, ×”×× ×” ×”×‘××” (×¢× ××™×§×•× ××¢×•×“×›×Ÿ) ×ª×’×™×¢ ×ª×•×š ××œ×¤×™×•×ª ×©× ×™×™×”. 
   Retransmission ×™×™×¦×•×¨ lag ×‘×œ×ª×™ × ×¡×‘×œ.

5. DHCP (Dynamic Host Configuration Protocol) - ×¤×•×¨×˜×™× 67-68
   ××“×•×¢ UDP? ×›×©××—×©×‘ ××ª×—×‘×¨ ×œ×¨×©×ª ×•×”×•× ×¦×¨×™×š IP, ×”×•× ×¢×“×™×™×Ÿ ×œ× ×™×›×•×œ ×œ×”×§×™× 
   ×—×™×‘×•×¨ TCP ×›×™ ××™×Ÿ ×œ×• IP! UDP ×××¤×©×¨ broadcast ×œ××¦×™××ª DHCP server.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              ×—×œ×§ 2: ×ª×¨×’×•×œ ××¢×©×™ - Scapy Basics
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

××©×™××” 2.1: ×™×¦×™×¨×ª ×× ×ª UDP
-------------------------
from scapy.all import *

# ×™×¦×™×¨×ª ×× ×ª UDP
packet = IP(dst="8.8.8.8") / UDP(sport=12345, dport=53) / "Hello UDP"

# ×”×¦×’×ª ×”×× ×”
packet.show()

print("\n" + "="*50)
print("×”×× ×” × ×•×¦×¨×” ×‘×”×¦×œ×—×”!")
print("="*50)

# ××™×“×¢ × ×•×¡×£
print(f"×’×•×“×œ ×”×× ×” ×”×›×•×œ×œ: {len(packet)} bytes")
print(f"Destination: {packet[IP].dst}")
print(f"Source Port: {packet[UDP].sport}")
print(f"Destination Port: {packet[UDP].dport}")

××©×™××” 2.2: ×¤×œ×˜ + × ×™×ª×•×—
-----------------------
×¤×œ×˜ ×©×œ packet.show():

###[ IP ]### 
  version   = 4
  ihl       = None
  tos       = 0x0
  len       = None
  id        = 1
  flags     = 
  frag      = 0
  ttl       = 64
  proto     = udp
  chksum    = None
  src       = 192.168.1.100
  dst       = 8.8.8.8
  \options   \
###[ UDP ]### 
     sport     = 12345
     dport     = 53
     len       = None
     chksum    = None
###[ Raw ]### 
        load      = 'Hello UDP'

× ×™×ª×•×—:
------
1. ×©×›×‘×ª IP:
   - version=4: IPv4
   - dst=8.8.8.8: Google DNS server
   - ttl=64: Time To Live - ×”×× ×” ×ª×¢×‘×•×¨ ×¢×“ 64 hops
   - proto=udp: ×”×¤×¨×•×˜×•×§×•×œ ×‘×©×›×‘×” ×”×‘××” ×”×•× UDP

2. ×©×›×‘×ª UDP:
   - sport=12345: ×¤×•×¨×˜ ×”××§×•×¨ ×©×‘×—×¨× ×•
   - dport=53: ×¤×•×¨×˜ DNS (×™×¢×“)
   - len=None: Scapy ×™×—×©×‘ ××•×˜×•××˜×™×ª ×‘×–××Ÿ ×©×œ×™×—×”
   - chksum=None: Scapy ×™×—×©×‘ ××•×˜×•××˜×™×ª

3. Raw (× ×ª×•× ×™×):
   - load='Hello UDP': ×”×˜×§×¡×˜ ×©×©×œ×—× ×•

××¢× ×™×™×Ÿ ×œ×¨××•×ª ×©-Scapy ××˜×¤×œ ××•×˜×•××˜×™×ª ×‘×”×¨×‘×” ×©×“×•×ª (len, chksum) 
×•××©×œ×™× ××•×ª× ×¨×§ ×‘×–××Ÿ ×”×©×œ×™×—×” ×”×××™×ª×™×ª!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            ×—×œ×§ 3: ×‘× ×™×™×ª UDP Packet Sniffer
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

××©×™××” 3.1: ×§×•×“ ××œ× ×©×œ Sniffer
-------------------------------
from scapy.all import *
from collections import defaultdict
import time

stats = {
    'total': 0,
    'ports': set(),
    'sizes': []
}

def analyze_packet(packet):
    """× ×™×ª×•×— ×× ×ª UDP"""
    if packet.haslayer(UDP):
        stats['total'] += 1
        
        # ×©××™×¨×ª ×¤×•×¨×˜ ×™×¢×“
        dst_port = packet[UDP].dport
        stats['ports'].add(dst_port)
        
        # ×©××™×¨×ª ×’×•×“×œ
        packet_size = len(packet)
        stats['sizes'].append(packet_size)
        
        # ×”×“×¤×¡×” ×‘×–××Ÿ ×××ª
        src_ip = packet[IP].src if packet.haslayer(IP) else "Unknown"
        print(f"[{stats['total']}] {src_ip}:{packet[UDP].sport} -> Port {dst_port} ({packet_size} bytes)")

def print_stats():
    """×”×¦×’×ª ×¡×˜×˜×™×¡×˜×™×§×•×ª"""
    print("\n" + "="*60)
    print("               UDP PACKET SNIFFER - STATISTICS")
    print("="*60)
    
    print(f"\nğŸ“Š Total Packets Captured: {stats['total']}")
    
    if stats['sizes']:
        avg_size = sum(stats['sizes']) / len(stats['sizes'])
        print(f"ğŸ“ Average Packet Size: {avg_size:.2f} bytes")
        print(f"ğŸ“¦ Min Size: {min(stats['sizes'])} bytes")
        print(f"ğŸ“¦ Max Size: {max(stats['sizes'])} bytes")
    
    print(f"\nğŸ”Œ Unique Ports Detected: {len(stats['ports'])}")
    print(f"   Ports: {sorted(stats['ports'])}")
    
    # ×–×™×”×•×™ ×©×™×¨×•×ª×™× ×™×“×•×¢×™×
    known_services = {
        53: "DNS",
        67: "DHCP Server",
        68: "DHCP Client",
        123: "NTP",
        161: "SNMP",
        500: "VPN"
    }
    
    print("\nğŸ¯ Known Services:")
    for port in sorted(stats['ports']):
        service = known_services.get(port, "Unknown")
        print(f"   Port {port}: {service}")
    
    print("\n" + "="*60)

# ×”×ª×—×œ ×”×§×©×‘×”
print("ğŸ§ Starting UDP Packet Sniffer...")
print("Capturing 10 packets. Press Ctrl+C to stop early.\n")

try:
    sniff(filter='udp', prn=analyze_packet, count=10, timeout=30)
except KeyboardInterrupt:
    print("\n\nâš ï¸  Capture interrupted by user!")

# ×”×¦×’ ×¡×˜×˜×™×¡×˜×™×§×•×ª
print_stats()

××©×™××” 3.2: ×××¦××™×
------------------
×”×¨×¦×ª×™ ××ª ×”×ª×•×›× ×™×ª ×œ××©×š 3 ×“×§×•×ª ×‘×¨×©×ª ×”×‘×™×ª×™×ª ×©×œ×™. ×”× ×” ×”×××¦××™×:

×¡×”"×› ×× ×•×ª ×©× ×ª×¤×¡×•: 156 ×× ×•×ª UDP

×¤×•×¨×˜×™× ×¤×¢×™×œ×™×:
- Port 53 (DNS): 87 ×× ×•×ª - ×”×›×™ ×¤×¢×™×œ! 
  ×›×œ ×“×¤×“×¤×Ÿ, ××¤×œ×™×§×¦×™×” ×©×¤×•×ª×—×ª ×—×™×‘×•×¨ ×¦×¨×™×›×” DNS query
  
- Port 123 (NTP - Network Time Protocol): 24 ×× ×•×ª
  ×”××—×©×‘ ×©×œ×™ ××¡× ×›×¨×Ÿ ×©×¢×•×Ÿ ×¢× ×©×¨×ª ×–××Ÿ

- Port 5353 (mDNS - Multicast DNS): 31 ×× ×•×ª
  ×¤×¨×•×˜×•×§×•×œ ×œ×’×™×œ×•×™ ××›×©×™×¨×™× ×‘×¨×©×ª ×”××§×•××™×ª (AirPrint, Chromecast)

- Port 137 (NetBIOS): 8 ×× ×•×ª
  Windows file sharing

- Ports 49152-65535 (Dynamic Ports): 6 ×× ×•×ª
  ××¤×œ×™×§×¦×™×•×ª ×©×•× ×•×ª ×©×¤×•×ª×—×•×ª ×¤×•×¨×˜×™× ×–×× ×™×™×

×’×•×“×œ ×××•×¦×¢: 156.3 bytes
×’×•×“×œ ××™× ×™××œ×™: 42 bytes (DNS query ×¤×©×•×˜)
×’×•×“×œ ××§×¡×™××œ×™: 1472 bytes (×›××¢×˜ ×”-MTU)

×ª×•×‘× ×•×ª ××¢× ×™×™× ×•×ª:
- 56% ××”×ª×¢×‘×•×¨×” ×”×™× DNS - ××™× ×˜×¨× ×˜ ×œ× ×™×›×•×œ ×œ×¢×‘×•×“ ×‘×œ×¢×“×™×•!
- ×™×© ×”×¨×‘×” ×ª×¢×‘×•×¨×” "×‘×¨×§×¢" ×©×œ× ××•×“×¢×™× ××œ×™×”
- NTP ×¢×•×‘×“ ×‘×©×§×˜ - ×”×©×¢×” ××¡×ª× ×›×¨× ×ª ××•×˜×•××˜×™×ª
- ×¨××™×ª×™ spike ×›×©×”×“×¤×¡×ª×™ ××©×”×• - AirPrint ××©×ª××© ×‘-mDNS

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         ×—×œ×§ 4: ××ª×’×¨ ××ª×§×“× - DNS Analyzer
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

××©×™××” 4.1: DNS Analyzer
------------------------
from scapy.all import *
from collections import Counter
import time

# ××‘× ×™ × ×ª×•× ×™×
domains = Counter()
dns_packets = []
start_time = time.time()

def analyze_dns(packet):
    """× ×™×ª×•×— ×× ×•×ª DNS"""
    if packet.haslayer(DNS) and packet.haslayer(UDP):
        # ×¨×§ DNS queries (×œ× responses)
        if packet[DNS].qr == 0:  # 0 = query, 1 = response
            try:
                # ×—×™×œ×•×¥ ×©× ×”×“×•××™×™×Ÿ
                query_name = packet[DNS].qd.qname.decode('utf-8').rstrip('.')
                domains[query_name] += 1
                
                # ×©××™×¨×ª ×¤×¨×˜×™ ×”×× ×”
                dns_packets.append({
                    'time': time.time(),
                    'domain': query_name,
                    'src': packet[IP].src if packet.haslayer(IP) else 'Unknown'
                })
                
                print(f"[DNS Query] {query_name} from {packet[IP].src}")
            
            except Exception as e:
                print(f"Error parsing DNS: {e}")

def print_dns_report():
    """×“×•×— DNS"""
    runtime = time.time() - start_time
    
    print("\n" + "="*70)
    print("                    DNS ANALYZER REPORT")
    print("="*70)
    
    print(f"\nâ±ï¸  Runtime: {runtime:.1f} seconds")
    print(f"ğŸ” Total DNS Queries Captured: {len(dns_packets)}")
    print(f"ğŸŒ Unique Domains: {len(domains)}")
    
    if domains:
        print("\n" + "="*70)
        print("                 TOP 10 MOST QUERIED DOMAINS")
        print("="*70)
        
        for i, (domain, count) in enumerate(domains.most_common(10), 1):
            percentage = (count / len(dns_packets)) * 100
            bar = "â–ˆ" * int(percentage / 2)
            print(f"{i:2}. {domain:50} [{count:3}] {bar} {percentage:.1f}%")
    
    # × ×™×ª×•×— × ×•×¡×£
    print("\n" + "="*70)
    print("                      INSIGHTS")
    print("="*70)
    
    # ×–×™×”×•×™ ×“×•××™×™× ×™× ×—×©×•×“×™×
    suspicious = []
    for domain in domains.keys():
        # ×‘×“×™×§×•×ª ×¤×©×•×˜×•×ª
        if any(keyword in domain.lower() for keyword in ['ad', 'track', 'analytics']):
            suspicious.append(domain)
        if domain.count('.') > 4:  # ×“×•××™×™×Ÿ ××¨×•×š ×××•×“
            suspicious.append(domain)
    
    if suspicious:
        print(f"\nâš ï¸  Potentially Suspicious Domains: {len(set(suspicious))}")
        for dom in list(set(suspicious))[:5]:
            print(f"   - {dom}")
    
    # ×–×™×”×•×™ ×©×™×¨×•×ª×™× ×¤×•×¤×•×œ×¨×™×™×
    services = {
        'google': 0,
        'facebook': 0,
        'microsoft': 0,
        'apple': 0,
        'amazon': 0
    }
    
    for domain in domains.keys():
        for service in services.keys():
            if service in domain.lower():
                services[service] += domains[domain]
    
    print("\nğŸ“Š Popular Services:")
    for service, count in sorted(services.items(), key=lambda x: x[1], reverse=True):
        if count > 0:
            print(f"   {service.capitalize()}: {count} queries")
    
    print("\n" + "="*70)

# ×”×¤×¢×œ×ª ×”×¡× ×™×¤×¨
print("ğŸ” Starting DNS Analyzer...")
print("Capturing DNS queries for 60 seconds...")
print("Press Ctrl+C to stop early.\n")

try:
    sniff(filter="udp port 53", prn=analyze_dns, timeout=60)
except KeyboardInterrupt:
    print("\n\nâš ï¸  Capture stopped by user!")

# ×”×¦×’ ×“×•×—
print_dns_report()

××©×™××” 4.2: ×’×™×œ×•×™ ×—×¨×™×’×•×ª
------------------------
from scapy.all import *
from collections import defaultdict
import time

class AnomalyDetector:
    def __init__(self):
        self.ip_packet_count = defaultdict(int)
        self.ip_first_seen = defaultdict(float)
        self.port_usage = defaultdict(set)
        self.alerts = []
        
        # ×¡×£ ×”×ª×¨×¢×•×ª
        self.FLOOD_THRESHOLD = 100  # ×× ×•×ª ×œ×“×§×”
        self.PORT_SCAN_THRESHOLD = 20  # ×¤×•×¨×˜×™× ×©×•× ×™×
        
        # ×¤×•×¨×˜×™× "× ×•×¨××œ×™×™×"
        self.STANDARD_PORTS = {53, 67, 68, 123, 161, 500, 5353}
    
    def analyze_packet(self, packet):
        """× ×™×ª×•×— ×× ×” ×œ×’×™×œ×•×™ ×—×¨×™×’×•×ª"""
        if not packet.haslayer(UDP):
            return
        
        src_ip = packet[IP].src if packet.haslayer(IP) else None
        if not src_ip:
            return
        
        dst_port = packet[UDP].dport
        current_time = time.time()
        
        # ×¢×“×›×•×Ÿ ××•× ×™×
        self.ip_packet_count[src_ip] += 1
        if src_ip not in self.ip_first_seen:
            self.ip_first_seen[src_ip] = current_time
        
        self.port_usage[src_ip].add(dst_port)
        
        # ×‘×“×™×§×” 1: Flooding Attack
        self.check_flooding(src_ip, current_time)
        
        # ×‘×“×™×§×” 2: Port Scanning
        self.check_port_scan(src_ip)
        
        # ×‘×“×™×§×” 3: ×©×™××•×© ×‘×¤×•×¨×˜×™× ×œ× ×¡×˜× ×“×¨×˜×™×™×
        self.check_unusual_ports(src_ip, dst_port)
    
    def check_flooding(self, ip, current_time):
        """×’×™×œ×•×™ UDP flood"""
        elapsed = current_time - self.ip_first_seen[ip]
        if elapsed > 60:  # ××—×¨×™ ×“×§×”
            rate = self.ip_packet_count[ip] / elapsed * 60  # packets per minute
            
            if rate > self.FLOOD_THRESHOLD:
                alert = f"ğŸš¨ FLOOD DETECTED! {ip} sending {rate:.0f} packets/min"
                if alert not in self.alerts:
                    self.alerts.append(alert)
                    print(f"\n{alert}\n")
    
    def check_port_scan(self, ip):
        """×’×™×œ×•×™ Port Scanning"""
        unique_ports = len(self.port_usage[ip])
        
        if unique_ports > self.PORT_SCAN_THRESHOLD:
            alert = f"ğŸ” PORT SCAN DETECTED! {ip} accessed {unique_ports} different ports"
            if alert not in self.alerts:
                self.alerts.append(alert)
                print(f"\n{alert}\n")
                print(f"   Ports: {sorted(list(self.port_usage[ip]))[:20]}...")
    
    def check_unusual_ports(self, ip, port):
        """×’×™×œ×•×™ ×©×™××•×© ×‘×¤×•×¨×˜×™× ×—×©×•×“×™×"""
        if port not in self.STANDARD_PORTS:
            # ×¡×¤×™×¨×ª ×©×™××•×© ×‘×¤×•×¨×˜×™× ×œ× ×¡×˜× ×“×¨×˜×™×™×
            non_standard = [p for p in self.port_usage[ip] if p not in self.STANDARD_PORTS]
            
            if len(non_standard) > 5:  # ×™×•×ª×¨ ×-5 ×¤×•×¨×˜×™× ×œ× ×¡×˜× ×“×¨×˜×™×™×
                alert = f"âš ï¸  UNUSUAL ACTIVITY: {ip} using non-standard ports: {non_standard[:5]}"
                if alert not in self.alerts:
                    self.alerts.append(alert)
                    print(f"\n{alert}\n")
    
    def print_summary(self):
        """×¡×™×›×•×"""
        print("\n" + "="*70)
        print("              ANOMALY DETECTION SUMMARY")
        print("="*70)
        
        print(f"\nğŸ“Š Total IPs Monitored: {len(self.ip_packet_count)}")
        print(f"ğŸš¨ Total Alerts: {len(self.alerts)}")
        
        if self.alerts:
            print("\nğŸ”´ Alerts:")
            for alert in self.alerts:
                print(f"   {alert}")
        else:
            print("\nâœ… No anomalies detected!")
        
        print("\nğŸ“ˆ Top Talkers:")
        for ip, count in sorted(self.ip_packet_count.items(), 
                               key=lambda x: x[1], 
                               reverse=True)[:5]:
            print(f"   {ip}: {count} packets ({len(self.port_usage[ip])} unique ports)")
        
        print("\n" + "="*70)

# ×”×¤×¢×œ×”
detector = AnomalyDetector()

print("ğŸ›¡ï¸  UDP Anomaly Detector Started")
print("Monitoring for 120 seconds...\n")

try:
    sniff(filter="udp", prn=detector.analyze_packet, timeout=120)
except KeyboardInterrupt:
    print("\n\nâš ï¸  Stopped by user!")

detector.print_summary()

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              ×—×œ×§ 5: ×”××ª×’×¨ ×”×™×¦×™×¨×ª×™
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

××©×™××” 5.1: ×‘×—×™×¨×ª ××ª×’×¨
-----------------------
×‘×—×¨×ª×™ ×‘××ª×’×¨: UDP Ping-Pong Game

× ×™××•×§×™×:
---------
×‘×—×¨×ª×™ ×‘××ª×’×¨ ×”×–×” ×›×™ ×”×•× ××“×’×™× ×‘×¦×•×¨×” ×”×›×™ ×‘×¨×•×¨×” ××ª ×”×‘×¢×™×” ×”××¨×›×–×™×ª ×©×œ UDP -
×—×•×¡×¨ ×××™× ×•×ª. ×›×©×× ×—× ×• ×œ×•××“×™× ×©UDP ×”×•× "unreliable", ×–×” × ×©××¢ ×ª×™××•×¨×˜×™.
××‘×œ ×›×©×¨×•××™× ×‘×¤×•×¢×œ ×©×× ×•×ª ××•×‘×“×•×ª ×•××¤×©×¨ ×œ××“×•×“ ×›××” ××—×•×–×™×, ×–×” ×”×•×¤×š ×œ×”×™×•×ª
×××©×™ ×•××•×‘×Ÿ.

××” ××¢× ×™×™×Ÿ ××•×ª×™ ×‘××™×•×—×“:
- ×œ×¨××•×ª ××ª ×”-packet loss ×‘×¤×•×¢×œ (×”×× ×‘×××ª ××•×‘×“×•×ª ×× ×•×ª ×‘×¨×©×ª ×‘×™×ª×™×ª?)
- ×œ××“×•×“ RTT (Round Trip Time) - ×›××” ×–××Ÿ ×œ×•×§×— ×œ×× ×” ×”×œ×•×š-×—×–×•×¨
- ×œ×”×‘×™×Ÿ ××ª ×”×—×©×™×‘×•×ª ×©×œ Timeout - ××™×š ×™×•×“×¢×™× ×©×× ×” ××‘×“×”?
- ×œ×™×¦×•×¨ ××©×”×• ×©×“×•××” ×œ×›×œ×™ ping ×”×××™×ª×™ ×‘××¢×¨×›×ª ×”×¤×¢×œ×”

××” ×× ×™ ××¦×¤×” ×œ×œ××•×“:
- ×¢×‘×•×“×” ×¢× sockets ×‘×¨××” × ××•×›×”
- ×˜×™×¤×•×œ ×‘timeouts ×•exceptions
- ×¡×˜×˜×™×¡×˜×™×§×•×ª ×¨×©×ª ×××™×ª×™×•×ª
- ×”×‘×“×œ ×‘×™×Ÿ ×¡×™××•×œ×¦×™×” ×œ××¦×™××•×ª

××©×™××” 5.2: ×”×§×•×“ ×”××œ×
----------------------

# ==================== SERVER.PY ====================

from socket import *
import random
import sys

class UDPPongServer:
    """
    UDP Ping-Pong Server
    ××§×‘×œ PING ×•××©×™×‘ PONG
    ×ª×•××š ×‘×¡×™××•×œ×¦×™×™×ª packet loss
    """
    
    def __init__(self, host='0.0.0.0', port=9999, loss_rate=0):
        """
        :param host: ×›×ª×•×‘×ª ×œ×”××–× ×”
        :param port: ×¤×•×¨×˜ ×œ×”××–× ×”
        :param loss_rate: ××—×•×– packet loss ××œ××›×•×ª×™ (0-100)
        """
        self.host = host
        self.port = port
        self.loss_rate = loss_rate  # 0-100
        
        # ×™×¦×™×¨×ª socket
        self.sock = socket(AF_INET, SOCK_DGRAM)
        self.sock.bind((self.host, self.port))
        
        # ×¡×˜×˜×™×¡×˜×™×§×•×ª
        self.total_received = 0
        self.total_dropped = 0
        self.total_sent = 0
    
    def start(self):
        """×”×ª×—×œ ×”××–× ×”"""
        print("="*60)
        print(f"ğŸ¾ UDP Ping-Pong Server Started")
        print("="*60)
        print(f"ğŸ“¡ Listening on {self.host}:{self.port}")
        print(f"ğŸ“Š Packet Loss Simulation: {self.loss_rate}%")
        print(f"â¸ï¸  Press Ctrl+C to stop\n")
        
        try:
            while True:
                # ×§×‘×œ×ª ×× ×”
                data, client_addr = self.sock.recvfrom(1024)
                self.total_received += 1
                
                # ×¤×¢× ×•×—
                try:
                    message = data.decode('utf-8')
                except:
                    print(f"âš ï¸  Invalid data from {client_addr}")
                    continue
                
                # ×‘×“×™×§×” ×× ×–×” PING
                if message.startswith("PING"):
                    # ×¡×™××•×œ×¦×™×™×ª packet loss
                    if random.randint(1, 100) <= self.loss_rate:
                        self.total_dropped += 1
                        print(f"âŒ DROPPED: Packet #{message.split(':')[1]} from {client_addr[0]}")
                        continue
                    
                    # ×©×œ×™×—×ª PONG
                    response = message.replace("PING", "PONG")
                    self.sock.sendto(response.encode('utf-8'), client_addr)
                    self.total_sent += 1
                    
                    seq = message.split(':')[1]
                    print(f"âœ… {client_addr[0]}:{client_addr[1]} -> PING #{seq} -> PONG #{seq}")
                
                else:
                    print(f"âš ï¸  Unknown message: {message}")
        
        except KeyboardInterrupt:
            self.shutdown()
    
    def shutdown(self):
        """×¡×’×™×¨×” ××¡×•×“×¨×ª"""
        print("\n\n" + "="*60)
        print("ğŸ›‘ Server Shutting Down")
        print("="*60)
        print(f"ğŸ“Š Statistics:")
        print(f"   Total Received: {self.total_received}")
        print(f"   Total Sent: {self.total_sent}")
        print(f"   Total Dropped: {self.total_dropped}")
        if self.total_received > 0:
            actual_loss = (self.total_dropped / self.total_received) * 100
            print(f"   Actual Loss Rate: {actual_loss:.2f}%")
        print("="*60)
        
        self.sock.close()
        sys.exit(0)

if __name__ == "__main__":
    # × ×™×ª×Ÿ ×œ×©× ×•×ª ××ª loss_rate ×œ×¡×™××•×œ×¦×™×”
    # ×“×•×’××”: UDPPongServer(loss_rate=10) = 10% packet loss
    server = UDPPongServer(loss_rate=5)  # 5% packet loss
    server.start()


# ==================== CLIENT.PY ====================

from socket import *
import time
import sys

class UDPPingClient:
    """
    UDP Ping-Pong Client
    ×©×•×œ×— PING ×•××•×“×“ ×ª×’×•×‘×•×ª PONG
    """
    
    def __init__(self, server_ip, server_port=9999, timeout=1.0):
        """
        :param server_ip: ×›×ª×•×‘×ª ×”×©×¨×ª
        :param server_port: ×¤×•×¨×˜ ×”×©×¨×ª
        :param timeout: timeout ×‘×©× ×™×•×ª
        """
        self.server_ip = server_ip
        self.server_port = server_port
        self.timeout = timeout
        
        # ×™×¦×™×¨×ª socket
        self.sock = socket(AF_INET, SOCK_DGRAM)
        self.sock.settimeout(self.timeout)
        
        # ×¡×˜×˜×™×¡×˜×™×§×•×ª
        self.sent = 0
        self.received = 0
        self.lost = 0
        self.rtts = []  # Round Trip Times
    
    def ping(self, count=100):
        """
        ×©×œ×— PING ×œ××¡×¤×¨ ×¤×¢××™×
        :param count: ×›××” ×¤×¢××™× ×œ×©×œ×•×—
        """
        print("="*70)
        print(f"ğŸ¾ UDP Ping-Pong Test")
        print("="*70)
        print(f"ğŸ¯ Target: {self.server_ip}:{self.server_port}")
        print(f"â±ï¸  Timeout: {self.timeout} seconds")
        print(f"ğŸ“¨ Sending {count} packets\n")
        
        for seq in range(1, count + 1):
            try:
                # ×™×¦×™×¨×ª ×”×•×“×¢×ª PING
                message = f"PING:{seq}:{time.time()}"
                
                # ×©×œ×™×—×”
                send_time = time.time()
                self.sock.sendto(message.encode('utf-8'), 
                               (self.server_ip, self.server_port))
                self.sent += 1
                
                # ×”××ª× ×” ×œ×ª×’×•×‘×”
                try:
                    data, server = self.sock.recvfrom(1024)
                    recv_time = time.time()
                    
                    # ×—×™×©×•×‘ RTT
                    rtt = (recv_time - send_time) * 1000  # ×”××¨×” ×œ××™×œ×™×©× ×™×•×ª
                    self.rtts.append(rtt)
                    self.received += 1
                    
                    # ×”×“×¤×¡×”
                    response = data.decode('utf-8')
                    print(f"âœ… Packet #{seq}: {len(data)} bytes from {server[0]} "
                          f"time={rtt:.2f}ms")
                
                except timeout:
                    # Timeout - ×”×× ×” ××‘×“×”
                    self.lost += 1
                    print(f"âŒ Packet #{seq}: Request timeout ({self.timeout}s)")
                
                # ×”×©×”×™×™×” ×§×˜× ×” ×‘×™×Ÿ ×× ×•×ª
                time.sleep(0.1)
            
            except KeyboardInterrupt:
                print("\n\nâš ï¸  Test interrupted by user")
                break
        
        # ×”×¦×’ ×¡×˜×˜×™×¡×˜×™×§×•×ª
        self.print_statistics()
    
    def burst_test(self, burst_size=10, count=5):
        """
        ××¦×‘ burst - ×©×œ×™×—×” ××”×™×¨×” ×©×œ ×× ×•×ª ×¨×‘×•×ª
        :param burst_size: ×›××” ×× ×•×ª ×‘×›×œ burst
        :param count: ×›××” bursts
        """
        print("="*70)
        print(f"ğŸ’¥ UDP Burst Test")
        print("="*70)
        print(f"ğŸ¯ Target: {self.server_ip}:{self.server_port}")
        print(f"ğŸ“¨ Burst Size: {burst_size} packets")
        print(f"ğŸ”„ Bursts: {count}\n")
        
        for burst_num in range(1, count + 1):
            print(f"\nğŸš€ Burst #{burst_num}:")
            
            # ×©×œ×— burst
            burst_sent = 0
            for i in range(burst_size):
                seq = (burst_num - 1) * burst_size + i + 1
                message = f"PING:{seq}:{time.time()}"
                self.sock.sendto(message.encode('utf-8'), 
                               (self.server_ip, self.server_port))
                self.sent += 1
                burst_sent += 1
            
            print(f"   Sent {burst_sent} packets in burst")
            
            # ×§×‘×œ ×ª×’×•×‘×•×ª
            burst_received = 0
            end_time = time.time() + self.timeout
            
            while time.time() < end_time:
                try:
                    self.sock.settimeout(end_time - time.time())
                    data, server = self.sock.recvfrom(1024)
                    burst_received += 1
                    self.received += 1
                except timeout:
                    break
            
            burst_lost = burst_sent - burst_received
            self.lost += burst_lost
            
            print(f"   Received {burst_received} responses")
            print(f"   Lost {burst_lost} packets ({(burst_lost/burst_sent)*100:.1f}%)")
            
            time.sleep(1)
        
        self.print_statistics()
    
    def print_statistics(self):
        """×”×¦×’ ×¡×˜×˜×™×¡×˜×™×§×•×ª ××œ××•×ª"""
        print("\n" + "="*70)
        print("ğŸ“Š PING STATISTICS")
        print("="*70)
        
        print(f"\nğŸ“¨ Packets: Sent = {self.sent}, Received = {self.received}, "
              f"Lost = {self.lost}")
        
        if self.sent > 0:
            loss_percentage = (self.lost / self.sent) * 100
            print(f"ğŸ“‰ Packet Loss: {loss_percentage:.2f}%")
        
        if self.rtts:
            print(f"\nâ±ï¸  Round Trip Time:")
            print(f"   Minimum = {min(self.rtts):.2f}ms")
            print(f"   Maximum = {max(self.rtts):.2f}ms")
            print(f"   Average = {sum(self.rtts)/len(self.rtts):.2f}ms")
            
            # Standard Deviation (×¤×™×–×•×¨)
            avg = sum(self.rtts) / len(self.rtts)
            variance = sum((x - avg) ** 2 for x in self.rtts) / len(self.rtts)
            std_dev = variance ** 0.5
            print(f"   Std Dev = {std_dev:.2f}ms")
        
        print("\n" + "="*70)
        
        # ×¡×’×™×¨×ª socket
        self.sock.close()

def main():
    """×ª×¤×¨×™×˜ ×¨××©×™"""
    if len(sys.argv) < 2:
        print("Usage: python client.py <server_ip> [mode]")
        print("Modes: normal (default), burst")
        sys.exit(1)
    
    server_ip = sys.argv[1]
    mode = sys.argv[2] if len(sys.argv) > 2 else "normal"
    
    client = UDPPingClient(server_ip)
    
    if mode == "burst":
        client.burst_test(burst_size=20, count=5)
    else:
        client.ping(count=100)

if __name__ == "__main__":
    main()


××©×™××” 5.3: ×ª×™×¢×•×“ ×•×ª×•×¦××•×ª
-------------------------

××™×š ×”×¨×¦×ª×™:
-----------
1. ×¤×ª×—×ª×™ 2 terminals
2. Terminal 1: python server.py
3. Terminal 2: python client.py 127.0.0.1

×ª×•×¦××•×ª - ××¦×‘ Normal (100 packets):
----------------------------------
ğŸ“Š PING STATISTICS
==================
ğŸ“¨ Packets: Sent = 100, Received = 95, Lost = 5
ğŸ“‰ Packet Loss: 5.00%

â±ï¸  Round Trip Time:
   Minimum = 0.12ms
   Maximum = 2.34ms
   Average = 0.43ms
   Std Dev = 0.31ms

×××¦××™× ××¢× ×™×™× ×™×:
-----------------
1. ××‘×“×Ÿ ×× ×•×ª: ×‘×œ×•×§×œ×”×•×¡×˜ (127.0.0.1) ×”××—×©×‘ ××“×‘×¨ ×¢× ×¢×¦××•, ×•×¢×“×™×™×Ÿ
   ××‘×“×• 5 ×× ×•×ª ××ª×•×š 100! ×–×” ×‘×’×œ×œ ×©×”×©×¨×ª ×”×™×” ×¢×¡×•×§ ××• ×©×”-OS ×“×—×” ×× ×•×ª.
   
2. RTT × ××•×š ×××•×“: ×××•×¦×¢ ×©×œ 0.43ms ×›×™ ×–×” loopback - ×”×›×œ ×‘×–×™×›×¨×•×Ÿ.

3. Standard Deviation: 0.31ms ××¨××” ×©×”×–×× ×™× ×“×™ ×™×¦×™×‘×™×, ×¨×•×‘ ×”×× ×•×ª 
   ×”×™×• ××”×™×¨×•×ª ×‘××•×¤×Ÿ ×“×•××”.

×ª×•×¦××•×ª - ××¦×‘ Burst (5 bursts Ã— 20 packets):
--------------------------------------------
ğŸ’¥ Burst #1: Lost 3/20 (15%)
ğŸ’¥ Burst #2: Lost 4/20 (20%)
ğŸ’¥ Burst #3: Lost 2/20 (10%)
ğŸ’¥ Burst #4: Lost 5/20 (25%)
ğŸ’¥ Burst #5: Lost 3/20 (15%)

ğŸ“Š Total: Sent = 100, Received = 83, Lost = 17
ğŸ“‰ Packet Loss: 17.00%

×ª×•×‘× ×•×ª ×-Burst Test:
---------------------
×‘××¦×‘ burst ×”packet loss ×¢×œ×” ×œ-17%! ×›××¢×˜ ×¤×™ 3 ××”××¦×‘ ×”×¨×’×™×œ.
×–×” ×§×•×¨×” ×›×™:
- ×©×œ×—× ×• 20 ×× ×•×ª ×‘×‘×ª ××—×ª ×œ×œ× ×”×©×”×™×”
- ×ª×•×¨ ×”×§×‘×œ×” (receive buffer) ×©×œ ×”×©×¨×ª ×”×ª××œ×
- ×× ×•×ª ×—×“×©×•×ª × ×–×¨×§×• ×›×™ ××™×Ÿ ××§×•×

×–×” ××“×’×™× ×œ××” UDP ×œ× ××ª××™× ×œ×”×¢×‘×¨×ª × ×ª×•× ×™× ×§×¨×™×˜×™×ª - ×›×©×™×© ×¢×•××¡,
×× ×•×ª ×¤×©×•×˜ ××•×‘×“×•×ª.

×‘×¢×™×•×ª ×©× ×ª×§×œ×ª×™ ×‘×”×Ÿ:
-------------------
1. ×‘×”×ª×—×œ×” ×©×›×—×ª×™ encode/decode - Python 3 ×“×•×¨×© bytes
   ×¤×ª×¨×•×Ÿ: ×”×•×¡×¤×ª×™ .encode('utf-8') ×•-.decode('utf-8')

2. ×”-timeout ×œ× ×¢×‘×“ × ×›×•×Ÿ ×‘×‘urst test
   ×¤×ª×¨×•×Ÿ: ×—×™×©×‘×ª×™ ××ª ×”×–××Ÿ ×©× ×•×ª×¨ ×“×™× ××™×ª: 
   end_time - time.time()

3. ×‘×œ×•×§×œ×”×•×¡×˜ ×”×™×” ××‘×“×Ÿ ×× ×•×ª ××•×¢×˜ ××“×™ - ×œ× ××¢× ×™×™×Ÿ
   ×¤×ª×¨×•×Ÿ: ×”×•×¡×¤×ª×™ ×œ×©×¨×ª ×¡×™××•×œ×¦×™×™×ª packet loss (loss_rate parameter)

4. ×¡×˜×˜×™×¡×˜×™×§×•×ª ×œ× ×”×™×• ×‘×¨×•×¨×•×ª
   ×¤×ª×¨×•×Ÿ: ×”×•×¡×¤×ª×™ min/max/avg/stddev ×œ-RTT

××” ×”×¤×ª×™×¢ ××•×ª×™:
---------------
- ×’× ×‘×œ×•×§×œ×”×•×¡×˜ ×™×© packet loss! ×—×©×‘×ª×™ ×©×”×›×œ "××•×‘×˜×—" ×‘×ª×•×š ×”××—×©×‘
- ×‘-burst test ×”packet loss ×¢×œ×” ×“×¨×¡×˜×™×ª - ×–×” ×××—×™×© ××ª ×”×—×©×™×‘×•×ª ×©×œ
  rate limiting ×‘××¤×œ×™×§×¦×™×•×ª ×××™×ª×™×•×ª
- RTT ××©×ª× ×” ×”×¨×‘×” - ×™×© outliers ×©×œ 2ms ×œ×¢×•××ª 0.12ms - ×œ××”? 
  ×›× ×¨××” context switching ×©×œ ×”××¢×¨×›×ª ×”×¤×¢×œ×”

×”×©×•×•××” ×œ-TCP:
--------------
×× ×”×™×™×ª×™ ×¢×•×©×” ××ª ×–×” ×‘-TCP:
- 0% packet loss - TCP ××‘×˜×™×— ×”×’×¢×”
- RTT ×’×‘×•×” ×™×•×ª×¨ - 3-way handshake + ACKs
- ×‘××¦×‘ burst, TCP ×”×™×” ×××˜ ××•×˜×•××˜×™×ª (flow control)
- ×”×§×•×“ ×”×™×” ××¡×•×‘×š ×™×•×ª×¨ - × ×™×”×•×œ ×—×™×‘×•×¨×™×

××¡×§× ×•×ª:
--------
UDP ×‘×××ª unreliable - ×¨××™×ª×™ ××ª ×–×” ×‘××• ×¢×™× ×™!
××‘×œ ×”×•× ××”×™×¨ - RTT ×©×œ ×—×¦×™ ××™×œ×™×©× ×™×™×” ×–×” ××“×”×™×.
×¢×›×©×™×• ×× ×™ ××‘×™×Ÿ ×œ××” Zoom ××©×ª××© ×‘-UDP - ×¢×“×™×£ ×¤×™×§×¡×œ ××˜×•×©×˜×© 
××¢×™×›×•×‘ ×©×œ ×›××” ×©× ×™×•×ª.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         ×—×œ×§ 6: ×©××œ×•×ª ×—×©×™×‘×” ××ª×§×“××•×ª
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

×©××œ×” 6.1: ×œ××” Zoom ×•-Netflix ××©×ª××©×™× ×‘-UDP?
----------------------------------------------

Zoom (VoIP):
------------
Zoom ××©×ª××© ×‘-UDP ×›×™ ×‘×©×™×—×ª ×•×™×“××• ×—×™×”, ×–××Ÿ ×××ª ×”×•× ×§×¨×™×˜×™.

×™×ª×¨×•× ×•×ª UDP ×œ-Zoom:
â€¢ Low Latency: ××™×Ÿ 3-way handshake, ××™×Ÿ ACKs - ×¤×™×§×¡×œ×™× ××’×™×¢×™× ××”×¨
â€¢ No Head-of-Line Blocking: ×× frame ××•×‘×“, ×××©×™×›×™× ×œframe ×”×‘×
  ×‘-TCP, ×›×œ ×”×× ×•×ª ××—×›×•×ª ×œ×× ×” ×©××‘×“×” - ×–×” ×™×•×¦×¨ "×§×¤×™××•×ª"
â€¢ Adaptive: Zoom ×™×›×•×œ ×œ×”×•×¨×™×“ ××™×›×•×ª ×× ×™×© packet loss
â€¢ Human Perception: ×”××•×–×Ÿ ×•×”×¢×™×Ÿ ××©×œ×™××•×ª ×¤×¢×¨×™× ×§×˜× ×™×

×—×¡×¨×•× ×•×ª UDP ×œ-Zoom:
â€¢ ××™×›×•×ª ×™×›×•×œ×” ×œ×¨×“×ª ×‘×¨×©×ª ×¢××•×¡×”
â€¢ ×¦×¨×™×š ×œ×‘× ×•×ª error correction ×‘×¢×¦×× (FEC - Forward Error Correction)
â€¢ ×œ× ×¢×•×‘×“ ×˜×•×‘ ×“×¨×š firewalls ××¡×•×™×™××™×

Netflix (×¡×˜×¨×™××™× ×’):
-------------------
Netflix ×œ××¢×©×” ××©×ª××©×ª ×‘-TCP! (×”×¤×ª×¢×”)
××‘×œ ×œ××©×—×§×™× ×•×œ×¡×˜×¨×™××™× ×’ ×—×™ ××©×ª××©×™× ×‘-UDP.

×œ××” TCP ××ª××™× ×œ-Netflix:
â€¢ ×”×¡×¨×˜×•×Ÿ ××•×¨×“ ××¨××© (buffering) - ××™×Ÿ ×“×¨×™×©×” ×œ×–××Ÿ ×××ª
â€¢ ×›×œ ×¤×™×§×¡×œ ×¦×¨×™×š ×œ×”×’×™×¢ - ××™ ××¤×©×¨ ×œ×¡×¤×•×’ packet loss ×‘×¡×¨×˜
â€¢ TCP ×“×•××’ ×œ-congestion control ××•×˜×•××˜×™×ª

×œ××” UDP ××ª××™× ×œ×¡×˜×¨×™××™× ×’ ×—×™ (YouTube Live):
â€¢ ×–××Ÿ ×××ª - ××™ ××¤×©×¨ ×œ×—×›×•×ª ×œ-retransmission
â€¢ ×¢×“×™×£ ×œ×“×œ×’ ×¢×œ frame ××—×“ ×××©×¨ ×œ×§×¤×•×
â€¢ ×”-"×—×œ×•×Ÿ" ×©×œ buffering ×§×˜×Ÿ

×©××œ×” 6.2: ××” ×§×•×¨×” ×›×©×× ×ª UDP ××•×‘×“×ª?
-------------------------------------

××” ×§×•×¨×” ×‘×¨×©×ª:
--------------
1. ×”×× ×” × ×©×œ×—×ª ××”×©×•×œ×—
2. ×”×™× ×¢×•×‘×¨×ª ×“×¨×š routers/switches
3. ××—×“ ××”× ××•×¦× ×©×”buffer ×©×œ×• ××œ×
4. Router ××©××™×“ ××ª ×”×× ×” (drop)
5. ××™×Ÿ ×”×•×“×¢×” ×œ×©×•×œ×—! UDP ×œ× ×™×•×“×¢ ×©××©×”×• ×§×¨×”

××™×š ××¤×œ×™×§×¦×™×•×ª ××ª××•×“×“×•×ª:
-------------------------

1. Ignore it (×”×ª×¢×œ×):
   â€¢ ×¡×˜×¨×™××™× ×’ ×•×™×“××•/××•×“×™×• - ××•×‘×“ frame ××—×“? ×¢×•×‘×¨×™× ×”×œ××”
   â€¢ UDP DNS - ×©×œ×— query ×©×•×‘ ×× ××™×Ÿ ×ª×©×•×‘×” ×ª×•×š ×©× ×™×™×”
   
2. Application-level retransmission:
   â€¢ TFTP (Trivial FTP over UDP) - ×©×•××¨ sequence numbers
   â€¢ ×× ×œ× ×§×™×‘×œ×• ACK, ×©×•×œ×—×™× ×©×•×‘
   â€¢ ×‘×¢×¦× ×‘×•× ×™× TCP ××¢×œ UDP!
   
3. Forward Error Correction (FEC):
   â€¢ ×©×•×œ×—×™× ××™×“×¢ ××™×•×ª×¨ (redundancy)
   â€¢ ×“×•×’××”: ×©×œ×™×—×ª ×›×œ packet ×¤×¢××™×™×
   â€¢ ××•: Reed-Solomon codes - ×™×›×•×œ ×œ×©×—×–×¨ × ×ª×•× ×™× ××—×œ×§×™×
   
4. Adaptive Bitrate:
   â€¢ ×–×™×”×•×™ packet loss â†’ ×”×•×¨×“×ª ××™×›×•×ª
   â€¢ Zoom ××¢×‘×™×¨ ×œ×¨×–×•×œ×•×¦×™×” × ××•×›×” ×™×•×ª×¨
   â€¢ ×¤×—×•×ª × ×ª×•× ×™× = ×¤×—×•×ª ×¡×™×›×•×™ ×œpacket loss
   
5. Buffering:
   â€¢ ×©×•××¨×™× ××¡×¤×¨ ×©× ×™×•×ª ×©×œ × ×ª×•× ×™×
   â€¢ ×× packet ××•×‘×“, ×”×××’×¨ "××›×¡×”" ×¢×œ ×”×¤×¢×¨
   â€¢ ×–×” ×œ××” ×™×© ×¢×™×›×•×‘ ×©×œ 10-30 ×©× ×™×•×ª ×‘×˜×œ×•×•×™×–×™×” ×“×™×’×™×˜×œ×™×ª

×©××œ×” 6.3: ××—×§×¨ ×¢×œ QUIC
------------------------

××” ×–×” QUIC?
------------
QUIC = Quick UDP Internet Connections
×¤×¨×•×˜×•×§×•×œ ×©×¤×•×ª×— ×¢×œ ×™×“×™ Google, ×¢×›×©×™×• IETF standard (RFC 9000)

×”×¨×¢×™×•×Ÿ ×”××¨×›×–×™:
"×‘×•××• × ×™×§×— ××ª ×”×™×ª×¨×•× ×•×ª ×©×œ TCP ×•×©×œ UDP ×•× ×©×œ×‘ ××•×ª×!"

QUIC = UDP + TCP-like features + TLS + HTTP/2

××™×š ×–×” ×¢×•×‘×“:
-------------
×©×›×‘×” 1-4: IP + UDP (×”×¤×¨×•×˜×•×§×•×œ "×”×¤×©×•×˜")
×©×›×‘×” 5: QUIC (×›×œ ×”×§×¡× ×§×•×¨×” ×›××Ÿ)
  â€¢ Connection management
  â€¢ Reliability (×©×œ×™×—×” ××—×“×©)
  â€¢ Encryption built-in (×œ× ×¦×¨×™×š TLS × ×¤×¨×“)
  â€¢ Stream multiplexing
×©×›×‘×” 7: HTTP/3

×™×ª×¨×•× ×•×ª ×©×œ QUIC:
------------------

1. ××”×™×¨ ×™×•×ª×¨ ×-TCP:
   â€¢ 0-RTT connection - ××¤×©×¨ ×œ×©×œ×•×— × ×ª×•× ×™× ××™×“
   â€¢ TCP ×“×•×¨×© 3-way handshake + TLS handshake = 2-3 RTTs
   â€¢ QUIC ××©×œ×‘ ×”×›×œ ×œ-1 RTT ××• 0!

2. No Head-of-Line Blocking:
   â€¢ ×‘-TCP: ×× packet ××•×‘×“, ×›×œ ×”-stream ××—×›×”
   â€¢ ×‘-QUIC: ×™×© streams × ×¤×¨×“×™×, ×¨×§ stream ××—×“ ××—×›×”

3. Connection Migration:
   â€¢ ×¢×‘×¨×ª ×-WiFi ×œ-4G? TCP ××ª× ×ª×§
   â€¢ QUIC ××–×”×” connection ×œ×¤×™ ID, ×œ× IP - ×”×—×™×‘×•×¨ ×××©×™×š!

4. Built-in Encryption:
   â€¢ TLS 1.3 ××•×‘× ×” - ×œ× ××•×¤×¦×™×”
   â€¢ ×¤×¨×˜×™×•×ª ×•×‘×™×˜×—×•×Ÿ ×›×‘×¨×™×¨×ª ××—×“×œ

5. Flexible:
   â€¢ QUIC ×¨×¥ ×‘-userspace, ×œ× ×‘kernel
   â€¢ ×¢×“×›×•× ×™× ×©×œ ×”×¤×¨×•×˜×•×§×•×œ ×œ× ×“×•×¨×©×™× ×¢×“×›×•×Ÿ OS

×—×¡×¨×•× ×•×ª ×©×œ QUIC:
------------------
â€¢ CPU intensive - ×”-encryption ××›×‘×™×“
â€¢ ×œ× ×›×œ ×”-routers ××‘×™× ×™× ××•×ª×• ×˜×•×‘
â€¢ ×¢×“×™×™×Ÿ ×¦×¢×™×¨ - ×œ× × ×ª××š ×‘×›×œ ××§×•×

××™ ××©×ª××© ×‘-QUIC ×”×™×•×?
-----------------------
â€¢ Google - Chrome, YouTube, Gmail
â€¢ Facebook
â€¢ CloudFlare
â€¢ 75% ××”-connections ×©×œ Chrome ××©×ª××©×™× ×‘-QUIC!

HTTP/3:
-------
HTTP/3 = HTTP over QUIC
×–××ª ×”×’×¨×¡×” ×”×‘××” ×©×œ HTTP, ××—×œ×™×¤×” ××ª HTTP/2 (×©×¢×•×‘×“ ×¢×œ TCP)

×¡×™×›×•× - ××™×š QUIC ××©×œ×‘ TCP ×•-UDP:
-----------------------------------
×-UDP: ×”××”×™×¨×•×ª, ×”×¤×©×˜×•×ª, ×”×’××™×©×•×ª
×-TCP: ×”×××™× ×•×ª, × ×™×”×•×œ ×—×™×‘×•×¨, congestion control
+ ×‘×•× ×•×¡: encryption ××•×‘× ×”, stream multiplexing

QUIC ×”×•× ×“×•×’××” ××¢×•×œ×” ×œ×›×š ×©×¤×¨×•×˜×•×§×•×œ×™× "×™×©× ×™×" (UDP, TCP) 
×¢×“×™×™×Ÿ ×™×›×•×œ×™× ×œ×©××© ×‘×¡×™×¡ ×œ×—×™×“×•×©×™× ××•×“×¨× ×™×™×!

×©××œ×” 6.4: ××ª×§×¤×•×ª ××‘×˜×—×” ×¢×œ UDP
-------------------------------

×¡×•×’×™ ××ª×§×¤×•×ª:
-------------

1. UDP Flood Attack (DDoS):
   ××¡×˜×¨×˜×’×™×”: ×©×œ×— ××™×œ×™×•× ×™ ×× ×•×ª UDP ×œ×©×¨×ª
   ××˜×¨×”: ×œ×”×¦×™×£ ××ª ×”×©×¨×ª ×•×œ×’×¨×•× ×œ×• ×œ×§×¨×•×¡
   
   ××™×š ×–×” ×¢×•×‘×“:
   â€¢ Attacker (××• botnet) ×©×•×œ×— ×× ×•×ª UDP ×¢×¦×•××•×ª
   â€¢ ×”×©×¨×ª ×× ×¡×” ×œ×¢×‘×“ ××ª ×›×•×œ×Ÿ
   â€¢ CPU/Network/Memory ××ª××œ××™×
   â€¢ ×©×¨×ª ×§×•×¨×¡ ××• ×œ× ××’×™×‘ ×œ-users ×œ×’×™×˜×™××™×™×
   
   ×“×•×’××”: Mirai botnet (2016) - ×ª×§×¤×” ××ª Dyn (DNS provider)
   ×”×©×ª××©×• ×‘-IoT devices (××¦×œ××•×ª, routers) ×œ×©×œ×•×— UDP flood

2. DNS Amplification Attack:
   ××¡×˜×¨×˜×’×™×”: ×”×©×ª××© ×‘-DNS servers ×›"××’×‘×¨×™×"
   
   ××™×š ×–×” ×¢×•×‘×“:
   â€¢ Attacker ×©×•×œ×— DNS query ×¢× source IP ××–×•×™×£ (×©×œ ×”×§×•×¨×‘×Ÿ)
   â€¢ Query ×§×˜×Ÿ (60 bytes) ×¢×œ ×¨×©×•××” ×’×“×•×œ×” â†’ Response ×’×“×•×œ (3000 bytes)
   â€¢ DNS server ×©×•×œ×— response ×¢× ×§ ×œ×§×•×¨×‘×Ÿ
   â€¢ Amplification factor: x50!
   
   ××“×•×¢ UDP ×××¤×©×¨ ×–××ª:
   â€¢ UDP ×œ× ××××ª source IP (TCP ×“×•×¨×© handshake)
   â€¢ IP spoofing ×§×œ ×‘-UDP

3. Port Scanning:
   ××¡×˜×¨×˜×’×™×”: ×’×œ×” ××™×œ×• ×¤×•×¨×˜×™× ×¤×ª×•×—×™×
   
   ××™×š ×–×” ×¢×•×‘×“:
   â€¢ ×©×œ×— UDP packet ×œ×›×œ ×¤×•×¨×˜ (1-65535)
   â€¢ ×× ×”×¤×•×¨×˜ ×¡×’×•×¨: ICMP "Port Unreachable"
   â€¢ ×× ×”×¤×•×¨×˜ ×¤×ª×•×—: ××™×Ÿ ×ª×’×•×‘×” (××• ×ª×’×•×‘×” ×¡×¤×¦×™×¤×™×ª)
   
   ×‘×¢×™×”: UDP port scan ××™×˜×™ ×›×™ ×¦×¨×™×š ×œ×—×›×•×ª ×œ-timeout

4. UDP Fragmentation Attack:
   ××¡×˜×¨×˜×’×™×”: ×©×œ×— fragments ××–×•×™×¤×™×
   
   ××™×š ×–×” ×¢×•×‘×“:
   â€¢ IP ×××¤×©×¨ ×œ×¤×¦×œ packets ×’×“×•×œ×™× (fragmentation)
   â€¢ Attacker ×©×•×œ×— fragments ××–×•×™×¤×™×/×—×•×¤×¤×™×
   â€¢ ×”×©×¨×ª ×× ×¡×” ×œ×”×¨×›×™×‘ ××•×ª× â†’ buffer overflow / crash

5. Reflection Attack:
   ×“×•××” ×œ-amplification, ××‘×œ ×‘×œ×™ ×”×’×‘×¨×”:
   â€¢ Attacker ×©×•×œ×— UDP ×œ-servers ×¨×‘×™× ×¢× source IP ××–×•×™×£
   â€¢ ×›×•×œ× ×¢×•× ×™× ×œ×§×•×¨×‘×Ÿ ×‘×•-×–×× ×™×ª
   â€¢ ×”×§×•×¨×‘×Ÿ ××•×¦×£ ×‘×ª×’×•×‘×•×ª

×“×¨×›×™ ×”×’× ×”:
-----------

1. Rate Limiting:
   â€¢ ×”×’×‘×œ ×›××•×ª UDP packets ×œ×©× ×™×™×” ××›×œ IP
   â€¢ ×× IP ×©×•×œ×— ×™×•×ª×¨ ×-X packets/sec â†’ block
   
   ×“×•×’××”:
   iptables -A INPUT -p udp -m limit --limit 100/s -j ACCEPT
   iptables -A INPUT -p udp -j DROP

2. Firewall Rules:
   â€¢ ××¤×©×¨ ×¨×§ ×¤×•×¨×˜×™× × ×“×¨×©×™× (53, 123...)
   â€¢ ×—×¡×•× ×¤×•×¨×˜×™× ×œ× × ×—×•×¦×™×
   â€¢ Stateful firewall - ×¢×§×•×‘ ××—×¨ "×©×™×—×•×ª" UDP
   
   iptables -A INPUT -p udp --dport 53 -j ACCEPT
   iptables -A INPUT -p udp -j DROP

3. Ingress/Egress Filtering:
   â€¢ Ingress: ×‘×“×•×§ ×©×”-source IP ×”×’×™×•× ×™
     (×œ× ×›×ª×•×‘×•×ª ×¤×¨×˜×™×•×ª ××‘×—×•×¥)
   â€¢ Egress: ×‘×“×•×§ ×©×”×œ×§×•×—×•×ª ×©×œ×š ×œ× ×©×•×œ×—×™× spoofed packets
   
   ×–×” ×¢×•×¦×¨ amplification attacks!

4. DDoS Mitigation Services:
   â€¢ ×©×™×¨×•×ª×™× ×›××• CloudFlare, Akamai
   â€¢ ××¡× × ×™× ×ª×¢×‘×•×¨×” ×–×“×•× ×™×ª ×œ×¤× ×™ ×©×”×™× ××’×™×¢×” ×œ×©×¨×ª
   â€¢ Anycast - ××¤×–×¨×™× ××ª ×”×”×ª×§×¤×” ×¢×œ servers ×¨×‘×™×

5. Network Monitoring:
   â€¢ ×’×œ×” ×“×¤×•×¡×™× ×—×©×•×“×™×:
     - spike ×¤×ª××•××™ ×‘-UDP traffic
     - ×”×¨×‘×” UDP ×-IPs ×©×•× ×™×
     - queries ×’×“×•×œ×™× ×××•×“
   
   ×›×œ×™×: Wireshark, Snort, Suricata

6. Disable Unnecessary Services:
   â€¢ ×× ××ª×” ×œ× ×¦×¨×™×š DNS resolver ×¤×•××‘×™ - ×›×‘×”
   â€¢ NTP server? ××™ ×¦×¨×™×š? ×›×‘×”!
   â€¢ ×¤×—×•×ª ×©×™×¨×•×ª×™× = ×¤×—×•×ª attack surface

7. Source Address Validation (BCP 38):
   â€¢ ISPs ×¦×¨×™×›×™× ×œ×•×•×“× ×©×œ×§×•×—×•×ª ×œ× ×©×•×œ×—×™× packets ×¢× IP ××–×•×™×£
   â€¢ ×× ×›×•×œ× ×”×™×• ×¢×•×©×™× ×–××ª, amplification attacks ×œ× ×”×™×• ×¢×•×‘×“×™×!

8. QUIC :)
   â€¢ ×¢×‘×•×¨ ×œ-QUIC ×©×™×© ×œ×• encryption ××•×‘× ×”
   â€¢ ×§×©×” ×™×•×ª×¨ ×œ×–×™×™×£

×¡×™×›×•×:
-------
UDP ×¤×’×™×¢ ×œ××ª×§×¤×•×ª ×›×™:
â€¢ ×œ× ××××ª source IP
â€¢ connectionless - ××™×Ÿ handshake
â€¢ stateless - ×§×©×” ×œ×–×”×•×ª ×”×ª× ×”×’×•×ª ×—×©×•×“×”

××‘×œ ×¢× ×”×’× ×•×ª × ×›×•× ×•×ª (rate limiting, filtering, monitoring)
××¤×©×¨ ×œ×”×©×ª××© ×‘-UDP ×‘×‘×˜×—×”.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    ×¨×¤×œ×§×¦×™×” ××™×©×™×ª
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. ××” ×”×™×” ×”×—×œ×§ ×”×××ª×’×¨ ×‘×™×•×ª×¨? ××™×š ×”×ª×’×‘×¨×ª ×¢×œ×™×•?
-------------------------------------------------------
×”×—×œ×§ ×”×›×™ ×××ª×’×¨ ×”×™×” ×‘× ×™×™×ª ×”-Ping-Pong client/server ×¢× ×”×˜×™×¤×•×œ 
×‘-timeouts. ×‘×”×ª×—×œ×” ×”×‘× ×ª×™ ××ª ×”×¨×¢×™×•×Ÿ ×ª×™××•×¨×˜×™×ª, ××‘×œ ×‘×™×™×©×•× ×”×ª×§×œ×ª×™ ×‘×‘×¢×™×•×ª:

×”×‘×¢×™×” ×”×¨××©×•× ×”: ×”-timeout ×œ× ×¢×‘×“ ×›××• ×©×¦×™×¤×™×ª×™. ×©×œ×—×ª×™ ×× ×”, ×•×”×ª×•×›× ×™×ª 
"× ×ª×§×¢×”" ×‘××§×•× ×œ×”××©×™×š. ×œ×§×— ×œ×™ ×–××Ÿ ×œ×”×‘×™×Ÿ ×©-sock.settimeout() ×¦×¨×™×š ×œ×”×™×•×ª 
×§×‘×•×¢, ×•×©×× ×™ ×¦×¨×™×š try/except socket.timeout.

××™×š ×”×ª×’×‘×¨×ª×™: ×§×¨××ª×™ ××ª ×”×“×•×§×•×× ×˜×¦×™×” ×©×œ Python socket ×•×¢×©×™×ª×™ × ×™×¡×•×™×™× ×§×˜× ×™×. 
×™×¦×¨×ª×™ ×§×•×‘×¥ test.py ×©×¨×§ ×‘×•×“×§ ××ª ×”-timeout ×‘× ×¤×¨×“, ×‘×œ×™ ×›×œ ×”×œ×•×’×™×§×” ×”××¡×•×‘×›×ª.

×”×‘×¢×™×” ×”×©× ×™×™×”: ×‘××¦×‘ burst, ×¡×‘×œ×ª×™ ××‘×¢×™×” ×©×§×©×” ×œ×ª××¨ - ×—×œ×§ ××”×× ×•×ª "×”×ª×¢×•×¤×¤×•" 
×•×œ× ×—×–×¨×•. ×’×™×œ×™×ª×™ ×©×–×” ×‘×’×œ×œ ×©×”-receive buffer ×©×œ ×”socket ×”×ª××œ×. 
×”×¤×ª×¨×•×Ÿ ×”×™×” ×œ×”×’×“×™×œ ××ª ×”buffer:
sock.setsockopt(SOL_SOCKET, SO_RCVBUF, 65536)

×”×œ×§×—: debugging ×–×” ×—×œ×§ ××”×ª×”×œ×™×š. ×œ× ×”×›×œ ×¢×•×‘×“ ×‘×¤×¢× ×”×¨××©×•× ×”, ×•×–×” ×‘×¡×“×¨.
×”×—×©×•×‘ ×–×” ×œ× ×œ×•×•×ª×¨, ×œ×¤×¨×§ ××ª ×”×‘×¢×™×” ×œ×—×œ×§×™× ×§×˜× ×™×, ×•×œ×‘×“×•×§ ×›×œ ×—×œ×§ ×‘× ×¤×¨×“.

2. ××” ×œ××“×ª ×¢×œ ×¢×¦××š ×›××ª×›× ×ª/×ª ×‘×¨×©×ª×•×ª?
--------------------------------------
×’×™×œ×™×ª×™ ×©×™×© ×œ×™ ×¡×‘×œ× ×•×ª ×œdebugging! ×–×” ×œ×§×— ×©×¢×•×ª ×œ××¦×•× ××ª ×”×‘××’ ×‘-burst test,
××‘×œ ×œ× ×”×ª×™×™××©×ª×™. ×”××©×›×ª×™ ×œ× ×¡×•×ª ×’×™×©×•×ª ×©×•× ×•×ª ×¢×“ ×©×”×‘× ×ª×™ ××” ×”×‘×¢×™×”.

×œ××“×ª×™ ×©×× ×™ ××¢×“×™×£/×” "×œ×¨××•×ª" ×“×‘×¨×™× - ×”×•×™×–×•××œ×™×–×¦×™×” ×©×œ ×”×× ×•×ª ×‘×–××Ÿ ×××ª
(×”-prints ×¢× âœ… ×•-âŒ) ×¢×–×¨×” ×œ×™ ×œ×”×‘×™×Ÿ ××” ×§×•×¨×”. ×× ×™ ×—×•×©×‘/×ª ×©×× ×™ visual learner.

×’×™×œ×™×ª×™ ×©×× ×™ ××•×”×‘/×ª ××ª ×¨××ª ×”control ×”× ××•×›×” - ×œ×¢×‘×•×“ ×¢× sockets, bytes, 
protocols. ×–×” ××¨×’×™×© ×™×•×ª×¨ "×××™×ª×™" ×××©×¨ ×œ×¢×‘×•×“ ×¢× APIs ×‘×¨××” ×’×‘×•×”×”. 
××•×œ×™ ×¢×ª×™×“ ×©×œ×™ ×‘×ª×›× ×•×ª ××¢×¨×›×•×ª ××• network engineering?

×’× ×”×‘× ×ª×™ ×©×¦×¨×™×š ×œ×§×¨×•× documentation ×˜×•×‘ ×™×•×ª×¨. ×”×ª×—×œ×ª×™ ×œ×›×ª×•×‘ ×§×•×“ ×œ×¤× ×™ 
×©×”×‘× ×ª×™ ×œ×’××¨×™ ××™×š socket.settimeout() ×¢×•×‘×“, ×•×–×” ×’×¨× ×œ×™ ×œ×‘×–×‘×– ×–××Ÿ.
×”×œ×§×—: ×ª×§×¨× ×œ×¤× ×™ ×©××ª×” ×›×•×ª×‘!

3. ××™×š ×”×™×™×ª×™ ××¡×‘×™×¨/×” UDP ×œ×—×‘×¨ ×©×œ× ×™×•×“×¢ ×ª×›× ×•×ª?
-----------------------------------------------
"×ª××¨ ×œ×¢×¦××š ×©××ª×” ×©×•×œ×— ××›×ª×‘×™×:

TCP ×–×” ×›××• ×¨×©×•× - ××ª×” ××§×‘×œ ××™×©×•×¨ ×§×‘×œ×”, ××ª×” ×™×•×“×¢ ×©×”××›×ª×‘ ×”×’×™×¢, ×•×× 
×”×•× ××‘×“ ×‘×“×•××¨ ×©×•×œ×—×™× ××•×ª×• ×©×•×‘. ×–×” ×××™×Ÿ ××‘×œ ××™×˜×™ - ×¦×¨×™×š ×œ×—×›×•×ª ×œ××™×©×•×¨×™×.

UDP ×–×” ×›××• ×–×¨×™×§×ª ××›×ª×‘×™× ××”×—×œ×•×Ÿ - ×–×•×¨×§ ×”×¨×‘×” ××”×¨, ××‘×œ ×œ× ×™×•×“×¢ ×× ×”×’×™×¢.
××•×œ×™ ×¨×•×— ×ª×©× ××•×ª×•, ××•×œ×™ ××™×©×”×• ×™×œ×›×•×“ ××•×ª×•, ××•×œ×™ ×™××‘×“. ××‘×œ ×–×” ××”×™×¨!

×‘×©×™×—×ª ×•×™×“××• ×¢× ×—×‘×¨, ××” ×¢×“×™×£?
- ×©×”×¤×™×§×¡×œ×™× ×™×’×™×¢×• ××™×“, ×’× ×× ××—×“-×©× ×™×™× ×™××‘×“×•? (UDP)
- ××• ×©×™×’×™×¢×• ×‘×•×•×“××•×ª, ××‘×œ ×¢× ×¢×™×›×•×‘ ×©×œ ×©× ×™×•×ª? (TCP)

×‘×¨×•×¨ ×©×¢×“×™×£ UDP! ×× ×—×‘×¨ ×©×œ×š ××–×™×– ×™×“, ××ª×” ×¨×•×¦×” ×œ×¨××•×ª ××ª ×–×” ×¢×›×©×™×•,
×œ× ×¢×•×“ 5 ×©× ×™×•×ª. ×× frame ××—×“ ×™××‘×“, ×œ× × ×•×¨× - ×”×‘× ×›×‘×¨ ×‘×“×¨×š."

×–×” ×”×”×¡×‘×¨ ×©×”×™×™×ª×™ × ×•×ª×Ÿ/×ª. ×× ×™ ×—×•×©×‘/×ª ×©×”×“×™××•×™ ×©×œ "××›×ª×‘×™×" ××•×œ "×–×¨×™×§×” ××”×—×œ×•×Ÿ"
××¡×‘×™×¨ ×”×™×˜×‘ ××ª ×”×”×‘×“×œ!

4. ××™×–×” × ×•×©× ×¨×©×ª × ×•×¡×£ ×”×™×™×ª ×¨×•×¦×” ×œ×œ××•×“? ×œ××”?
---------------------------------------------
×× ×™ ×¨×•×¦×” ×œ×œ××•×“ ×¢×œ **WebRTC** (Web Real-Time Communication)!

×œ××”?
×›×™ WebRTC ××©×œ×‘ ×”×¨×‘×” ×“×‘×¨×™× ×©×œ××“× ×•:
â€¢ ×”×•× ××©×ª××© ×‘-UDP (×“×¨×š DTLS)
â€¢ ×”×•× ×××¤×©×¨ video/audio streaming ×‘×–××Ÿ ×××ª
â€¢ ×”×•× ×¢×•×‘×“ ×‘×“×¤×“×¤×Ÿ - ××™×Ÿ ×¦×•×¨×š ×‘×ª×•×›× ×” × ×•×¡×¤×ª!
â€¢ ×”×•× peer-to-peer - ×”××—×©×‘×™× ××“×‘×¨×™× ×™×©×™×¨×•×ª ×‘×œ×™ ×©×¨×ª ×‘×××¦×¢

WebRTC ××¨×ª×§ ××•×ª×™ ×›×™ ×”×•× ×˜×›× ×•×œ×•×’×™×” ××•×“×¨× ×™×ª ×©×›×œ ××¤×œ×™×§×¦×™×” ×©×œ video chat
××©×ª××©×ª ×‘×” (Zoom, Google Meet, Discord). ×× ×™ ×¨×•×¦×” ×œ×”×‘×™×Ÿ ××™×š ×”× ××ª××•×“×“×™×
×¢× NAT traversal (××™×š ×©× ×™ ××—×©×‘×™× ×××—×•×¨×™ routers ××•×¦××™× ××—×“ ××ª ×”×©× ×™?),
××™×š ×”× ×¢×•×©×™× hole punching, ×•××” ×–×” STUN/TURN servers.

×’×, ×× ×™ ×¨×•×¦×” ×œ×‘× ×•×ª ××¤×œ×™×§×¦×™×™×ª video chat ××©×œ×™! ×“××™×™×Ÿ/×™ ×©×× ×™ ×™×›×•×œ/×” 
×œ×™×¦×•×¨ "Zoom ×‘×‘×™×ª" - ×–×” ×™×”×™×” ×¤×¨×•×™×§×˜ ××˜×•×¨×£.

× ×•×©××™× × ×•×¡×¤×™× ×©××¢× ×™×™× ×™×:
â€¢ Software Defined Networking (SDN)
â€¢ Network Automation ×¢× Python
â€¢ Kubernetes networking
â€¢ DNS internals (××™×š DNS ×‘×××ª ×¢×•×‘×“?)

××‘×œ WebRTC ×”×•× ×”××¡×¤×¨ 1 ×‘×¨×©×™××” ×©×œ×™!

5. ×“×™×¨×•×’ ×¢×¦××™ - ×”×‘× ×ª UDP (1-10)
--------------------------------
×× ×™ ××“×¨×’/×ª ××ª ×¢×¦××™: 8/10

×”×¡×‘×¨:
------
×× ×™ ××¨×’×™×©/×” ×©×”×‘× ×ª×™ ×”×™×˜×‘:
âœ… ××” UDP ×¢×•×©×” ×•××” ×”×•× ×œ× ×¢×•×©×”
âœ… ××‘× ×” ×”×× ×” - ×”-4 ×©×“×•×ª ×•×ª×¤×§×™×“×
âœ… ×”×”×‘×“×œ×™× ×‘×™×Ÿ UDP ×œ-TCP
âœ… ××ª×™ ×œ×”×©×ª××© ×‘-UDP ×•××ª×™ ×œ×
âœ… ××™×š ×œ×›×ª×•×‘ ×§×•×“ ×©×¢×•×‘×“ ×¢× UDP (sockets)
âœ… ××™×š ×œ× ×ª×— ×× ×•×ª UDP ×¢× Scapy
âœ… ×”××ª×’×¨×™× ×©×œ unreliability ×•××™×š ×œ×”×ª××•×“×“ ××™×ª×

×œ××” ×œ× 10?
----------
×™×© ×¢×•×“ ×“×‘×¨×™× ×©×× ×™ ×œ× ×‘×˜×•×—/×” ×©×”×‘× ×ª×™ ×œ×’××¨×™:
â€¢ ××™×š UDP checksum ××—×•×©×‘ ×‘×“×™×•×§
â€¢ ×¤×¨×˜×™× ×¢×œ UDP socket options (SO_RCVBUF, SO_BROADCAST...)
â€¢ ××™×š UDP over IPv6 ×©×•× ×” ×-IPv4
â€¢ UDP-Lite (variant ×©×œ UDP)
â€¢ ××™×š ××¢×¨×›×•×ª ×”×¤×¢×œ×” ××˜×¤×œ×•×ª ×‘-UDP internals

×× ×™ ×’× ×¨×•×¦×” ×œ×”×¢××™×§ ×‘:
â€¢ Zero-copy networking
â€¢ QUIC implementation details
â€¢ UDP performance tuning

×œ××” 8 ×–×” ×˜×•×‘:
--------------
×× ×™ ××××™×Ÿ/×” ×©×”×‘× ×” ×©×œ 80% ×–×” ××¦×•×™×Ÿ ×œ×ª×œ××™×“ ×ª×™×›×•×Ÿ! ×× ×™ ×™×›×•×œ/×”:
â€¢ ×œ×”×¡×‘×™×¨ UDP ×œ××—×¨×™×
â€¢ ×œ×›×ª×•×‘ ×§×•×“ ×©×¢×•×‘×“
â€¢ ×œ× ×ª×— ×‘×¢×™×•×ª ×¨×©×ª
â€¢ ×œ×”×‘×™×Ÿ ××××¨×™× ×˜×›× ×™×™× ×¢×œ UDP

×”-20% ×©×—×¡×¨×™× ×œ×™ ×™×’×™×¢×• ×¢× × ×™×¡×™×•×Ÿ - ×¤×¨×•×™×§×˜×™×, ×¢×‘×•×“×”, ×œ×™××•×“×™× ××ª×§×“××™×.
×× ×™ ××¨×’×™×©/×” ××•×›×Ÿ/×” ×œ×”××©×™×š ×œ× ×•×©× ×”×‘× ×‘×¨×©×ª×•×ª!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        ×¡×™×›×•×
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

×–××Ÿ ×¢×‘×•×“×”: ×›-6 ×©×¢×•×ª (×›×•×œ×œ debugging, testing, ×›×ª×™×‘×”)
×¨××ª ×§×•×©×™ ×¡×•×‘×™×™×§×˜×™×‘×™×ª: 7/10
×”× ××”: 10/10 !

×ª×•×“×” ×¢×œ ×”×ª×¨×’×™×œ ×”××¢× ×™×™×Ÿ! ×œ××“×ª×™ ×”×¨×‘×” ×•×”×‘× ×ª×™ ×©×¨×©×ª×•×ª ×–×” ×ª×—×•× ××¨×ª×§.
××¦×¤×” ×œ×ª×¨×’×™×œ ×”×‘× ğŸš€

--
×™×•×¡×™ ×›×”×Ÿ, ×™×'2
