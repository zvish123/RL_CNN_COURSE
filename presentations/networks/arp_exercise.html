<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××‘×¦×¢ ×–×™×”×•×™ ×”×ª×•×§×£ - ARP Poisoning Lab</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #c31432 0%, #240b36 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: "ğŸš¨";
            position: absolute;
            font-size: 150px;
            opacity: 0.1;
            right: 50px;
            top: -20px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            position: relative;
            z-index: 1;
        }

        .header .subtitle {
            font-size: 1.3em;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        .alert-box {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
            padding: 25px;
            margin: 20px;
            border-radius: 15px;
            border-right: 6px solid #c92a2a;
            box-shadow: 0 10px 30px rgba(201, 42, 42, 0.3);
        }

        .alert-box h2 {
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .alert-box .time {
            font-size: 0.9em;
            opacity: 0.9;
            margin-top: 10px;
        }

        .mission-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            margin: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .mission-card h2 {
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .mission-card ul {
            margin-right: 20px;
            line-height: 2;
        }

        .mission-card li {
            margin: 10px 0;
            padding-right: 10px;
        }

        .content {
            padding: 40px;
        }

        .section {
            background: #f8f9fa;
            padding: 30px;
            margin: 25px 0;
            border-radius: 15px;
            border-right: 5px solid #667eea;
        }

        .section h3 {
            color: #667eea;
            font-size: 1.6em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .theory-box {
            background: #e7f3ff;
            border-right: 4px solid #2196F3;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
        }

        .theory-box h4 {
            color: #1976D2;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .theory-box p, .theory-box ul {
            line-height: 1.8;
            color: #333;
            margin: 10px 0;
        }

        .theory-box ul {
            margin-right: 20px;
        }

        .code-editor {
            background: #1e1e1e;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .code-header {
            background: #323232;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .code-header .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot.red { background: #ff5f56; }
        .dot.yellow { background: #ffbd2e; }
        .dot.green { background: #27c93f; }

        .code-header .filename {
            color: #ccc;
            margin-right: 15px;
            font-family: monospace;
        }

        .code-content {
            padding: 20px;
            color: #d4d4d4;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            overflow-x: auto;
            direction: ltr;
            text-align: left;
        }

        .code-content .comment {
            color: #6A9955;
        }

        .code-content .keyword {
            color: #569CD6;
        }

        .code-content .string {
            color: #CE9178;
        }

        .code-content .function {
            color: #DCDCAA;
        }

        .code-content .variable {
            color: #9CDCFE;
        }

        .task-card {
            background: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
            border-right: 4px solid #f59e0b;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .task-number {
            display: inline-block;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .task-card h4 {
            color: #1f2937;
            margin: 15px 0;
            font-size: 1.2em;
        }

        textarea, input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            transition: border-color 0.3s;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        textarea:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }

        .feedback {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            display: none;
            animation: slideIn 0.3s;
        }

        .feedback.success {
            background: #d4edda;
            border-right: 4px solid #28a745;
            color: #155724;
        }

        .feedback.error {
            background: #f8d7da;
            border-right: 4px solid #dc3545;
            color: #721c24;
        }

        .feedback.info {
            background: #d1ecf1;
            border-right: 4px solid #17a2b8;
            color: #0c5460;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .hint-box {
            background: #fff8e1;
            border-right: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .hint-box:hover {
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.3);
        }

        .hint-box h4 {
            color: #f57c00;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hint-content {
            display: none;
            margin-top: 15px;
            color: #555;
            line-height: 1.8;
        }

        .hint-box.open .hint-content {
            display: block;
        }

        .hint-box.open h4::after {
            content: " â–¼";
        }

        .hint-box h4::after {
            content: " â—„";
            font-size: 0.8em;
        }

        .network-diagram {
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
        }

        .diagram-node {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin: 10px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .diagram-node.attacker {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .diagram-node.victim {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .diagram-arrow {
            display: inline-block;
            margin: 0 10px;
            font-size: 1.5em;
            color: #667eea;
        }

        .terminal {
            background: #000;
            color: #0f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
            direction: ltr;
            text-align: left;
        }

        .terminal .prompt {
            color: #0f0;
        }

        .terminal .output {
            color: #fff;
        }

        .terminal .error {
            color: #f00;
        }

        .progress-tracker {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .progress-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-right: 4px solid #ddd;
        }

        .progress-item.completed {
            border-color: #4CAF50;
            background: #e8f5e9;
        }

        .progress-item .icon {
            font-size: 1.5em;
            margin-left: 15px;
        }

        .badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 5px;
        }

        .badge-level1 {
            background: #4CAF50;
            color: white;
        }

        .badge-level2 {
            background: #ff9800;
            color: white;
        }

        .badge-level3 {
            background: #f44336;
            color: white;
        }

        .gemini-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            margin: 25px 0;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .gemini-section h3 {
            color: white;
            margin-bottom: 20px;
        }

        .api-result {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            backdrop-filter: blur(10px);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .content {
                padding: 20px;
            }

            .diagram-node {
                display: block;
                margin: 10px auto;
            }

            .diagram-arrow {
                display: block;
                transform: rotate(90deg);
                margin: 10px auto;
            }
        }

        .download-btn {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            text-decoration: none;
            display: inline-block;
            margin: 10px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(17, 153, 142, 0.3);
            transition: all 0.3s;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(17, 153, 142, 0.4);
        }

        .warning-box {
            background: #fff3cd;
            border-right: 4px solid #ff9800;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            color: #856404;
        }

        .warning-box strong {
            color: #d32f2f;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš¨ ××‘×¦×¢ ×–×™×”×•×™ ×”×ª×•×§×£</h1>
            <p class="subtitle">××¢×‘×“×” ××¢×©×™×ª: ×–×™×”×•×™ ×•×× ×™×¢×ª ARP Poisoning ×¢× Python & Scapy</p>
        </div>

        <div class="alert-box">
            <h2>âš ï¸ ×”×ª×¨××ª ××‘×˜×—×” ×“×—×•×¤×”!</h2>
            <p style="font-size: 1.1em; line-height: 1.8;">
                <strong>×:</strong> ×× ×”×œ ××‘×˜×—×ª ×”××™×“×¢ - CyberTech Corp<br>
                <strong>××œ:</strong> ×¦×•×•×ª ×”×¡×™×™×‘×¨ ×”×¦×¢×™×¨<br>
                <strong>× ×•×©×:</strong> ×¤×¢×™×œ×•×ª ×—×©×•×“×” ×‘×¨×©×ª ×”×—×‘×¨×”
            </p>
            <p style="margin-top: 15px; line-height: 1.8;">
                ×‘×•×§×¨ ×˜×•×‘ ×—×•×§×¨×™×,<br><br>
                ×‘××”×œ×š ×”×©×¢×•×ª ×”××—×¨×•× ×•×ª ×–×™×”×™× ×• ×¤×¢×™×œ×•×ª ×—×¨×™×’×” ×‘×¨×©×ª ×”×¤× ×™××™×ª ×©×œ ×”×—×‘×¨×”. × ×¨××” ×©×ª×•×§×£ ××ª×•×—×›×
                ×× ×¡×” ×œ×™×™×¨×˜ ×ª×¢×‘×•×¨×ª ×¨×©×ª ×¨×’×™×©×” ×‘×××¦×¢×•×ª ××ª×§×¤×ª <strong>ARP Poisoning</strong>.
                ×× ×”×œ ×”×¤×™×ª×•×— ×“×™×•×•×— ×¢×œ ×”××˜×” ××©××¢×•×ª×™×ª ×‘×ª×§×©×•×¨×ª ×”×¨×©×ª, ×•××¢×¨×›×•×ª ×”××‘×˜×—×” ×©×œ× ×• ×–×™×”×• ×›×ª×•×‘×•×ª MAC
                ×›×¤×•×œ×•×ª ×‘×˜×‘×œ××•×ª ARP.<br><br>
                <strong style="color: #ffe066;">×”××©×™××” ×©×œ×›×: ×œ×‘× ×•×ª ×›×œ×™ ×–×™×”×•×™ ××•×˜×•××˜×™ ×©×™×’×œ×” ××ª ×”×ª×•×§×£ ×‘×–××Ÿ ×××ª!</strong>
            </p>
            <p class="time">ğŸ• ×–××Ÿ ××©×•×¢×¨ ×œ××©×™××”: 90-120 ×“×§×•×ª | ×¨××ª ×“×—×™×¤×•×ª: ×’×‘×•×”×”</p>
        </div>

        <div class="mission-card">
            <h2>ğŸ¯ ×™×¢×“×™ ×”××©×™××”</h2>
            <ul>
                <li>ğŸ” <strong>×©×œ×‘ 1:</strong> ×”×‘× ×ª ××ª×§×¤×ª ARP Poisoning ×•×”×“×¨×š ×©×‘×” ×”×™× ×¤×•×¢×œ×ª</li>
                <li>ğŸ’» <strong>×©×œ×‘ 2:</strong> ×›×ª×™×‘×ª ×§×•×“ Python ×¢× Scapy ×œ×–×™×”×•×™ ×”××ª×§×¤×”</li>
                <li>âš¡ <strong>×©×œ×‘ 3:</strong> × ×™×˜×•×¨ ×¨×©×ª ×‘×–××Ÿ ×××ª ×•×–×™×”×•×™ ×”×ª×•×§×£</li>
                <li>ğŸ¤– <strong>×©×œ×‘ 4:</strong> ×©×™××•×© ×‘-Gemini AI ×œ× ×™×ª×•×— ××ª×§×“× ×•×”××œ×¦×•×ª ×”×’× ×”</li>
                <li>ğŸ›¡ï¸ <strong>×©×œ×‘ 5:</strong> ×‘× ×™×™×ª ××¢×¨×›×ª ×”×’× ×” ××œ××”</li>
            </ul>
        </div>

        <div class="content">
            <!-- Section 1: Theory -->
            <div class="section">
                <h3>ğŸ“š ×©×œ×‘ 1: ×”×‘× ×ª ×”××™×•× - ARP Poisoning</h3>

                <div class="theory-box">
                    <h4>××” ×–×” ×¤×¨×•×˜×•×§×•×œ ARP?</h4>
                    <p><strong>ARP (Address Resolution Protocol)</strong> ×”×•× ×¤×¨×•×˜×•×§×•×œ ×©×××™×¨ ×›×ª×•×‘×•×ª IP ×œ×›×ª×•×‘×•×ª MAC ×‘×¨×©×ª ××§×•××™×ª.</p>
                    <p><strong>×œ××” ×–×” × ×—×•×¥?</strong> ×›×“×™ ×œ×©×œ×•×— ××™×“×¢ ×‘×¨×©×ª ××§×•××™×ª, ×”××—×©×‘ ×¦×¨×™×š ×œ×“×¢×ª ××ª ×›×ª×•×‘×ª ×”-MAC ×©×œ ×”××›×©×™×¨ ×”×™×¢×“.</p>

                    <p style="margin-top: 15px;"><strong>×ª×”×œ×™×š ARP ×ª×§×™×Ÿ:</strong></p>
                    <ol style="margin-right: 20px; line-height: 2;">
                        <li>××—×©×‘ A ×¨×•×¦×” ×œ×©×œ×•×— ××™×“×¢ ×œ××—×©×‘ B (×™×•×“×¢ ×¨×§ ××ª ×”-IP)</li>
                        <li>××—×©×‘ A ×©×•×œ×— <strong>ARP Request</strong> (broadcast): "××™ ×”×‘×¢×œ×™× ×©×œ IP ×”×–×”?"</li>
                        <li>××—×©×‘ B ×¢×•× ×” <strong>ARP Reply</strong>: "×–×” ×× ×™! ×›×ª×•×‘×ª ×”-MAC ×©×œ×™ ×”×™× XX:XX:XX"</li>
                        <li>××—×©×‘ A ×©×•××¨ ××ª ×”××™×“×¢ ×‘-<strong>ARP Cache</strong> ×œ×©×™××•×© ×¢×ª×™×“×™</li>
                    </ol>
                </div>

                <div class="theory-box" style="border-color: #f44336; background: #ffebee;">
                    <h4 style="color: #c62828;">ğŸ”´ ××” ×–×” ARP Poisoning?</h4>
                    <p><strong>ARP Poisoning</strong> (××• ARP Spoofing) ×”×™× ××ª×§×¤×” ×©×‘×” ×”×ª×•×§×£ ×©×•×œ×— ×”×•×“×¢×•×ª ARP ××–×•×™×¤×•×ª ×œ×¨×©×ª.</p>

                    <p style="margin-top: 15px;"><strong>××” ×§×•×¨×” ×‘××ª×§×¤×”?</strong></p>
                    <ul>
                        <li>×”×ª×•×§×£ ××•××¨ ×œ×§×•×¨×‘×Ÿ: "×× ×™ ×”× ×ª×‘! ×©×œ×— ×œ×™ ××ª ×›×œ ×”×ª×¢×‘×•×¨×”!"</li>
                        <li>×”×ª×•×§×£ ××•××¨ ×œ× ×ª×‘: "×× ×™ ×”×§×•×¨×‘×Ÿ! ×©×œ×— ×œ×™ ××ª ×›×œ ×”×ª×¢×‘×•×¨×” ×©×œ×•!"</li>
                        <li>×›×œ ×”×ª×¢×‘×•×¨×” ×‘×™×Ÿ ×”×§×•×¨×‘×Ÿ ×œ××™× ×˜×¨× ×˜ ×¢×•×‘×¨×ª ×“×¨×š ×”×ª×•×§×£</li>
                        <li>×”×ª×•×§×£ ×™×›×•×œ ×œ×§×¨×•×, ×œ×©× ×•×ª, ××• ×œ×—×¡×•× ××ª ×”××™×“×¢</li>
                    </ul>

                    <p style="margin-top: 15px;"><strong>×œ××” ×–×” ××¡×•×›×Ÿ?</strong></p>
                    <ul>
                        <li>ğŸ’³ ×’× ×™×‘×ª ×¡×™×¡×××•×ª ×•×¤×¨×˜×™ ×›×¨×˜×™×¡×™ ××©×¨××™</li>
                        <li>ğŸ“§ ×§×¨×™××ª ×”×•×“×¢×•×ª ×¤×¨×˜×™×•×ª ×•××™××™×™×œ×™×</li>
                        <li>ğŸ­ ×”×ª×—×–×•×ª ×œ××©×ª××©×™× ××—×¨×™×</li>
                        <li>ğŸš« ×× ×™×¢×ª ×’×™×©×” ×œ××™× ×˜×¨× ×˜ (DoS)</li>
                    </ul>
                </div>

                <div class="network-diagram">
                    <h4>×ª×¨×©×™×: ××ª×§×¤×ª ARP Poisoning</h4>
                    <div style="margin: 30px 0;">
                        <div class="diagram-node victim">ğŸ–¥ï¸ ×§×•×¨×‘×Ÿ<br>192.168.1.10</div>
                        <div class="diagram-arrow">âš¡</div>
                        <div class="diagram-node attacker">ğŸ‘¤ ×ª×•×§×£<br>192.168.1.42<br>MAC: AA:BB:CC:DD:EE:01</div>
                        <div class="diagram-arrow">âš¡</div>
                        <div class="diagram-node">ğŸŒ × ×ª×‘ (Gateway)<br>192.168.1.1</div>
                    </div>
                    <p style="color: #d32f2f; font-weight: bold;">
                        ×”×ª×•×§×£ ××©×›× ×¢ ××ª ×”×§×•×¨×‘×Ÿ ×•×”× ×ª×‘ ×©×”×•× ×”×××¦×¢×™ ×‘×™× ×™×”×!
                    </p>
                </div>
            </div>

            <!-- Section 2: Basic Detection Code -->
            <div class="section">
                <h3>ğŸ’» ×©×œ×‘ 2: ×‘× ×™×™×ª ×’×œ××™ ARP Poisoning ×‘×¡×™×¡×™</h3>

                <div class="theory-box">
                    <h4>××” ×–×” Scapy?</h4>
                    <p><strong>Scapy</strong> ×”×™× ×¡×¤×¨×™×™×” ×—×–×§×” ×‘-Python ×œ×™×¦×™×¨×”, ×©×œ×™×—×” ×•× ×™×ª×•×— ×©×œ ×—×‘×™×œ×•×ª ×¨×©×ª.</p>
                    <p><strong>×™×›×•×œ×•×ª:</strong> ×™×¦×™×¨×ª ×—×‘×™×œ×•×ª ××•×ª×××•×ª ××™×©×™×ª, ×¡×¨×™×§×ª ×¨×©×ª, × ×™×ª×•×— ×¤×¨×•×˜×•×§×•×œ×™×, ×‘× ×™×™×ª ×›×œ×™ ××‘×˜×—×”</p>
                </div>

                <div class="warning-box">
                    <strong>âš ï¸ ×”×¢×¨×ª ××‘×˜×—×” ×—×©×•×‘×”:</strong><br>
                    ×›×œ ×”×§×•×“ ×‘××¢×‘×“×” ×–×• ××™×•×¢×“ ×œ××˜×¨×•×ª ×—×™× ×•×›×™×•×ª ×‘×œ×‘×“! ××™×Ÿ ×œ×‘×¦×¢ ××ª×§×¤×•×ª ×¢×œ ×¨×©×ª×•×ª ×©××™× ×›× ××•×¨×©×™× ×œ×‘×“×•×§.
                    ×©×™××•×© ×‘×›×œ×™× ××œ×• ×‘×¨×©×ª×•×ª ×¦×™×‘×•×¨×™×•×ª ××• ×¤×¨×˜×™×•×ª ×œ×œ× ××™×©×•×¨ ×”×•× <strong>×¢×‘×™×¨×” ×¤×œ×™×œ×™×ª</strong>.
                </div>

                <h4 style="margin: 20px 0;">×”×ª×§× ×ª Scapy</h4>
                <div class="terminal">
<span class="prompt">$</span> pip install scapy
<span class="output">Collecting scapy
  Downloading scapy-2.5.0-py2.py3-none-any.whl (1.2 MB)
Successfully installed scapy-2.5.0</span>
                </div>

                <h4 style="margin: 20px 0;">×§×•×“ ××œ×: ×’×œ××™ ARP Poisoning</h4>

                <div class="code-editor">
                    <div class="code-header">
                        <div class="dot red"></div>
                        <div class="dot yellow"></div>
                        <div class="dot green"></div>
                        <span class="filename">arp_detector.py</span>
                    </div>
                    <pre class="code-content"><span class="keyword">from</span> scapy.all <span class="keyword">import</span> sniff, ARP
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime

<span class="comment"># ×˜×‘×œ×” ×œ×©××™×¨×ª ××™×¤×•×™×™ IP-MAC ×©× ×¦×¤×•</span>
arp_table = {}

<span class="comment"># ××•× ×” ×”×ª×¨××•×ª</span>
alert_count = 0

<span class="keyword">def</span> <span class="function">detect_arp_poisoning</span>(packet):
    <span class="string">"""
    ×¤×•× ×§×¦×™×” ×©×× ×ª×—×ª ×›×œ ×—×‘×™×œ×ª ARP ×•××–×”×” ××ª×§×¤×•×ª
    """</span>
    <span class="keyword">global</span> alert_count

    <span class="comment"># ×‘×“×™×§×” ×©×™×© ×©×›×‘×ª ARP ×‘×—×‘×™×œ×”</span>
    <span class="keyword">if</span> packet.haslayer(ARP):
        <span class="comment"># ×—×™×œ×•×¥ ××™×“×¢ ××”×—×‘×™×œ×”</span>
        ip_src = packet[ARP].psrc    <span class="comment"># ×›×ª×•×‘×ª IP ××§×•×¨</span>
        mac_src = packet[ARP].hwsrc   <span class="comment"># ×›×ª×•×‘×ª MAC ××§×•×¨</span>

        <span class="comment"># ×–×™×”×•×™ ×©×™× ×•×™ ×‘××™×¤×•×™ IP-MAC</span>
        <span class="keyword">if</span> ip_src <span class="keyword">in</span> arp_table:
            <span class="keyword">if</span> arp_table[ip_src] != mac_src:
                <span class="comment"># ğŸš¨ ×”×ª×¨××”! ×›×ª×•×‘×ª MAC ×”×©×ª× ×ª×” ×œ××•×ª×” IP</span>
                alert_count += 1
                timestamp = datetime.now().strftime(<span class="string">"%H:%M:%S"</span>)

                <span class="keyword">print</span>(<span class="string">f"\n{'='*70}"</span>)
                <span class="keyword">print</span>(<span class="string">f"ğŸš¨ [ALERT #{alert_count}] ×–×•×”×ª×” ××ª×§×¤×ª ARP Poisoning!"</span>)
                <span class="keyword">print</span>(<span class="string">f"â° ×–××Ÿ: {timestamp}"</span>)
                <span class="keyword">print</span>(<span class="string">f"ğŸ“ IP: {ip_src}"</span>)
                <span class="keyword">print</span>(<span class="string">f"ğŸ”´ MAC ×™×©×Ÿ: {arp_table[ip_src]}"</span>)
                <span class="keyword">print</span>(<span class="string">f"ğŸ”´ MAC ×—×“×©: {mac_src}"</span>)
                <span class="keyword">print</span>(<span class="string">f"{'='*70}\n"</span>)

                <span class="comment"># ×¢×“×›×•×Ÿ ×”×˜×‘×œ×”</span>
                arp_table[ip_src] = mac_src
        <span class="keyword">else</span>:
            <span class="comment"># IP ×—×“×© - × ×•×¡×™×£ ×œ×˜×‘×œ×”</span>
            arp_table[ip_src] = mac_src
            <span class="keyword">print</span>(<span class="string">f"âœ… ××™×¤×•×™ ×—×“×©: {ip_src} -> {mac_src}"</span>)

<span class="keyword">def</span> <span class="function">start_monitoring</span>():
    <span class="string">"""
    ×”×¤×¢×œ×ª × ×™×˜×•×¨ ×¨×©×ª
    """</span>
    <span class="keyword">print</span>(<span class="string">"="</span> * 70)
    <span class="keyword">print</span>(<span class="string">"ğŸ” ××¢×¨×›×ª ×–×™×”×•×™ ARP Poisoning ×”×•×¤×¢×œ×”"</span>)
    <span class="keyword">print</span>(<span class="string">"ğŸ“¡ ×××–×™×Ÿ ×œ×ª×¢×‘×•×¨×ª ARP ×‘×¨×©×ª..."</span>)
    <span class="keyword">print</span>(<span class="string">"âŒ ×œ×¢×¦×™×¨×”: Ctrl+C"</span>)
    <span class="keyword">print</span>(<span class="string">"="</span> * 70 + <span class="string">"\n"</span>)

    <span class="keyword">try</span>:
        <span class="comment"># ×”××–× ×” ×œ×—×‘×™×œ×•×ª ARP ×‘×œ×‘×“</span>
        sniff(filter=<span class="string">"arp"</span>, prn=detect_arp_poisoning, store=0)
    <span class="keyword">except</span> KeyboardInterrupt:
        <span class="keyword">print</span>(<span class="string">f"\n\nğŸ›‘ ×”× ×™×˜×•×¨ ×”×•×¤×¡×§"</span>)
        <span class="keyword">print</span>(<span class="string">f"ğŸ“Š ×¡×”\"×› ×”×ª×¨××•×ª: {alert_count}"</span>)
        <span class="keyword">print</span>(<span class="string">f"ğŸ“‹ ××›×©×™×¨×™× ×©× ×¦×¤×•: {len(arp_table)}"</span>)

<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    start_monitoring()</pre>
                </div>

                <div class="task-card">
                    <span class="task-number">××©×™××” 2.1</span>
                    <h4>×”×‘× ×ª ×”×§×•×“</h4>
                    <p>×¢× ×” ×¢×œ ×”×©××œ×•×ª ×”×‘××•×ª ×œ×’×‘×™ ×”×§×•×“:</p>

                    <p style="margin-top: 15px;"><strong>1. ××” ×¢×•×©×” ×”×©×•×¨×” <code>if packet.haslayer(ARP)</code>?</strong></p>
                    <textarea id="q2_1" placeholder="×”×¡×‘×¨ ×›××Ÿ..."></textarea>

                    <p style="margin-top: 15px;"><strong>2. ××“×•×¢ ×× ×—× ×• ××©×ª××©×™× ×‘××™×œ×•×Ÿ (dictionary) ×‘×©× arp_table?</strong></p>
                    <textarea id="q2_2" placeholder="×”×¡×‘×¨ ×›××Ÿ..."></textarea>

                    <p style="margin-top: 15px;"><strong>3. ×‘××™×–×” ××§×¨×” × ×“×œ×™×§ ×”×ª×¨××”?</strong></p>
                    <textarea id="q2_3" placeholder="×”×¡×‘×¨ ×›××Ÿ..."></textarea>

                    <button class="btn btn-primary" onclick="checkUnderstanding()">×‘×“×•×§ ×ª×©×•×‘×•×ª</button>
                    <div class="feedback" id="feedback_understanding"></div>
                </div>

                <div class="hint-box" onclick="toggleHint('hint1')">
                    <h4>ğŸ’¡ ×¨××– ×œ×”×‘× ×ª ×”×§×•×“</h4>
                    <div class="hint-content" id="hint1">
                        <p><strong>packet.haslayer(ARP):</strong> ×‘×•×“×§ ×× ×‘×—×‘×™×œ×” ×™×© ×©×›×‘×ª ARP (×œ× ×›×œ ×—×‘×™×œ×” ×‘×¨×©×ª ×”×™× ARP)</p>
                        <p><strong>arp_table:</strong> ××™×œ×•×Ÿ ×©-key ×”×•× IP ×•-value ×”×•× MAC - ×××¤×©×¨ ×—×™×¤×•×© ××”×™×¨</p>
                        <p><strong>×”×ª×¨××”:</strong> ×›××©×¨ IP ×§×™×™× ××‘×œ ×”-MAC ×©×•× ×” ××”×©××•×¨ - ×¡×™××Ÿ ×œ××ª×§×¤×”!</p>
                    </div>
                </div>

                <div class="task-card">
                    <span class="task-number">××©×™××” 2.2</span>
                    <h4>×©×™×¤×•×¨ ×”×§×•×“ - ×”×•×¡×¤×ª ×ª×›×•× ×•×ª</h4>
                    <p>×©×¤×¨ ××ª ×”×§×•×“ ×‘×“×¨×›×™× ×”×‘××•×ª:</p>

                    <ol style="margin-right: 20px; line-height: 2;">
                        <li><strong>×©××™×¨×ª ×œ×•×’ ×œ×§×•×‘×¥:</strong> ×›×œ ×”×ª×¨××” ×ª×™×©××¨ ×‘×§×•×‘×¥ <code>alerts.log</code></li>
                        <li><strong>×¡×™× ×•×Ÿ IP ×©×œ Gateway:</strong> ×”×ª×¨×¢×” ××™×•×—×“×ª ×× ×”-Gateway ×”×•×ª×§×£</li>
                        <li><strong>×¡×¤×™×¨×ª ×–××Ÿ:</strong> ×”×¦×’ ×›××” ×–××Ÿ ×¢×‘×¨ ××”×”×ª×¨××” ×”×¨××©×•× ×”</li>
                    </ol>

                    <p style="margin-top: 20px;"><strong>×”×“×‘×§ ×›××Ÿ ××ª ×”×§×•×“ ×”××©×•×¤×¨ ×©×œ×š:</strong></p>
                    <textarea id="improved_code" style="min-height: 300px;" placeholder="# ×”×“×‘×§ ×›××Ÿ ××ª ×”×§×•×“ ×”××©×•×¤×¨..."></textarea>

                    <button class="btn btn-primary" onclick="saveImprovedCode()">×©××•×¨ ×§×•×“</button>
                    <button class="btn btn-success" onclick="testImprovedCode()">×‘×“×•×§ ×ª×§×™× ×•×ª</button>
                    <div class="feedback" id="feedback_improved"></div>
                </div>
            </div>

            <!-- Section 3: Advanced Detection -->
            <div class="section">
                <h3>âš¡ ×©×œ×‘ 3: ×–×™×”×•×™ ××ª×§×“× ×•× ×™×ª×•×— ×“×¤×•×¡×™×</h3>

                <div class="theory-box">
                    <h4>×–×™×”×•×™ ××ª×§×“× ×©×œ ××ª×§×¤×•×ª ARP</h4>
                    <p>×’×œ××™ ×‘×¡×™×¡×™ ××–×”×” ×©×™× ×•×™ MAC, ××‘×œ ×ª×•×§×¤×™× ××ª×•×—×›××™× ×¢×©×•×™×™×:</p>
                    <ul>
                        <li>×œ×©×œ×•×— ×—×‘×™×œ×•×ª ARP ×‘××¨×•×•×—×™× ×§×‘×•×¢×™×</li>
                        <li>×œ×©×“×¨ ××›××” ×›×ª×•×‘×•×ª MAC ×©×•× ×•×ª</li>
                        <li>×œ×ª×§×•×£ ×¨×§ ××›×©×™×¨×™× ×¡×¤×¦×™×¤×™×™×</li>
                    </ul>
                    <p><strong>× ×¦×˜×¨×š ×’×™×œ×•×™ ××ª×§×“× ×™×•×ª×¨!</strong></p>
                </div>

                <h4 style="margin: 20px 0;">×§×•×“ ××ª×§×“×: × ×™×ª×•×— ×“×¤×•×¡×™× ×•×¡×˜×˜×™×¡×˜×™×§×”</h4>

                <div class="code-editor">
                    <div class="code-header">
                        <div class="dot red"></div>
                        <div class="dot yellow"></div>
                        <div class="dot green"></div>
                        <span class="filename">advanced_detector.py</span>
                    </div>
                    <pre class="code-content"><span class="keyword">from</span> scapy.all <span class="keyword">import</span> sniff, ARP
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime
<span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict
<span class="keyword">import</span> time

<span class="keyword">class</span> <span class="function">AdvancedARPDetector</span>:
    <span class="keyword">def</span> <span class="function">__init__</span>(self, gateway_ip=<span class="string">"192.168.1.1"</span>):
        self.arp_table = {}
        self.mac_to_ips = defaultdict(set)  <span class="comment"># MAC -> IPs</span>
        self.arp_request_count = defaultdict(int)  <span class="comment"># ×¡×¤×™×¨×ª ×‘×§×©×•×ª</span>
        self.last_seen = {}  <span class="comment"># ×–××Ÿ ××—×¨×•×Ÿ ×©× ×¦×¤×”</span>
        self.gateway_ip = gateway_ip
        self.alerts = []
        self.start_time = time.time()

    <span class="keyword">def</span> <span class="function">analyze_packet</span>(self, packet):
        <span class="keyword">if</span> <span class="keyword">not</span> packet.haslayer(ARP):
            <span class="keyword">return</span>

        ip_src = packet[ARP].psrc
        mac_src = packet[ARP].hwsrc
        timestamp = datetime.now()

        <span class="comment"># ×‘×“×™×§×” 1: ×©×™× ×•×™ MAC ×œ××•×ª×” IP</span>
        <span class="keyword">if</span> ip_src <span class="keyword">in</span> self.arp_table:
            <span class="keyword">if</span> self.arp_table[ip_src] != mac_src:
                self.<span class="function">create_alert</span>(
                    <span class="string">"MAC_CHANGE"</span>,
                    <span class="string">f"IP {ip_src} ×©×™× ×” MAC"</span>,
                    {<span class="string">"old_mac"</span>: self.arp_table[ip_src], <span class="string">"new_mac"</span>: mac_src}
                )

        <span class="comment"># ×‘×“×™×§×” 2: MAC ××—×“ ×¢×‘×•×¨ ××¡×¤×¨ IPs (×—×©×•×“ ×××•×“!)</span>
        self.mac_to_ips[mac_src].add(ip_src)
        <span class="keyword">if</span> len(self.mac_to_ips[mac_src]) > 1:
            self.<span class="function">create_alert</span>(
                <span class="string">"MULTI_IP"</span>,
                <span class="string">f"MAC {mac_src} ××©×•×™×š ×œ-{len(self.mac_to_ips[mac_src])} IPs!"</span>,
                {<span class="string">"ips"</span>: list(self.mac_to_ips[mac_src])}
            )

        <span class="comment"># ×‘×“×™×§×” 3: ×”×ª×§×¤×” ×¢×œ Gateway</span>
        <span class="keyword">if</span> ip_src == self.gateway_ip:
            <span class="keyword">if</span> self.gateway_ip <span class="keyword">in</span> self.arp_table:
                <span class="keyword">if</span> self.arp_table[self.gateway_ip] != mac_src:
                    self.<span class="function">create_alert</span>(
                        <span class="string">"GATEWAY_ATTACK"</span>,
                        <span class="string">"ğŸ”´ ×”×ª×§×¤×” ×¢×œ Gateway!"</span>,
                        {<span class="string">"ip"</span>: ip_src, <span class="string">"mac"</span>: mac_src}
                    )

        <span class="comment"># ×‘×“×™×§×” 4: ×©×™×˜×¤×•×Ÿ ARP (×”×¨×‘×” ×‘×§×©×•×ª ×‘××”×™×¨×•×ª)</span>
        self.arp_request_count[mac_src] += 1
        <span class="keyword">if</span> self.arp_request_count[mac_src] > 10:  <span class="comment"># ×¡×£</span>
            self.<span class="function">create_alert</span>(
                <span class="string">"ARP_FLOOD"</span>,
                <span class="string">f"×©×™×˜×¤×•×Ÿ ARP ×-{mac_src}"</span>,
                {<span class="string">"count"</span>: self.arp_request_count[mac_src]}
            )

        <span class="comment"># ×¢×“×›×•×Ÿ ×˜×‘×œ××•×ª</span>
        self.arp_table[ip_src] = mac_src
        self.last_seen[ip_src] = timestamp

    <span class="keyword">def</span> <span class="function">create_alert</span>(self, alert_type, message, details):
        alert = {
            <span class="string">"type"</span>: alert_type,
            <span class="string">"message"</span>: message,
            <span class="string">"details"</span>: details,
            <span class="string">"timestamp"</span>: datetime.now(),
            <span class="string">"elapsed"</span>: time.time() - self.start_time
        }
        self.alerts.append(alert)
        self.<span class="function">display_alert</span>(alert)

    <span class="keyword">def</span> <span class="function">display_alert</span>(self, alert):
        <span class="keyword">print</span>(<span class="string">f"\n{'='*70}"</span>)
        <span class="keyword">print</span>(<span class="string">f"ğŸš¨ ×”×ª×¨××”: {alert['type']}"</span>)
        <span class="keyword">print</span>(<span class="string">f"ğŸ“ {alert['message']}"</span>)
        <span class="keyword">print</span>(<span class="string">f"â±ï¸  ×–××Ÿ ××”×ª×—×œ×”: {alert['elapsed']:.1f} ×©× ×™×•×ª"</span>)
        <span class="keyword">print</span>(<span class="string">f"ğŸ“Š ×¤×¨×˜×™×: {alert['details']}"</span>)
        <span class="keyword">print</span>(<span class="string">"="</span> * 70)

    <span class="keyword">def</span> <span class="function">get_statistics</span>(self):
        <span class="keyword">return</span> {
            <span class="string">"total_devices"</span>: len(self.arp_table),
            <span class="string">"total_alerts"</span>: len(self.alerts),
            <span class="string">"runtime"</span>: time.time() - self.start_time,
            <span class="string">"suspicious_macs"</span>: len([m <span class="keyword">for</span> m <span class="keyword">in</span> self.mac_to_ips <span class="keyword">if</span> len(self.mac_to_ips[m]) > 1])
        }

<span class="comment"># ×©×™××•×©</span>
detector = AdvancedARPDetector(gateway_ip=<span class="string">"192.168.1.1"</span>)
<span class="keyword">print</span>(<span class="string">"ğŸ” ××¢×¨×›×ª ×–×™×”×•×™ ××ª×§×“××ª ×”×•×¤×¢×œ×”..."</span>)
sniff(filter=<span class="string">"arp"</span>, prn=detector.analyze_packet, store=0)</pre>
                </div>

                <div class="task-card">
                    <span class="task-number">××©×™××” 3.1</span>
                    <h4>× ×™×ª×•×— ×”×§×•×“ ×”××ª×§×“×</h4>
                    <p>×”×©×œ× ××ª ×”××©×™××•×ª ×”×‘××•×ª:</p>

                    <ol style="margin-right: 20px; line-height: 2;">
                        <li>×”×¡×‘×¨ ××” ×”×”×‘×“×œ ×‘×™×Ÿ ×”×’×œ××™ ×”×‘×¡×™×¡×™ ×œ××ª×§×“×</li>
                        <li>××” ×”××©××¢×•×ª ×©×œ ×‘×“×™×§×” 2 (MULTI_IP)?</li>
                        <li>×œ××” ×‘×“×™×§×ª Gateway ×—×©×•×‘×” ×‘××™×•×—×“?</li>
                        <li>××” ×”××©××¢×•×ª ×©×œ ARP Flood?</li>
                    </ol>

                    <textarea id="q3_1" style="min-height: 200px;" placeholder="×›×ª×•×‘ ××ª ×”×ª×©×•×‘×•×ª ×©×œ×š ×›××Ÿ..."></textarea>

                    <button class="btn btn-primary" onclick="checkAdvancedAnalysis()">×‘×“×•×§ ×ª×©×•×‘×•×ª</button>
                    <div class="feedback" id="feedback_advanced"></div>
                </div>

                <div class="task-card">
                    <span class="task-number">××©×™××” 3.2</span>
                    <h4>×”×•×¡×¤×ª ×‘×“×™×§×•×ª × ×•×¡×¤×•×ª</h4>
                    <p>×”×•×¡×£ ×œ×§×•×“ ×”××ª×§×“× ×‘×“×™×§×” × ×•×¡×¤×ª ×©××–×”×”:</p>
                    <ul style="margin-right: 20px; line-height: 2;">
                        <li><strong>Gratuitous ARP:</strong> ×—×‘×™×œ×•×ª ARP ×©×œ× ×”×ª×‘×§×©×•</li>
                        <li><strong>Time-based detection:</strong> ×–×™×”×•×™ ×“×¤×•×¡ ×©×œ ×©×œ×™×—×” ×‘×–×× ×™× ×§×‘×•×¢×™×</li>
                    </ul>

                    <textarea id="extra_detection" style="min-height: 200px;" placeholder="×›×ª×•×‘ ×›××Ÿ ××ª ×”×§×•×“ ×”×—×“×©..."></textarea>

                    <button class="btn btn-success" onclick="saveExtraDetection()">×©××•×¨ ×§×•×“</button>
                    <div class="feedback" id="feedback_extra"></div>
                </div>
            </div>

            <!-- Section 4: Gemini Integration -->
            <div class="gemini-section">
                <h3>ğŸ¤– ×©×œ×‘ 4: ×©×™×œ×•×‘ Gemini AI ×œ× ×™×ª×•×— ××ª×§×“×</h3>

                <div class="theory-box" style="background: rgba(255,255,255,0.15); border-color: white;">
                    <h4 style="color: white;">×œ××” AI ×‘×›×œ×™ ××‘×˜×—×”?</h4>
                    <p style="color: rgba(255,255,255,0.95);">
                        ××•×“×œ×™ AI ×›××• Gemini ×™×›×•×œ×™× ×œ× ×ª×— ×“×¤×•×¡×™× ××•×¨×›×‘×™×, ×œ×”××œ×™×¥ ×¢×œ ×¦×¢×“×™ ×”×’× ×” ××•×ª×××™× ××™×©×™×ª,
                        ×•×œ×¢×–×•×¨ ×œ×”×‘×™×Ÿ ××ª ×”×§×•× ×˜×§×¡×˜ ×”××œ× ×©×œ ×”××ª×§×¤×”.
                    </p>
                </div>

                <h4 style="color: white; margin: 20px 0;">×”×ª×§× ×ª Gemini SDK</h4>
                <div class="terminal">
<span class="prompt">$</span> pip install google-generativeai
<span class="output">Successfully installed google-generativeai</span>
                </div>

                <h4 style="color: white; margin: 20px 0;">×§×•×“: ×©×™×œ×•×‘ Gemini ×œ× ×™×ª×•×— ×”×ª×¨××•×ª</h4>

                <div class="code-editor">
                    <div class="code-header">
                        <div class="dot red"></div>
                        <div class="dot yellow"></div>
                        <div class="dot green"></div>
                        <span class="filename">gemini_analyzer.py</span>
                    </div>
                    <pre class="code-content"><span class="keyword">import</span> google.generativeai <span class="keyword">as</span> genai
<span class="keyword">import</span> json

<span class="keyword">class</span> <span class="function">GeminiSecurityAnalyzer</span>:
    <span class="keyword">def</span> <span class="function">__init__</span>(self, api_key):
        genai.configure(api_key=api_key)
        self.model = genai.GenerativeModel(<span class="string">'gemini-pro'</span>)

    <span class="keyword">def</span> <span class="function">analyze_attack</span>(self, alerts, arp_table):
        <span class="string">"""
        × ×™×ª×•×— ××ª×§×¤×” ×¢× AI
        """</span>
        <span class="comment"># ×”×›× ×ª ×”× ×ª×•× ×™×</span>
        attack_data = {
            <span class="string">"total_alerts"</span>: len(alerts),
            <span class="string">"alert_types"</span>: [a[<span class="string">"type"</span>] <span class="keyword">for</span> a <span class="keyword">in</span> alerts],
            <span class="string">"devices_count"</span>: len(arp_table),
            <span class="string">"alerts_details"</span>: alerts[:5]  <span class="comment"># 5 ×¨××©×•× ×•×ª</span>
        }

        <span class="comment"># ×‘× ×™×™×ª ×”×¤×¨×•××¤×˜</span>
        prompt = <span class="string">f"""
××ª×” ××•××—×” ××‘×˜×—×ª ×¡×™×™×‘×¨. × ×ª×’×œ×ª×” ×¤×¢×™×œ×•×ª ×—×©×•×“×” ×‘×¨×©×ª:

× ×ª×•× ×™×:
{json.dumps(attack_data, indent=2, ensure_ascii=False)}

×‘×¦×¢ × ×™×ª×•×— ××¢××™×§ ×•×¡×¤×§:
1. ×–×™×”×•×™ ×¡×•×’ ×”××ª×§×¤×” ×”××“×•×™×§
2. ×¨××ª ×”×—×•××¨×” (× ××•×›×”/×‘×™× ×•× ×™×ª/×’×‘×•×”×”)
3. ×”×©×œ×›×•×ª ××¤×©×¨×™×•×ª
4. ×¦×¢×“×™ ×”×’× ×” ××•××œ×¦×™× (×œ×¤×—×•×ª 5)
5. ×”×× ×–×• ×”×ª×§×¤×” ××•×˜×•××˜×™×ª ××• ×™×“× ×™×ª?

×”×©×‘ ×‘×¤×•×¨××˜ JSON ×¢× ×”××‘× ×”:
{{
  "attack_type": "...",
  "severity": "...",
  "impact": ["..."],
  "recommendations": ["..."],
  "attack_nature": "..."
}}
"""</span>

        <span class="keyword">try</span>:
            response = self.model.generate_content(prompt)
            <span class="keyword">return</span> self.<span class="function">parse_ai_response</span>(response.text)
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            <span class="keyword">return</span> {<span class="string">"error"</span>: str(e)}

    <span class="keyword">def</span> <span class="function">parse_ai_response</span>(self, text):
        <span class="string">"""
        × ×™×ª×•×— ×ª×©×•×‘×ª ×”-AI
        """</span>
        <span class="keyword">try</span>:
            <span class="comment"># × ×™×¡×™×•×Ÿ ×œ×—×œ×¥ JSON</span>
            start = text.find(<span class="string">"{"</span>)
            end = text.rfind(<span class="string">"}"</span>) + 1
            <span class="keyword">if</span> start != -1 <span class="keyword">and</span> end > start:
                json_str = text[start:end]
                <span class="keyword">return</span> json.loads(json_str)
            <span class="keyword">return</span> {<span class="string">"raw_response"</span>: text}
        <span class="keyword">except</span>:
            <span class="keyword">return</span> {<span class="string">"raw_response"</span>: text}

    <span class="keyword">def</span> <span class="function">suggest_prevention</span>(self, network_details):
        <span class="string">"""
        ×”××œ×¦×•×ª ×œ×× ×™×¢×” ×¢×ª×™×“×™×ª
        """</span>
        prompt = <span class="string">f"""
×¨×©×ª ×¢× ×”×××¤×™×™× ×™× ×”×‘××™×:
{json.dumps(network_details, indent=2, ensure_ascii=False)}

×”××œ×¥ ×¢×œ ××¡×˜×¨×˜×’×™×™×ª ×”×’× ×” ××§×™×¤×” ××¤× ×™ ARP Poisoning.
×›×œ×•×œ:
1. ×”×’×“×¨×•×ª ×¨×©×ª (Switch, VLAN ×•×›×•')
2. ×›×œ×™ ××‘×˜×—×” ××•××œ×¦×™×
3. ××“×™× ×™×•×ª ××¨×’×•× ×™×ª
4. ×”×“×¨×›×ª ××©×ª××©×™×
5. × ×™×˜×•×¨ ×©×•×˜×£

×”×©×‘ ×‘×¢×‘×¨×™×ª ×•×‘×¦×•×¨×” ××¤×•×¨×˜×ª.
"""</span>

        <span class="keyword">try</span>:
            response = self.model.generate_content(prompt)
            <span class="keyword">return</span> response.text
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            <span class="keyword">return</span> <span class="string">f"×©×’×™××”: {e}"</span>

<span class="comment"># ×“×•×’××ª ×©×™××•×©</span>
<span class="keyword">def</span> <span class="function">main</span>():
    API_KEY = <span class="string">"YOUR_GEMINI_API_KEY"</span>  <span class="comment"># ×”×—×œ×£ ×‘××¤×ª×— ×©×œ×š!</span>

    analyzer = GeminiSecurityAnalyzer(API_KEY)

    <span class="comment"># ×“×•×’××ª ×”×ª×¨××•×ª</span>
    sample_alerts = [
        {<span class="string">"type"</span>: <span class="string">"MAC_CHANGE"</span>, <span class="string">"message"</span>: <span class="string">"IP ×©×™× ×” MAC"</span>},
        {<span class="string">"type"</span>: <span class="string">"GATEWAY_ATTACK"</span>, <span class="string">"message"</span>: <span class="string">"×”×ª×§×¤×” ×¢×œ Gateway"</span>}
    ]

    sample_table = {
        <span class="string">"192.168.1.1"</span>: <span class="string">"aa:bb:cc:dd:ee:01"</span>,
        <span class="string">"192.168.1.10"</span>: <span class="string">"aa:bb:cc:dd:ee:01"</span>
    }

    <span class="keyword">print</span>(<span class="string">"ğŸ¤– ×× ×ª×— ×¢× Gemini AI..."</span>)
    result = analyzer.analyze_attack(sample_alerts, sample_table)
    <span class="keyword">print</span>(json.dumps(result, indent=2, ensure_ascii=<span class="keyword">False</span>))

<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    main()</pre>
                </div>

                <div class="task-card" style="background: rgba(255,255,255,0.95);">
                    <span class="task-number">××©×™××” 4.1 - ×”×›×¨×—×™×ª</span>
                    <h4>×©×™×œ×•×‘ Gemini ×‘××¢×¨×›×ª ×©×œ×š</h4>

                    <ol style="margin-right: 20px; line-height: 2;">
                        <li>×§×‘×œ API Key ×-<a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
                        <li>×”×›× ×¡ ××ª ×”-API Key ×›××Ÿ (×œ× ×™×©××¨!):</li>
                    </ol>

                    <input type="password" id="gemini_api_key" placeholder="×”×“×‘×§ ××ª ×”-API Key ×›××Ÿ..." style="width: 100%; margin: 10px 0;">

                    <p style="margin: 15px 0;"><strong>3. ×‘×—×¨ ×ª×¨×—×™×© ×œ× ×™×ª×•×—:</strong></p>

                    <select id="scenario_select" style="width: 100%; padding: 10px; margin: 10px 0;">
                        <option value="">×‘×—×¨ ×ª×¨×—×™×©...</option>
                        <option value="scenario1">×ª×¨×—×™×© 1: ××ª×§×¤×” ×¤×©×•×˜×” - ×©×™× ×•×™ MAC ×‘×•×“×“</option>
                        <option value="scenario2">×ª×¨×—×™×© 2: ××ª×§×¤×” ×××•×§×“×ª - ×”×ª×§×¤×” ×¢×œ Gateway</option>
                        <option value="scenario3">×ª×¨×—×™×© 3: ×©×™×˜×¤×•×Ÿ ARP - ××ª×§×¤×” ×××¡×™×‘×™×ª</option>
                        <option value="scenario4">×ª×¨×—×™×© 4: ××ª×§×¤×” ××ª×•×—×›××ª - Multi-IP</option>
                    </select>

                    <button class="btn btn-primary" onclick="analyzeWithGemini()" style="width: 100%; margin: 10px 0;">
                        ğŸ¤– × ×ª×— ×¢× Gemini AI
                    </button>

                    <div class="api-result" id="gemini_result" style="display: none; color: #333;">
                        <h4>×ª×•×¦××•×ª × ×™×ª×•×— AI:</h4>
                        <div id="analysis_content"></div>
                    </div>
                </div>

                <div class="task-card" style="background: rgba(255,255,255,0.95);">
                    <span class="task-number">××©×™××” 4.2</span>
                    <h4>×¤×™×ª×•×— ×ª×›×•× ×”: ×“×•"×— ××•×˜×•××˜×™</h4>
                    <p>×›×ª×•×‘ ×¤×•× ×§×¦×™×” ×©××™×™×¦×¨×ª ×“×•"×— ××œ× ×¢×œ ×”××ª×§×¤×” ×‘×××¦×¢×•×ª Gemini:</p>

                    <ul style="margin-right: 20px; line-height: 2;">
                        <li>×¡×™×›×•× ×›×œ ×”×”×ª×¨××•×ª</li>
                        <li>×¦×™×¨ ×–××Ÿ (Timeline) ×©×œ ×”××ª×§×¤×”</li>
                        <li>×¨×©×™××ª ××›×©×™×¨×™× ××•×©×¤×¢×™×</li>
                        <li>×¦×¢×“×™ ×ª×™×§×•×Ÿ ××™×™×“×™×™×</li>
                        <li>×”××œ×¦×•×ª ×œ×˜×•×•×— ××¨×•×š</li>
                    </ul>

                    <textarea id="report_code" style="min-height: 250px;" placeholder="×›×ª×•×‘ ××ª ×”×§×•×“ ×©×œ×š ×›××Ÿ..."></textarea>

                    <button class="btn btn-success" onclick="saveReportCode()">×©××•×¨ ×§×•×“</button>
                    <button class="btn btn-primary" onclick="generateReport()">×¦×•×¨ ×“×•"×— ×“×•×’××”</button>
                    <div class="feedback" id="feedback_report"></div>
                </div>
            </div>

            <!-- Section 5: Defense System -->
            <div class="section">
                <h3>ğŸ›¡ï¸ ×©×œ×‘ 5: ×‘× ×™×™×ª ××¢×¨×›×ª ×”×’× ×” ××§×˜×™×‘×™×ª</h3>

                <div class="theory-box">
                    <h4>××–×™×”×•×™ ×œ×”×’× ×” ××§×˜×™×‘×™×ª</h4>
                    <p>×œ× ××¡×¤×™×§ ×œ×–×”×•×ª ××ª×§×¤×” - ×¦×¨×™×š ×’× ×œ×”×’×Ÿ! × ×‘× ×” ××¢×¨×›×ª ×©×ª×’×™×‘ ××•×˜×•××˜×™×ª:</p>
                    <ul>
                        <li><strong>Gratuitous ARP:</strong> ×©×œ×™×—×ª ×”×•×“×¢×•×ª ARP "××ª×§× ×•×ª" ×œ×¨×©×ª</li>
                        <li><strong>×”×ª×¨××•×ª:</strong> ×©×œ×™×—×ª ×”×ª×¨××•×ª ×œ×× ×”×œ ×”××‘×˜×—×”</li>
                        <li><strong>×—×¡×™××”:</strong> ×—×¡×™××ª ×›×ª×•×‘×ª MAC ×—×©×•×“×” (×‘××ª×’×™× ×ª×•××›×™×)</li>
                        <li><strong>×ª×™×¢×•×“:</strong> ×©××™×¨×ª ×›×œ ×”×¤×¢×™×œ×•×ª ×œ×—×§×™×¨×” ×¢×ª×™×“×™×ª</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <strong>âš ï¸ ××–×”×¨×” ×—×©×•×‘×”:</strong><br>
                    ×©×œ×™×—×ª ×—×‘×™×œ×•×ª ARP ×œ×¨×©×ª ×™×›×•×œ×” ×œ×”×©×¤×™×¢ ×¢×œ ×¤×¢×™×œ×•×ª ×”×¨×©×ª. ×”×©×ª××© ×‘×–×”×™×¨×•×ª ×•×¨×§ ×‘×¨×©×ª×•×ª ××‘×•×“×“×•×ª/× ×™×¡×™×•× ×™×•×ª!
                </div>

                <h4 style="margin: 20px 0;">×§×•×“: ××¢×¨×›×ª ×”×’× ×” ××œ××”</h4>

                <div class="code-editor">
                    <div class="code-header">
                        <div class="dot red"></div>
                        <div class="dot yellow"></div>
                        <div class="dot green"></div>
                        <span class="filename">defense_system.py</span>
                    </div>
                    <pre class="code-content"><span class="keyword">from</span> scapy.all <span class="keyword">import</span> ARP, Ether, send, sniff
<span class="keyword">import</span> logging
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime

<span class="keyword">class</span> <span class="function">ARPDefenseSystem</span>:
    <span class="keyword">def</span> <span class="function">__init__</span>(self, gateway_ip, gateway_mac, interface=<span class="string">"eth0"</span>):
        self.gateway_ip = gateway_ip
        self.gateway_mac = gateway_mac
        self.interface = interface
        self.arp_table = {}

        <span class="comment"># ×”×’×“×¨×ª logging</span>
        logging.basicConfig(
            filename=<span class="string">'defense.log'</span>,
            level=logging.INFO,
            format=<span class="string">'%(asctime)s - %(levelname)s - %(message)s'</span>
        )
        self.logger = logging.getLogger(__name__)

    <span class="keyword">def</span> <span class="function">send_gratuitous_arp</span>(self, target_ip, correct_mac):
        <span class="string">"""
        ×©×œ×™×—×ª Gratuitous ARP ×œ×ª×™×§×•×Ÿ ×˜×‘×œ××•×ª
        """</span>
        <span class="keyword">try</span>:
            <span class="comment"># ×™×¦×™×¨×ª ×—×‘×™×œ×ª ARP ××ª×§× ×ª</span>
            arp_response = ARP(
                op=2,  <span class="comment"># ARP Reply</span>
                psrc=target_ip,
                hwsrc=correct_mac,
                pdst=<span class="string">"255.255.255.255"</span>  <span class="comment"># Broadcast</span>
            )

            <span class="comment"># ×©×œ×™×—×” ×œ×¨×©×ª</span>
            send(arp_response, iface=self.interface, count=3, verbose=<span class="keyword">False</span>)

            self.logger.info(
                <span class="string">f"âœ… × ×©×œ×— Gratuitous ARP: {target_ip} -> {correct_mac}"</span>
            )
            <span class="keyword">return</span> <span class="keyword">True</span>
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            self.logger.error(<span class="string">f"âŒ ×©×’×™××” ×‘×©×œ×™×—×ª ARP: {e}"</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>

    <span class="keyword">def</span> <span class="function">restore_gateway</span>(self):
        <span class="string">"""
        ×©×—×–×•×¨ × ×ª×‘ ×œ××—×¨ ××ª×§×¤×”
        """</span>
        <span class="keyword">print</span>(<span class="string">"ğŸ”§ ××©×—×–×¨ ××ª ×”× ×ª×‘ ×œ×›×œ ×”××›×©×™×¨×™×..."</span>)

        <span class="keyword">for</span> ip <span class="keyword">in</span> self.arp_table.keys():
            <span class="keyword">if</span> ip != self.gateway_ip:
                self.<span class="function">send_gratuitous_arp</span>(self.gateway_ip, self.gateway_mac)

        <span class="keyword">print</span>(<span class="string">"âœ… ×©×—×–×•×¨ ×”×•×©×œ×"</span>)

    <span class="keyword">def</span> <span class="function">detect_and_defend</span>(self, packet):
        <span class="string">"""
        ×–×™×”×•×™ ×•×”×’× ×” ×‘×–××Ÿ ×××ª
        """</span>
        <span class="keyword">if</span> <span class="keyword">not</span> packet.haslayer(ARP):
            <span class="keyword">return</span>

        ip_src = packet[ARP].psrc
        mac_src = packet[ARP].hwsrc

        <span class="comment"># ×‘×“×™×§×ª ×©×™× ×•×™</span>
        <span class="keyword">if</span> ip_src <span class="keyword">in</span> self.arp_table:
            <span class="keyword">if</span> self.arp_table[ip_src] != mac_src:
                <span class="comment"># ğŸš¨ ×–×•×”×ª×” ××ª×§×¤×”!</span>
                self.logger.warning(
                    <span class="string">f"ğŸš¨ ××ª×§×¤×” ×–×•×”×ª×”: {ip_src} ×©×™× ×” MAC"</span>
                )

                <span class="comment"># ×ª×’×•×‘×” ××•×˜×•××˜×™×ª</span>
                <span class="keyword">if</span> ip_src == self.gateway_ip:
                    <span class="keyword">print</span>(<span class="string">"ğŸ”´ ×”×ª×§×¤×” ×¢×œ Gateway! ××¤×¢×™×œ ×”×’× ×”..."</span>)
                    self.<span class="function">restore_gateway</span>()

                <span class="keyword">print</span>(<span class="string">f"âš ï¸  ×”×ª×¨××”: {ip_src} ×—×©×•×“ ×‘××ª×§×¤×”"</span>)

        <span class="comment"># ×¢×“×›×•×Ÿ ×˜×‘×œ×”</span>
        self.arp_table[ip_src] = mac_src

    <span class="keyword">def</span> <span class="function">start_protection</span>(self):
        <span class="string">"""
        ×”×¤×¢×œ×ª ××¢×¨×›×ª ×”×”×’× ×”
        """</span>
        <span class="keyword">print</span>(<span class="string">"="</span> * 70)
        <span class="keyword">print</span>(<span class="string">"ğŸ›¡ï¸  ××¢×¨×›×ª ×”×’× ×ª ARP ×”×•×¤×¢×œ×”"</span>)
        <span class="keyword">print</span>(<span class="string">f"ğŸ“¡ ×××©×§: {self.interface}"</span>)
        <span class="keyword">print</span>(<span class="string">f"ğŸŒ Gateway: {self.gateway_ip} ({self.gateway_mac})"</span>)
        <span class="keyword">print</span>(<span class="string">"="</span> * 70 + <span class="string">"\n"</span>)

        <span class="keyword">try</span>:
            sniff(
                filter=<span class="string">"arp"</span>,
                prn=self.detect_and_defend,
                iface=self.interface,
                store=0
            )
        <span class="keyword">except</span> KeyboardInterrupt:
            <span class="keyword">print</span>(<span class="string">"\nğŸ›‘ ××¢×¨×›×ª ×”×”×’× ×” ×”×•×¤×¡×§×”"</span>)
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            <span class="keyword">print</span>(<span class="string">f"âŒ ×©×’×™××”: {e}"</span>)

<span class="comment"># ×©×™××•×© ×‘××¢×¨×›×ª</span>
<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    <span class="comment"># ×”×’×“×¨×•×ª - ×”×ª×× ×œ×¨×©×ª ×©×œ×š!</span>
    GATEWAY_IP = <span class="string">"192.168.1.1"</span>
    GATEWAY_MAC = <span class="string">"aa:bb:cc:dd:ee:ff"</span>  <span class="comment"># ××¦× ×¢×: arp -a</span>
    INTERFACE = <span class="string">"eth0"</span>  <span class="comment"># ××• "wlan0" ×œ××œ×—×•×˜×™</span>

    defense = ARPDefenseSystem(GATEWAY_IP, GATEWAY_MAC, INTERFACE)
    defense.start_protection()</pre>
                </div>

                <div class="task-card">
                    <span class="task-number">××©×™××” 5.1</span>
                    <h4>×‘×“×™×§×ª ××¢×¨×›×ª ×”×”×’× ×”</h4>

                    <p><strong>×”×•×¨××•×ª:</strong></p>
                    <ol style="margin-right: 20px; line-height: 2;">
                        <li>×”×ª×§×Ÿ ×¡×‘×™×‘×” ×•×™×¨×˜×•××œ×™×ª ××‘×•×“×“×ª (VirtualBox + 2-3 VMs)</li>
                        <li>×”×¤×¢×œ ××ª ××¢×¨×›×ª ×”×”×’× ×” ×‘××›×©×™×¨ ××—×“</li>
                        <li>×¡××œ×¥ ××ª×§×¤×” ×××›×©×™×¨ ××—×¨ (××•×¤×¦×™×•× ×œ×™ - ×¨×§ ×œ× ×™×¡×•×™ ××‘×•×§×¨!)</li>
                        <li>×¦×•×¨ screenshots ×©×œ ×”×ª×¨××•×ª ×•×ª×•×¦××•×ª</li>
                    </ol>

                    <p style="margin: 15px 0;"><strong>×ª×™×¢×•×“ ×”×‘×“×™×§×”:</strong></p>
                    <textarea id="test_results" style="min-height: 200px;" placeholder="×ª××¨ ××ª ××” ×©×§×¨×” ×‘×‘×“×™×§×”, ×”×“×‘×§ logs, screenshots..."></textarea>

                    <button class="btn btn-success" onclick="saveTestResults()">×©××•×¨ ×ª×•×¦××•×ª</button>
                    <div class="feedback" id="feedback_test"></div>
                </div>

                <div class="task-card">
                    <span class="task-number">××©×™××” 5.2 - ×¤×¨×•×™×§×˜ ×¡×™×•×</span>
                    <h4>×‘× ×™×™×ª ××¢×¨×›×ª ××œ××” ×¢× ×××©×§ ×’×¨×¤×™</h4>

                    <p>×‘× ×” ××¢×¨×›×ª ××œ××” ×©×›×•×œ×œ×ª:</p>
                    <ul style="margin-right: 20px; line-height: 2;">
                        <li>âœ… ×××©×§ ×’×¨×¤×™ (GUI) ×¢× tkinter ××• PyQt</li>
                        <li>âœ… ×ª×¦×•×’×” ×‘×–××Ÿ ×××ª ×©×œ ××›×©×™×¨×™× ×‘×¨×©×ª</li>
                        <li>âœ… ×”×ª×¨××•×ª ×—×–×•×ª×™×•×ª ×•××©××™×¢×ª ×¦×œ×™×œ</li>
                        <li>âœ… ×’×¨×¤×™× ×•×¡×˜×˜×™×¡×˜×™×§×•×ª</li>
                        <li>âœ… ×©××™×¨×ª ×“×•"×—×•×ª PDF</li>
                        <li>âœ… ××™× ×˜×’×¨×¦×™×” ×¢× Gemini ×œ× ×™×ª×•×—</li>
                        <li>âœ… ×”×’× ×” ××•×˜×•××˜×™×ª ××ª×•×–×× ×ª</li>
                    </ul>

                    <div style="background: #e8f5e9; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4 style="color: #2e7d32;">ğŸ’¡ ×¨×¢×™×•× ×•×ª ×œ×”×¨×—×‘×”:</h4>
                        <ul style="margin-right: 20px;">
                            <li>×©×™×œ×•×‘ ×¢× Telegram Bot ×œ×”×ª×¨××•×ª ×œ××•×‘×™×™×œ</li>
                            <li>×©××™×¨×ª × ×ª×•× ×™× ×‘-SQLite ×œ× ×™×ª×•×— ×”×™×¡×˜×•×¨×™</li>
                            <li>×“×©×‘×•×¨×“ Web ×¢× Flask</li>
                            <li>×œ××™×“×ª ××›×•× ×” ×œ×–×™×”×•×™ ×“×¤×•×¡×™× ×—×¨×™×’×™×</li>
                            <li>×™×¦×•× × ×ª×•× ×™× ×œ-Wireshark</li>
                        </ul>
                    </div>

                    <button class="btn btn-warning" onclick="downloadProjectTemplate()">ğŸ“¥ ×”×•×¨×“ ×ª×‘× ×™×ª ×¤×¨×•×™×§×˜</button>
                    <button class="btn btn-primary" onclick="showProjectGuidelines()">ğŸ“˜ ×”×¦×’ ×”× ×—×™×•×ª ××¤×•×¨×˜×•×ª</button>
                </div>
            </div>

            <!-- Final Section: Summary -->
            <div class="section" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white;">
                <h3 style="color: white;">ğŸ¯ ×¡×™×›×•× ×”××©×™××”</h3>

                <div class="progress-tracker" style="background: rgba(255,255,255,0.15);">
                    <div class="progress-item completed" style="background: rgba(255,255,255,0.2); border-color: white;">
                        <span class="icon">âœ…</span>
                        <div>
                            <strong style="color: white;">×©×œ×‘ 1:</strong>
                            <span style="color: rgba(255,255,255,0.9);"> ×”×‘× ×ª ×ª×™××•×¨×™×™×ª ARP Poisoning</span>
                        </div>
                    </div>
                    <div class="progress-item" style="background: rgba(255,255,255,0.2); border-color: white;">
                        <span class="icon">â³</span>
                        <div>
                            <strong style="color: white;">×©×œ×‘ 2:</strong>
                            <span style="color: rgba(255,255,255,0.9);"> ×‘× ×™×™×ª ×’×œ××™ ×‘×¡×™×¡×™ ×¢× Scapy</span>
                        </div>
                    </div>
                    <div class="progress-item" style="background: rgba(255,255,255,0.2); border-color: white;">
                        <span class="icon">â³</span>
                        <div>
                            <strong style="color: white;">×©×œ×‘ 3:</strong>
                            <span style="color: rgba(255,255,255,0.9);"> ×–×™×”×•×™ ××ª×§×“× ×•× ×™×ª×•×— ×“×¤×•×¡×™×</span>
                        </div>
                    </div>
                    <div class="progress-item" style="background: rgba(255,255,255,0.2); border-color: white;">
                        <span class="icon">â³</span>
                        <div>
                            <strong style="color: white;">×©×œ×‘ 4:</strong>
                            <span style="color: rgba(255,255,255,0.9);"> ×©×™×œ×•×‘ Gemini AI</span>
                        </div>
                    </div>
                    <div class="progress-item" style="background: rgba(255,255,255,0.2); border-color: white;">
                        <span class="icon">â³</span>
                        <div>
                            <strong style="color: white;">×©×œ×‘ 5:</strong>
                            <span style="color: rgba(255,255,255,0.9);"> ××¢×¨×›×ª ×”×’× ×” ××œ××”</span>
                        </div>
                    </div>
                </div>

                <div style="background: rgba(255,255,255,0.15); padding: 25px; border-radius: 15px; margin: 25px 0;">
                    <h4 style="color: white; margin-bottom: 15px;">ğŸ“ ××” ×œ××“×ª×?</h4>
                    <ul style="color: rgba(255,255,255,0.95); line-height: 2;">
                        <li>×”×‘× ×” ××¢××™×§×” ×©×œ ×¤×¨×•×˜×•×§×•×œ ARP ×•×—×•×œ×©×•×ª ×”××‘×˜×—×” ×©×œ×•</li>
                        <li>×›×ª×™×‘×ª ×§×•×“ Python ××ª×§×“× ×¢× ×¡×¤×¨×™×™×ª Scapy</li>
                        <li>× ×™×ª×•×— ×—×‘×™×œ×•×ª ×¨×©×ª ×‘×–××Ÿ ×××ª</li>
                        <li>×©×™×œ×•×‘ AI (Gemini) ×‘×›×œ×™ ××‘×˜×—×”</li>
                        <li>×‘× ×™×™×ª ××¢×¨×›×ª ×”×’× ×” ××§×˜×™×‘×™×ª</li>
                        <li>×ª×”×œ×™×š ××œ× ×©×œ ×–×™×”×•×™, × ×™×ª×•×— ×•×”×’× ×” ××¤× ×™ ××™×•××™ ×¡×™×™×‘×¨</li>
                    </ul>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <h3 style="color: white; margin-bottom: 20px;">ğŸ“¥ ×—×•××¨×™ ×¢×–×¨ ×œ×”×•×¨×“×”</h3>
                    <a href="#" class="download-btn" onclick="downloadFullCode()">ğŸ’¾ ×”×•×¨×“ ××ª ×›×œ ×”×§×•×“</a>
                    <a href="#" class="download-btn" onclick="downloadPresentation()">ğŸ“Š ×”×•×¨×“ ××¦×’×ª ×¡×™×›×•×</a>
                    <a href="#" class="download-btn" onclick="downloadCertificate()">ğŸ† ×”×•×¨×“ ×ª×¢×•×“×ª ×¡×™×•×</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Helper functions
        function toggleHint(hintId) {
            const hint = document.getElementById(hintId);
            const hintBox = hint.parentElement;
            hintBox.classList.toggle('open');
        }

        function showFeedback(elementId, type, message) {
            const feedback = document.getElementById(elementId);
            feedback.className = `feedback ${type}`;
            feedback.textContent = message;
            feedback.style.display = 'block';
            feedback.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Task checks
        function checkUnderstanding() {
            const q1 = document.getElementById('q2_1').value;
            const q2 = document.getElementById('q2_2').value;
            const q3 = document.getElementById('q2_3').value;

            if (!q1 || !q2 || !q3) {
                showFeedback('feedback_understanding', 'error', 'âŒ ×× × ×¢× ×” ×¢×œ ×›×œ ×”×©××œ×•×ª');
                return;
            }

            let score = 0;
            let feedback = '';

            // Check Q1
            if (q1.toLowerCase().includes('×‘×“×™×§') || q1.toLowerCase().includes('arp')) {
                score++;
            }

            // Check Q2
            if (q2.toLowerCase().includes('××™×¤×•×™') || q2.toLowerCase().includes('ip') || q2.toLowerCase().includes('mac')) {
                score++;
            }

            // Check Q3
            if (q3.toLowerCase().includes('×©×•× ') || q3.toLowerCase().includes('×©×™× ×•×™') || q3.toLowerCase().includes('mac')) {
                score++;
            }

            if (score >= 2) {
                feedback = `âœ… ××¦×•×™×Ÿ! ×§×œ×˜×ª ××ª ×”×¢×™×§×¨. ×”×ª×©×•×‘×•×ª ×©×œ×š ××¨××•×ª ×”×‘× ×” ×˜×•×‘×” ×©×œ ×”×§×•×“.`;
                showFeedback('feedback_understanding', 'success', feedback);
            } else {
                feedback = `âš ï¸ × ×¨××” ×©×™×© ×§×¦×ª ×‘×œ×‘×•×œ. ×—×–×•×¨ ×¢×œ ×”×”×¡×‘×¨×™× ×•× ×¡×” ×©×•×‘.`;
                showFeedback('feedback_understanding', 'error', feedback);
            }
        }

        function saveImprovedCode() {
            const code = document.getElementById('improved_code').value;

            if (!code || code.trim().length < 50) {
                showFeedback('feedback_improved', 'error', 'âŒ ×”×§×•×“ ×§×¦×¨ ××“×™. ×”×•×¡×£ ××ª ×”×©×™×¤×•×¨×™× ×”××‘×•×§×©×™×');
                return;
            }

            // Check for improvements
            let hasLog = code.toLowerCase().includes('log') || code.toLowerCase().includes('file');
            let hasGateway = code.toLowerCase().includes('gateway');
            let hasTime = code.toLowerCase().includes('time') || code.toLowerCase().includes('datetime');

            if (hasLog && hasGateway) {
                showFeedback('feedback_improved', 'success', 'âœ… ××¢×•×œ×”! ×”×§×•×“ ×”××©×•×¤×¨ × ×©××¨. ×–×™×”×™× ×• ×©×™×¤×•×¨×™× ××©××¢×•×ª×™×™×');
            } else {
                showFeedback('feedback_improved', 'info', 'ğŸ’¡ ×”×§×•×“ × ×©××¨, ××š ××¤×©×¨ ×œ×”×•×¡×™×£ ×¢×•×“ ×ª×›×•× ×•×ª ××”×¨×©×™××”');
            }
        }

        function testImprovedCode() {
            showFeedback('feedback_improved', 'info', 'ğŸ” ×‘×•×“×§ ×ª×§×™× ×•×ª ×”×§×•×“... ×‘×¡×‘×™×‘×” ×××™×ª×™×ª ×ª×¨×™×¥ ××ª ×”×§×•×“ ×•×ª×‘×“×•×§ ×©×”×•× ×¢×•×‘×“');
        }

        function checkAdvancedAnalysis() {
            const answer = document.getElementById('q3_1').value;

            if (!answer || answer.length < 100) {
                showFeedback('feedback_advanced', 'error', 'âŒ ×× × ×›×ª×•×‘ ×ª×©×•×‘×” ××¤×•×¨×˜×ª ×™×•×ª×¨');
                return;
            }

            const keywords = ['multi', 'gateway', 'flood', '×–××Ÿ', 'mac', 'ip'];
            const hasKeywords = keywords.filter(kw => answer.toLowerCase().includes(kw)).length;

            if (hasKeywords >= 3) {
                showFeedback('feedback_advanced', 'success', 'âœ… ×ª×©×•×‘×” ××¦×•×™× ×ª! ×”×‘× ×ª ××ª ×”×”×‘×“×œ×™× ×”××¨×›×–×™×™×');
            } else {
                showFeedback('feedback_advanced', 'info', 'ğŸ’¡ ×ª×©×•×‘×” ×˜×•×‘×”, ××š × ×¡×” ×œ×”×•×¡×™×£ ×¤×¨×˜×™× ×¢×œ ×›×œ ×¡×•×’ ×‘×“×™×§×”');
            }
        }

        function saveExtraDetection() {
            const code = document.getElementById('extra_detection').value;

            if (code && code.length > 50) {
                showFeedback('feedback_extra', 'success', 'âœ… ×§×•×“ ×”×‘×“×™×§×” ×”× ×•×¡×£ × ×©××¨!');
            } else {
                showFeedback('feedback_extra', 'error', 'âŒ × ×“×¨×© ×§×•×“ ××¤×•×¨×˜ ×™×•×ª×¨');
            }
        }

        // Gemini Integration
        async function analyzeWithGemini() {
            const apiKey = document.getElementById('gemini_api_key').value;
            const scenario = document.getElementById('scenario_select').value;

            if (!apiKey) {
                alert('×× × ×”×›× ×¡ Gemini API Key');
                return;
            }

            if (!scenario) {
                alert('×× × ×‘×—×¨ ×ª×¨×—×™×© ×œ× ×™×ª×•×—');
                return;
            }

            // Show loading
            document.getElementById('gemini_result').style.display = 'block';
            document.getElementById('analysis_content').innerHTML = '<p>ğŸ”„ ×× ×ª×— ×¢× Gemini AI...</p>';

            // Prepare scenarios
            const scenarios = {
                scenario1: {
                    alerts: [{type: "MAC_CHANGE", message: "IP 192.168.1.10 ×©×™× ×” MAC"}],
                    description: "×©×™× ×•×™ MAC ×‘×•×“×“"
                },
                scenario2: {
                    alerts: [{type: "GATEWAY_ATTACK", message: "×”×ª×§×¤×” ×¢×œ Gateway"}],
                    description: "×”×ª×§×¤×” ×××•×§×“×ª ×¢×œ Gateway"
                },
                scenario3: {
                    alerts: Array(20).fill({type: "ARP_FLOOD", message: "×©×™×˜×¤×•×Ÿ ARP"}),
                    description: "××ª×§×¤×ª ×©×™×˜×¤×•×Ÿ ×××¡×™×‘×™×ª"
                },
                scenario4: {
                    alerts: [{type: "MULTI_IP", message: "MAC ××—×“ ×œ-5 IPs"}],
                    description: "××ª×§×¤×” ××ª×•×—×›××ª"
                }
            };

            const selectedScenario = scenarios[scenario];

            try {
                // Call Gemini API
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `××ª×” ××•××—×” ××‘×˜×—×ª ×¡×™×™×‘×¨. × ×ª×’×œ×ª×” ××ª×§×¤×ª ARP Poisoning:

×ª×¨×—×™×©: ${selectedScenario.description}
×”×ª×¨××•×ª: ${JSON.stringify(selectedScenario.alerts)}

×‘×¦×¢ × ×™×ª×•×— ×•×ª×Ÿ:
1. ×–×™×”×•×™ ×¡×•×’ ×”××ª×§×¤×”
2. ×¨××ª ×—×•××¨×” (× ××•×›×”/×‘×™× ×•× ×™×ª/×’×‘×•×”×”/×§×¨×™×˜×™×ª)
3. ×”×©×œ×›×•×ª ××¤×©×¨×™×•×ª (3-4 × ×§×•×“×•×ª)
4. ×”××œ×¦×•×ª ×œ×”×’× ×” (5-6 ×¦×¢×“×™× ×§×•× ×§×¨×˜×™×™×)

×”×©×‘ ×‘×¢×‘×¨×™×ª ×•×¦×•×¨×” ××¡×•×“×¨×ª.`
                            }]
                        }]
                    })
                });

                const data = await response.json();

                if (data.candidates && data.candidates[0]) {
                    const analysisText = data.candidates[0].content.parts[0].text;
                    document.getElementById('analysis_content').innerHTML = `
                        <div style="background: white; padding: 20px; border-radius: 10px; color: #333;">
                            <h4 style="color: #667eea; margin-bottom: 15px;">ğŸ“Š × ×™×ª×•×— Gemini AI</h4>
                            <pre style="white-space: pre-wrap; line-height: 1.8;">${analysisText}</pre>
                        </div>
                    `;
                } else {
                    throw new Error('No response from Gemini');
                }
            } catch (error) {
                document.getElementById('analysis_content').innerHTML = `
                    <p style="color: #f44336;">âŒ ×©×’×™××”: ${error.message}</p>
                    <p>×‘×“×•×§ ××ª ×”-API Key ×•××ª ×”×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜</p>
                `;
            }
        }

        function saveReportCode() {
            const code = document.getElementById('report_code').value;
            if (code && code.length > 100) {
                showFeedback('feedback_report', 'success', 'âœ… ×§×•×“ ×”×“×•"×— × ×©××¨ ×‘×”×¦×œ×—×”!');
            } else {
                showFeedback('feedback_report', 'error', 'âŒ × ×“×¨×© ×§×•×“ ××¤×•×¨×˜ ×™×•×ª×¨ ×œ×™×¦×™×¨×ª ×“×•"×—');
            }
        }

        function generateReport() {
            showFeedback('feedback_report', 'info', 'ğŸ“„ ×‘×™×¦×™×¨×ª ×“×•"×— ×“×•×’××”... ×‘×¤×¨×•×™×§×˜ ×××™×ª×™ ×–×” ×™×¤×¢×™×œ ××ª ×”×§×•×“ ×©×›×ª×‘×ª');
        }

        function saveTestResults() {
            const results = document.getElementById('test_results').value;
            if (results && results.length > 50) {
                showFeedback('feedback_test', 'success', 'âœ… ×ª×•×¦××•×ª ×”×‘×“×™×§×” × ×©××¨×•! ×›×œ ×”×›×‘×•×“ ×¢×œ ×”×¢×‘×•×“×” ×”××¢×©×™×ª');
            } else {
                showFeedback('feedback_test', 'error', 'âŒ × ×“×¨×© ×ª×™×¢×•×“ ××¤×•×¨×˜ ×™×•×ª×¨ ×©×œ ×”×‘×“×™×§×”');
            }
        }

        // Download functions
        function downloadFullCode() {
            alert('××•×¨×™×“ ××ª ×›×œ ×”×§×•×“ ××”××¢×‘×“×”...\n(×‘×¤×•×¢×œ ×™×¦×•×¨ ×§×•×‘×¥ ZIP ×¢× ×›×œ ×”×§×‘×¦×™×)');
        }

        function downloadPresentation() {
            alert('××•×¨×™×“ ××¦×’×ª ×¡×™×›×•×...\n(×‘×¤×•×¢×œ ×™×•×¦×¨ PDF ×¢× ×¡×™×›×•× ×”××¢×‘×“×”)');
        }

        function downloadCertificate() {
            alert('ğŸ† ×›×œ ×”×›×‘×•×“ ×¢×œ ×¡×™×•× ×”××¢×‘×“×”!\n(×‘×¤×•×¢×œ ×™×¦×•×¨ ×ª×¢×•×“×ª ×¡×™×•× ××¢×•×¦×‘×ª)');
        }

        function downloadProjectTemplate() {
            alert('ğŸ“¥ ××•×¨×™×“ ×ª×‘× ×™×ª ×¤×¨×•×™×§×˜...\n(×‘×¤×•×¢×œ ×™×•×¨×™×“ ×ª×™×§×™×” ×¢× ××‘× ×” ×¤×¨×•×™×§×˜ ××œ×)');
        }

        function showProjectGuidelines() {
            alert('ğŸ“˜ ×”× ×—×™×•×ª ×”×¤×¨×•×™×§×˜:\n\n1. ×¦×•×¨ ××‘× ×” ×ª×™×§×™×•×ª ××¡×•×“×¨\n2. ×¤×¦×œ ××ª ×”×§×•×“ ×œ××•×“×•×œ×™×\n3. ×›×ª×•×‘ documentation\n4. ×”×•×¡×£ tests\n5. ×¦×•×¨ README ××¤×•×¨×˜\n\n××¦×•×¨×£ ×™×”×™×” ××¡××š ××¤×•×¨×˜...');
        }
    </script>
</body>
</html>