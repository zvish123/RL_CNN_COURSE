<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” ××“××” ×”×¦×¤× ×ª Transposition</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        
        .controls {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
            font-size: 1.1em;
        }
        
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 18px;
            transition: all 0.3s;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            flex: 1;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .section-title {
            font-size: 1.5em;
            color: #667eea;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .matrix-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .matrix {
            display: inline-grid;
            gap: 8px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            direction:ltr;
        }
        
        .cell {
            width: 60px;
            height: 60px;
            border: 3px solid #667eea;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            background: white;
            transition: all 0.3s;
            position: relative;
        }
        
        .cell.empty {
            background: #f0f0f0;
            border-color: #ddd;
            color: #999;
        }
        
        .cell.highlight {
            background: #ffeb3b;
            transform: scale(1.15);
            box-shadow: 0 6px 12px rgba(255, 235, 59, 0.5);
            animation: pulse 0.6s;
            z-index: 10;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1.15); }
            50% { transform: scale(1.25); }
        }
        
        .result-box {
            padding: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            word-break: break-all;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.3);
        }
        
        .steps {
            margin-top: 20px;
        }
        
        .step {
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-right: 4px solid #667eea;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .column-indicator {
            position: absolute;
            top: -25px;
            font-size: 14px;
            color: #667eea;
            font-weight: bold;
        }
        
        .help-box {
            background: #e7f3ff;
            border: 2px solid #2196F3;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .help-box h3 {
            color: #2196F3;
            margin-bottom: 10px;
        }
        
        .example {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .cell {
                width: 45px;
                height: 45px;
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ××“××” ×”×¦×¤× ×ª Transposition</h1>
        <p class="subtitle">×›×œ×™ ××™× ×˜×¨××§×˜×™×‘×™ ×œ×œ××™×“×” ×•×”×ª× ×¡×•×ª</p>
        
        <div class="controls">
            <div class="input-group">
                <label for="message">ğŸ“ ×”×›× ×¡ ×”×•×“×¢×” ×œ×”×¦×¤× ×”:</label>
                <input type="text" id="message" placeholder="×œ×“×•×’××”: HELLO WORLD" oninput="clearResults()">
            </div>
            
            <div class="input-group">
                <label for="key">ğŸ”‘ ×‘×—×¨ ××¤×ª×— (Key) - ××¡×¤×¨ ×¢××•×“×•×ª:</label>
                <input type="number" id="key" min="2" max="10" value="3" oninput="clearResults()">
            </div>
            
            <div class="button-group">
                <button class="btn-primary" onclick="encrypt()">ğŸ”’ ×”×¦×¤×Ÿ!</button>
                <button class="btn-success" onclick="decrypt()">ğŸ”“ ×¤×¢× ×—!</button>
                <button class="btn-secondary" onclick="reset()">ğŸ”„ × ×§×” ×”×›×œ</button>
            </div>
        </div>
        
        <div id="stepsSection" class="section" style="display: none;">
            <h2 class="section-title">ğŸ“š ×©×œ×‘×™ ×”×”×¦×¤× ×”</h2>
            <div id="steps" class="steps"></div>
        </div>
        
        <div id="matrixSection" class="section" style="display: none;">
            <h2 class="section-title">ğŸ¯ ×”×˜×‘×œ×” (Matrix)</h2>
            <div class="matrix-container">
                <div id="matrix" class="matrix"></div>
            </div>
        </div>
        
        <div id="resultSection" class="section" style="display: none;">
            <h2 class="section-title">âœ¨ ×”×ª×•×¦××”</h2>
            <div id="result" class="result-box"></div>
        </div>
        
        <div class="help-box">
            <h3>ğŸ’¡ ××™×š ×–×” ×¢×•×‘×“?</h3>
            <p><strong>×”×¦×¤× ×ª Transposition</strong> ××¢×¨×‘×œ×ª ××ª ×¡×“×¨ ×”××•×ª×™×•×ª ××‘×œ×™ ×œ×©× ×•×ª ××•×ª×Ÿ.</p>
            
            <div class="example">
                <strong>×“×•×’××”:</strong><br>
                ×”×•×“×¢×”: HELLO<br>
                Key: 3<br><br>
                
                × ×›×ª×•×‘ ×‘×˜×‘×œ×” ×¢× 3 ×¢××•×“×•×ª:<br>
                <p dir="ltr">
                H E L<br>
                L O<br><br>
                    </p>
                
                × ×§×¨× ××œ××¢×œ×” ×œ××˜×”:<br>
                ×¢××•×“×” 1: H,L â†’ HL<br>
                ×¢××•×“×” 2: E,O â†’ EO<br>
                ×¢××•×“×” 3: L â†’ L<br><br>
                
                <strong>×ª×•×¦××”: HLEOL</strong>
            </div>

            <p><strong>×¤×™×¢× ×•×— Transposition</strong> ×‘×•× ×” ××—×“×© ××ª ×¡×“×¨ ×”××•×ª×™×•×ª.</p>

            <div class="example">
                <strong>×“×•×’××”:</strong><br>
                ×”×•×“×¢×” ××•×¦×¤× ×ª: HLEOL<br>
                Key: 3<br><br>

                × ×›×ª×•×‘ ×œ×˜×‘×œ×” ×¢× 3 ×¢××•×“×•×ª:<br>

                ×¢××•×“×” ×¨××©×•× ×” H L <br>
                ×œ×¢××•×“×” ×©× ×™×”  E O<br>
                ×œ×¢××•×“×” ×©×œ×™×©×™×ª L<br><br>
                    ××ª×§×‘×œ:<br>
                    <p dir="ltr">
                     H E L <br>
                    L O
                </p>



                × ×§×¨× ××©×××œ ×œ×™××™×Ÿ:<br>
                ×©×•×¨×” 1: HEL<br>
                ×©×•×¨×” 2: LE<br><br>

                <strong>×ª×•×¦××”: HELLO</strong>
            </div>
        </div>
    </div>


    <script>
        let currentMatrix = null;
        let currentKey = null;
        let isEncrypted = false;
        
        function clearResults() {
            document.getElementById('stepsSection').style.display = 'none';
            document.getElementById('matrixSection').style.display = 'none';
            document.getElementById('resultSection').style.display = 'none';
            isEncrypted = false;
        }
        
        function encrypt() {
            const message = document.getElementById('message').value.toUpperCase().replace(/[\t\n\r]/g, '');
            const key = parseInt(document.getElementById('key').value);
            
            if (!message) {
                alert('âŒ ×× × ×”×›× ×¡ ×”×•×“×¢×”!');
                return;
            }
            
            if (key < 2 || key >= message.length) {
                alert(`âŒ ×”××¤×ª×— ×—×™×™×‘ ×œ×”×™×•×ª ×‘×™×Ÿ 2 ×œ-${message.length - 1}`);
                return;
            }
            
            currentKey = key;
            isEncrypted = true;
            
            // ×—×™×©×•×‘ ××¡×¤×¨ ×©×•×¨×•×ª
            const rows = Math.ceil(message.length / key);
            
            // ×©×œ×‘ 1: ×”×¦×’×ª ×”×—×™×©×•×‘
            showSteps(message, key, rows);
            
            // ×©×œ×‘ 2: ×‘× ×™×™×ª ×”××¢×¨×š
            const matrix = buildMatrix(message, rows, key);
            currentMatrix = matrix;
            
            // ×©×œ×‘ 3: ×”×¦×’×ª ×”××¢×¨×š
            displayMatrix(matrix, key);
            
            // ×©×œ×‘ 4: ×”×¦×¤× ×”
            const encrypted = encryptFromMatrix(matrix, key, rows);
            
            // ×©×œ×‘ 5: ×”×¦×’×ª ×”×ª×•×¦××”
            displayResult(encrypted);
            
            // ×©×œ×‘ 6: ×× ×™××¦×™×”
            animateEncryption(matrix, key, rows);
            
            // ×”×¦×’×ª ×›×œ ×”×§×˜×¢×™×
            document.getElementById('stepsSection').style.display = 'block';
            document.getElementById('matrixSection').style.display = 'block';
            document.getElementById('resultSection').style.display = 'block';
        }
        
        function decrypt() {
            const cipher = document.getElementById('message').value.toUpperCase().replace(/[\t\n\r]/g, '');
            const key = parseInt(document.getElementById('key').value);
            
            if (!cipher) {
                alert('âŒ ×× × ×”×›× ×¡ ×”×•×“×¢×” ××•×¦×¤× ×ª ×œ×¤×¢× ×•×—!');
                return;
            }
            
            if (key < 2) {
                alert('âŒ ×”××¤×ª×— ×—×™×™×‘ ×œ×”×™×•×ª ×œ×¤×—×•×ª 2');
                return;
            }
            
            const rows = Math.ceil(cipher.length / key);
            const emptyCells = rows * key - cipher.length;
            
            // ×‘× ×™×™×ª ××¢×¨×š ×œ×¤×¢× ×•×—
            const matrix = [];
            for (let r = 0; r < rows; r++) {
                matrix[r] = [];
                for (let c = 0; c < key; c++) {
                    matrix[r][c] = '';
                }
            }
            
            // ××™×œ×•×™ ×”××¢×¨×š ×¢××•×“×” ××—×¨ ×¢××•×“×”
            let index = 0;
            for (let c = 0; c < key; c++) {
                let colHeight = rows;
                if (c >= key - emptyCells) {
                    colHeight--;
                }
                
                for (let r = 0; r < colHeight; r++) {
                    if (index < cipher.length) {
                        matrix[r][c] = cipher[index];
                        index++;
                    }
                }
            }
            
            // ×§×¨×™××” ×©×•×¨×” ××—×¨ ×©×•×¨×”
            let decrypted = '';
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < key; c++) {
                    if (matrix[r][c]) {
                        decrypted += matrix[r][c];
                    }
                }
            }
            
            // ×”×¦×’×”
            displayMatrix(matrix, key);
            displayResult(decrypted);
            
            document.getElementById('matrixSection').style.display = 'block';
            document.getElementById('resultSection').style.display = 'block';
            
            const stepsHTML = `
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>×”×•×“×¢×” ××•×¦×¤× ×ª:</strong> ${cipher}
                </div>
                <div class="step">
                    <span class="step-number">2</span>
                    <strong>××¤×ª×—:</strong> ${key}
                </div>
                <div class="step">
                    <span class="step-number">3</span>
                    <strong>××¡×¤×¨ ×©×•×¨×•×ª:</strong> ${rows}
                </div>
                <div class="step">
                    <span class="step-number">4</span>
                    <strong>××™×œ×•×™ ×”××¢×¨×š ×¢××•×“×” ××—×¨ ×¢××•×“×”</strong>
                </div>
                <div class="step">
                    <span class="step-number">5</span>
                    <strong>×§×¨×™××” ×©×•×¨×” ××—×¨ ×©×•×¨×”</strong>
                </div>
                <div class="step">
                    <span class="step-number">6</span>
                    <strong>×”×•×“×¢×” ××¤×•×¢× ×—×ª:</strong> ${decrypted}
                </div>
            `;
            
            document.getElementById('steps').innerHTML = stepsHTML;
            document.getElementById('stepsSection').style.display = 'block';
        }
        
        function showSteps(message, key, rows) {
            const stepsHTML = `
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>×”×•×“×¢×” ××§×•×¨×™×ª:</strong> ${message} (${message.length} ×ª×•×•×™×)
                </div>
                <div class="step">
                    <span class="step-number">2</span>
                    <strong>××¤×ª×— ×©× ×‘×—×¨:</strong> ${key} ×¢××•×“×•×ª
                </div>
                <div class="step">
                    <span class="step-number">3</span>
                    <strong>×—×™×©×•×‘ ×©×•×¨×•×ª:</strong> ceil(${message.length} / ${key}) = ${rows}
                </div>
                <div class="step">
                    <span class="step-number">4</span>
                    <strong>×‘× ×™×™×ª ×˜×‘×œ×”:</strong> ${rows} ×©×•×¨×•×ª Ã— ${key} ×¢××•×“×•×ª
                </div>
                <div class="step">
                    <span class="step-number">5</span>
                    <strong>××™×œ×•×™:</strong> ×©×•×¨×” ××—×¨ ×©×•×¨×” ××©×××œ ×œ×™××™×Ÿ
                </div>
                <div class="step">
                    <span class="step-number">6</span>
                    <strong>×§×¨×™××”:</strong> ×¢××•×“×” ××—×¨ ×¢××•×“×” ××œ××¢×œ×” ×œ××˜×”
                </div>
            `;
            
            document.getElementById('steps').innerHTML = stepsHTML;
        }
        
        function buildMatrix(message, rows, cols) {
            const matrix = [];
            let index = 0;
            
            for (let r = 0; r < rows; r++) {
                matrix[r] = [];
                for (let c = 0; c < cols; c++) {
                    matrix[r][c] = index < message.length ? message[index] : '';
                    index++;
                }
            }
            
            return matrix;
        }
        
        function displayMatrix(matrix, cols) {
            const matrixDiv = document.getElementById('matrix');
            matrixDiv.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            matrixDiv.innerHTML = '';
            
            // ×”×•×¡×¤×ª ××¡×¤×¨×™ ×¢××•×“×•×ª
            for (let c = 0; c < cols; c++) {
                const header = document.createElement('div');
                header.style.gridColumn = c + 1;
                header.style.textAlign = 'center';
                header.style.fontWeight = 'bold';
                header.style.color = '#667eea';
                header.style.marginBottom = '5px';
                header.textContent = c + 1;
                matrixDiv.appendChild(header);
            }
            
            // ×”×•×¡×¤×ª ×ª××™×
            matrix.forEach((row, r) => {
                row.forEach((cell, c) => {
                    const div = document.createElement('div');
                    div.className = cell ? 'cell' : 'cell empty';
                    div.id = `cell-${r}-${c}`;
                    div.textContent = cell || 'â€¢';
                    div.style.gridColumn = c + 1;
                    div.style.gridRow = r + 2; // +2 ×›×™ ×™×© ×©×•×¨×ª headers
                    matrixDiv.appendChild(div);
                });
            });
        }
        
        function encryptFromMatrix(matrix, cols, rows) {
            let encrypted = '';
            for (let c = 0; c < cols; c++) {
                for (let r = 0; r < rows; r++) {
                    if (matrix[r][c]) {
                        encrypted += matrix[r][c];
                    }
                }
            }
            return encrypted;
        }
        
        function displayResult(text) {
            document.getElementById('result').textContent = text;
        }
        
        function animateEncryption(matrix, cols, rows) {
            let delay = 0;
            const delayStep = 400;
            
            for (let c = 0; c < cols; c++) {
                for (let r = 0; r < rows; r++) {
                    if (matrix[r][c]) {
                        setTimeout(() => {
                            const cell = document.getElementById(`cell-${r}-${c}`);
                            if (cell) {
                                cell.classList.add('highlight');
                                setTimeout(() => {
                                    cell.classList.remove('highlight');
                                }, delayStep - 100);
                            }
                        }, delay);
                        delay += delayStep;
                    }
                }
            }
        }
        
        function reset() {
            document.getElementById('message').value = '';
            document.getElementById('key').value = '3';
            clearResults();
            currentMatrix = null;
            currentKey = null;
        }
        
        // ×”×•×¡×¤×ª ×ª××™×›×” ×‘-Enter
        document.getElementById('message').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                encrypt();
            }
        });
        
        document.getElementById('key').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                encrypt();
            }
        });
    </script>
</body>
</html>
