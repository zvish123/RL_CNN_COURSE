<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¦×’×ª Scapy - ×›×œ×™ ×¨×©×ª×•×ª ××ª×§×“×</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Heebo', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
            direction: rtl;
        }

        .presentation {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none;
            width: 90%;
            max-width: 1200px;
            height: 85vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 50px;
            overflow-y: auto;
            animation: slideIn 0.5s ease-out;
        }

        .slide.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        h2 {
            color: #764ba2;
            font-size: 1.8em;
            margin: 25px 0 15px 0;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        h3 {
            color: #667eea;
            font-size: 1.3em;
            margin: 20px 0 10px 0;
        }

        p, li {
            font-size: 1.1em;
            line-height: 1.8;
            color: #333;
            margin-bottom: 12px;
        }

        ul {
            margin-right: 30px;
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            direction: ltr;
            text-align: left;
            font-size: 1.2em;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .code-block code {
            font-size: 1em;
            line-height: 1.5;
        }

        .highlight {
            background: linear-gradient(120deg, #ffeb3b 0%, #ffc107 100%);
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
        }

        .warning-box {
            background: #fff3cd;
            border-right: 5px solid #ff9800;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box.critical {
            background: #f8d7da;
            border-right-color: #dc3545;
        }

        .tip-box {
            background: #d1ecf1;
            border-right: 5px solid #17a2b8;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d4edda;
            border-right: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .controls {
            position: fixed;
            bottom: 30px;
            right: 50%;
            transform: translateX(50%);
            display: flex;
            gap: 15px;
            z-index: 1000;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-family: 'Heebo', Arial, sans-serif;
        }

        .btn-prev {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-next {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .slide-number {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            color: #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .demo-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            margin: 15px 5px;
            transition: all 0.3s;
            font-family: 'Heebo', Arial, sans-serif;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
        }

        .demo-button:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(102, 126, 234, 0.5);
        }

        .solution-content {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-right: 4px solid #28a745;
        }

        .solution-content.visible {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th,
        .comparison-table td {
            border: 2px solid #667eea;
            padding: 12px;
            text-align: center;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            font-size: 1.1em;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .quiz-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .quiz-option {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            border-color: #667eea;
            transform: translateX(-5px);
        }

        .quiz-option.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .quiz-option.wrong {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .network-diagram {
            text-align: center;
            margin: 30px 0;
            font-size: 1.3em;
        }

        .layer-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            margin: 5px auto;
            border-radius: 10px;
            max-width: 600px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        @media (max-width: 768px) {
            .slide {
                padding: 30px 20px;
                width: 95%;
            }

            h1 {
                font-size: 2em;
            }

            h2 {
                font-size: 1.5em;
            }

            p, li {
                font-size: 1em;
            }

            .code-block {
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body>
    <div class="slide-number" id="slideNumber">×©×§×•×¤×™×ª 1 / 17</div>

    <div class="presentation">
        <!-- Slide 1: ×›×•×ª×¨×ª -->
        <div class="slide active">
            <h1>ğŸ” Scapy</h1>
            <h2 style="text-align: center; color: #764ba2; border: none;">×›×œ×™ ××ª×§×“× ×œ×× ×™×¤×•×œ×¦×™×” ×•×”×¡× ×¤×ª ×¤×§×˜×•×ª ×¨×©×ª</h2>

            <div style="text-align: center; margin: 50px 0;">
                <div style="font-size: 8em; color: #667eea;">ğŸ</div>
            </div>

            <div style="text-align: center; margin-top: 50px; font-size: 1.3em; color: #666;">
                <p>ğŸ“š ×§×•×¨×¡ ×¡×™×™×‘×¨ ×œ×ª×™×›×•× ×™×¡×˜×™×</p>
                <p>ğŸ’» ××•×“×•×œ ×¨×©×ª×•×ª ××ª×§×“××•×ª</p>
                <p>ğŸ“ Python & Scapy</p>
            </div>
        </div>

        <!-- Slide 2: ××” × ×œ××“ ×”×™×•×? -->
        <div class="slide">
            <h1>ğŸ“‹ ××” × ×œ××“ ×”×™×•×?</h1>

            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-top: 40px;">
                <div class="tip-box">
                    <h3>ğŸ¯ ×—×œ×§ ×': ×™×¡×•×“×•×ª</h3>
                    <ul>
                        <li>TCP Ping</li>
                        <li>Traceroute</li>
                        <li>DNS Resolution</li>
                        <li>Port Scanning</li>
                        <li>ARP Poisoning (×œ×™××•×“×™)</li>
                    </ul>
                </div>

                <div class="success-box">
                    <h3>ğŸ’¡ ×—×œ×§ ×‘': ××ª×§×“×</h3>
                    <ul>
                        <li>Fragmentation Attacks</li>
                        <li>Malformed Packets</li>
                        <li>VLAN Hopping</li>
                        <li>IP Protocol Scan</li>
                        <li>TTL Tricks</li>
                    </ul>
                </div>
            </div>

            <div class="warning-box" style="margin-top: 30px;">
                <h3>âš ï¸ ×—×©×•×‘ ×œ×–×›×•×¨!</h3>
                <p>Scapy ×”×•× ×›×œ×™ ×—×–×§ ×©×™×›×•×œ ×œ×©××© ×’× ×œ×˜×•×‘ ×•×’× ×œ×¨×¢. × ×©×ª××© ×‘×• <strong>××š ×•×¨×§ ×‘××¡×’×¨×ª ×—×•×§×™×ª ×•××ª×™×ª</strong>, ×¢×œ ×¨×©×ª×•×ª ×©×™×© ×œ× ×• ×”×¨×©××” ×œ×‘×“×•×§.</p>
            </div>

            <div class="tip-box" style="margin-top: 20px;">
                <h3>ğŸ“ ××§×•×¨×•×ª</h3>
                <p>×”××¦×’×ª ××‘×•×¡×¡×ª ×¢×œ:</p>
                <ul>
                    <li>Philippe Biondi - CanSecWest 2005</li>
                    <li>Scapy Official Documentation</li>
                    <li>× ×™×¡×™×•×Ÿ ××¢×©×™ ×‘×¢×‘×•×“×” ×¢× Scapy</li>
                </ul>
            </div>
        </div>

        <!-- Slide 3: ×œ××” Scapy? -->
        <div class="slide">
            <h1>ğŸ¤” ×œ××” Scapy ×•×œ× Wireshark?</h1>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>×ª×›×•× ×”</th>
                        <th>Wireshark</th>
                        <th>Scapy</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>×”×¡× ×¤×”</strong></td>
                        <td>âœ… ××¦×•×™×Ÿ</td>
                        <td>âœ… ××¦×•×™×Ÿ</td>
                    </tr>
                    <tr>
                        <td><strong>×©×œ×™×—×ª ×¤×§×˜×•×ª</strong></td>
                        <td>âŒ ×œ×</td>
                        <td>âœ… ×›×Ÿ</td>
                    </tr>
                    <tr>
                        <td><strong>××•×˜×•××¦×™×”</strong></td>
                        <td>âš ï¸ ××•×’×‘×œ</td>
                        <td>âœ… ××œ×</td>
                    </tr>
                    <tr>
                        <td><strong>×× ×™×¤×•×œ×¦×™×”</strong></td>
                        <td>âŒ ×œ×</td>
                        <td>âœ… ×›×Ÿ</td>
                    </tr>
                    <tr>
                        <td><strong>×××©×§</strong></td>
                        <td>âœ… GUI × ×•×—</td>
                        <td>âš ï¸ Command Line</td>
                    </tr>
                    <tr>
                        <td><strong>×ª×›× ×•×ª</strong></td>
                        <td>âŒ ×œ×</td>
                        <td>âœ… Python</td>
                    </tr>
                </tbody>
            </table>

            <div class="tip-box" style="margin-top: 30px;">
                <h3>ğŸ’¡ ×”××¡×§× ×”</h3>
                <p><strong>Wireshark</strong> ××¦×•×™×Ÿ ×œ× ×™×ª×•×— ×—×–×•×ª×™ ×•×œ××™×“×” ×¨××©×•× ×™×ª.</p>
                <p><strong>Scapy</strong> ××•×©×œ× ×œ<span class="highlight">××•×˜×•××¦×™×”, ×× ×™×¤×•×œ×¦×™×” ×•×¤×™×ª×•×— ×›×œ×™×!</span></p>
            </div>
        </div>

        <!-- Slide 4: ×”×ª×§× ×” -->
        <div class="slide">
            <h1>ğŸš€ ×”×ª×§× ×” ×•×©×™××•×© ×¨××©×•× ×™</h1>

            <h2>×”×ª×§× ×”</h2>
            <pre class="code-block">
<code># ×”×ª×§× ×” ×‘×××¦×¢×•×ª pip
pip install scapy

# ×™×™×‘×•× ×‘×§×•×“ Python
from scapy.all import *</code>
            </pre>

            <h2>×©×ª×™ ×“×¨×›×™× ×œ×¢×‘×•×“×”</h2>

            <div class="tip-box">
                <h3>1ï¸âƒ£ ××¦×‘ ××™× ×˜×¨××§×˜×™×‘×™</h3>
                <pre class="code-block">
<code># ×”×¤×¢×œ×ª Scapy
scapy

# ××• ×“×¨×š Python
python
>>> from scapy.all import *</code>
                </pre>
                <p><strong>××ª×™:</strong> × ×™×¡×•×™×™× ××”×™×¨×™×, ×œ×™××•×“, ×‘×“×™×§×•×ª</p>
            </div>

            <div class="success-box">
                <h3>2ï¸âƒ£ ×¡×§×¨×™×¤×˜×™× (.py files)</h3>
                <pre class="code-block">
<code>#!/usr/bin/env python3
from scapy.all import *

# ×”×§×•×“ ×©×œ×š ×›××Ÿ
packet = IP(dst="8.8.8.8")/ICMP()
send(packet)</code>
                </pre>
                <p><strong>××ª×™:</strong> ××•×˜×•××¦×™×”, ×›×œ×™× ××•×¨×›×‘×™×, ×—×–×¨×” ×¢×œ ××©×™××•×ª</p>
            </div>
        </div>

        <!-- Slide 5: ×™×¦×™×¨×ª ×¤×§×˜×•×ª ×‘×¡×™×¡×™×•×ª -->
        <div class="slide">
            <h1>ğŸ”¨ ×™×¦×™×¨×ª ×¤×§×˜×•×ª ×‘×¡×™×¡×™×•×ª</h1>

            <h2>×”××•×¤×¨×˜×•×¨ ×”×××’×™: /</h2>
            <pre class="code-block">
<code># ×™×¦×™×¨×ª ×¤×§×˜×” ×¢× ××¡×¤×¨ ×©×›×‘×•×ª
packet = IP(dst="8.8.8.8") / ICMP()

# ×”×•×¡×¤×ª TCP
packet = IP(dst="192.168.1.1") / TCP(dport=80, flags="S")

# ×©×›×‘×•×ª ××¨×•×‘×•×ª
packet = Ether() / IP(dst="1.1.1.1") / UDP(dport=53) / DNS(qd=DNSQR(qname="example.com"))

# ×”×¦×’×”
packet.show()
packet.summary()</code>
            </pre>

            <div class="success-box">
                <h3>âœ¨ ××” ×¢×•×©×” / ?</h3>
                <ul>
                    <li>××‘×¦×¢ ×× ×§×¤×¡×•×œ×¦×™×” ××•×˜×•××˜×™×ª</li>
                    <li>×××œ× ××ª ×©×“×” ×”-protocol</li>
                    <li>××¢×“×›×Ÿ checksums</li>
                    <li>××ª××™× ××•×¨×›×™×</li>
                </ul>
            </div>

            <h2>×’×™×©×” ×œ×©×›×‘×•×ª</h2>
            <pre class="code-block">
<code>packet = IP(dst="1.1.1.1") / ICMP()

# ×‘×“×™×§×ª ×§×™×•× ×©×›×‘×”
if ICMP in packet:
    print("×™×© ICMP!")

# ×’×™×©×” ×œ×©×›×‘×”
ip_layer = packet[IP]
print(ip_layer.dst)  # 1.1.1.1</code>
            </pre>
        </div>

        <!-- Slide 6: ×ª×¨×’×™×œ 1 - TCP Ping -->
        <div class="slide">
            <h1>ğŸ’» ×ª×¨×’×™×œ 1: TCP Ping</h1>

            <div class="success-box">
                <h2>ğŸ“‹ ×”××©×™××”</h2>
                <p>×›×ª×•×‘ ×¤×•× ×§×¦×™×” ×©×‘×•×“×§×ª ×× ×¤×•×¨×˜ ××¡×•×™× ×¤×ª×•×— ×¢×œ ×™×“×™ ×©×œ×™×—×ª TCP SYN ×•×‘×“×™×§×ª ×”×ª×©×•×‘×”.</p>
            </div>

            <h3>ğŸ¯ ×“×¨×™×©×•×ª:</h3>
            <ul>
                <li>×§×‘×œ ×›×ª×•×‘×ª IP ×•××¡×¤×¨ ×¤×•×¨×˜</li>
                <li>×©×œ×— ×—×‘×™×œ×ª TCP ×¢× ×“×’×œ SYN</li>
                <li>×—×›×” ×œ×ª×©×•×‘×” ×¢×“ 2 ×©× ×™×•×ª</li>
                <li>×”×“×¤×¡ ×× ×”×¤×•×¨×˜ ×¤×ª×•×—/×¡×’×•×¨</li>
                <li>×”×¦×’ ×–××Ÿ ×ª×’×•×‘×”</li>
            </ul>

            <h3>ğŸ’¡ ×“×•×’××”:</h3>
            <pre class="code-block">
<code>tcp_ping("192.168.1.1", 22)
# âœ… Port 22 OPEN - 15.3ms</code>
            </pre>

            <button class="demo-button" onclick="toggleSolution('solution1')">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>

            <div id="solution1" class="solution-content">
                <h3 style="color: #28a745;">âœ… ×”×¤×ª×¨×•×Ÿ ×”××œ×:</h3>
                <pre class="code-block">
<code>from scapy.all import *
import time

def tcp_ping(host, port, repeat=3):
    """×‘×•×“×§ ×× ×¤×•×¨×˜ ×¤×ª×•×— ×‘×××¦×¢×•×ª TCP SYN"""
    print(f"ğŸ” Testing {host}:{port}...\n")
    
    successful = 0
    response_times = []
    
    for i in range(repeat):
        # ×™×¦×™×¨×ª ×—×‘×™×œ×ª TCP SYN
        packet = IP(dst=host) / TCP(dport=port, flags="S", 
                                     sport=RandShort(), seq=RandShort())
        
        # ××“×™×“×ª ×–××Ÿ
        start_time = time.time()
        response = sr1(packet, timeout=2, verbose=0)
        duration = (time.time() - start_time) * 1000
        
        if response and response.haslayer(TCP):
            if response[TCP].flags == "SA":  # SYN-ACK
                successful += 1
                response_times.append(duration)
                print(f"[{i+1}] âœ… OPEN - {duration:.1f}ms")
                
                # ×©×œ×™×—×ª RST
                rst = IP(dst=host) / TCP(dport=port, flags="R")
                send(rst, verbose=0)
            elif response[TCP].flags == "RA":  # RST-ACK
                print(f"[{i+1}] âŒ CLOSED - {duration:.1f}ms")
        else:
            print(f"[{i+1}] â±ï¸ Timeout")
        
        time.sleep(0.5)
    
    # ×¡×™×›×•×
    print(f"\n{'='*50}")
    print(f"Summary: {successful}/{repeat} successful")
    if response_times:
        print(f"Avg time: {sum(response_times)/len(response_times):.1f}ms")
    print(f"{'='*50}")

# ×©×™××•×©:
tcp_ping("192.168.1.1", 22)</code>
                </pre>
            </div>
        </div>

        <!-- Slide 7: ×ª×¨×’×™×œ 2 - Traceroute -->
        <div class="slide">
            <h1>ğŸ—ºï¸ ×ª×¨×’×™×œ 2: Traceroute</h1>

            <div class="success-box">
                <h2>ğŸ“‹ ×”××©×™××”</h2>
                <p>×›×ª×•×‘ ×¤×•× ×§×¦×™×” ×©××‘×¦×¢×ª traceroute - ××¦×™×’×” ××ª ×”××¡×œ×•×œ ×œ×™×¢×“.</p>
            </div>

            <h3>ğŸ¯ ××™×š ×–×” ×¢×•×‘×“?</h3>
            <div class="tip-box">
                <p><strong>TTL (Time To Live):</strong> ×›×œ × ×ª×‘ ××§×˜×™×Ÿ ×‘-1. ×›×©××’×™×¢ ×œ-0, ×”× ×ª×‘ ×©×•×œ×— ICMP Time Exceeded.</p>
                <p>×©×•×œ×—×™× ×—×‘×™×œ×•×ª ×¢× TTL=1, 2, 3... ×›×“×™ ×œ×’×œ×•×ª ××ª ×›×œ ×”× ×ª×‘×™×!</p>
            </div>

            <button class="demo-button" onclick="toggleSolution('solution2')">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>

            <div id="solution2" class="solution-content">
                <h3 style="color: #28a745;">âœ… ×”×¤×ª×¨×•×Ÿ ×”××œ×:</h3>
                <pre class="code-block">
<code>from scapy.all import *
import socket
import time

def mytraceroute(host, maxttl=30):
    """××‘×¦×¢ traceroute ×œ×™×¢×“"""
    print("="*70)
    print(f"ğŸ” Traceroute to: {host}")
    print("="*70)
    
    # DNS Resolution
    try:
        ip = socket.gethostbyname(host)
        print(f"âœ… Resolved {host} â†’ {ip}\n")
    except:
        print(f"âŒ Cannot resolve: {host}")
        return
    
    print(f"{'Hop':<5} {'IP':<20} {'Hostname':<35} {'RTT'}")
    print("-"*70)
    
    for ttl in range(1, maxttl + 1):
        packet = IP(dst=ip, ttl=ttl) / ICMP()
        
        # 3 × ×™×¡×™×•× ×•×ª
        rtts = []
        responding_ip = None
        
        for attempt in range(3):
            start = time.time()
            response = sr1(packet, timeout=2, verbose=0)
            rtt = (time.time() - start) * 1000
            
            if response:
                rtts.append(rtt)
                responding_ip = response.src
        
        if responding_ip:
            # Reverse DNS
            try:
                hostname = socket.gethostbyaddr(responding_ip)[0]
            except:
                hostname = "unknown"
            
            avg_rtt = sum(rtts)/len(rtts) if rtts else 0
            print(f"{ttl:<5} {responding_ip:<20} {hostname:<35} {avg_rtt:.1f}ms")
            
            if responding_ip == ip:
                print(f"\nğŸ¯ Reached destination at hop {ttl}!")
                break
        else:
            print(f"{ttl:<5} {'*':<20} {'timeout':<35} *")
    
    print("="*70)

# ×©×™××•×©:
mytraceroute("google.com", 15)</code>
                </pre>
            </div>
        </div>

        <!-- Slide 8: ×ª×¨×’×™×œ 3 - DNS Resolution -->
        <div class="slide">
            <h1>ğŸŒ ×ª×¨×’×™×œ 3: DNS Resolution</h1>

            <div class="success-box">
                <h2>ğŸ“‹ ×”××©×™××”</h2>
                <p>×›×ª×•×‘ ×¤×•× ×§×¦×™×” ×©××‘×¦×¢×ª DNS resolution ×™×“× ×™×ª.</p>
            </div>

            <h3>ğŸ’¡ ×¨×§×¢:</h3>
            <div class="tip-box">
                <p><strong>DNS:</strong> ××ª×¨×’× domain names ×œ-IP addresses</p>
                <p><strong>DNS Query:</strong> ×©××™×œ×ª×” ×œ×©×¨×ª DNS</p>
                <p><strong>DNS Response:</strong> ×”×ª×©×•×‘×” ×¢× ×›×ª×•×‘×•×ª IP</p>
            </div>

            <button class="demo-button" onclick="toggleSolution('solution3')">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>

            <div id="solution3" class="solution-content">
                <h3 style="color: #28a745;">âœ… ×”×¤×ª×¨×•×Ÿ ×”××œ×:</h3>
                <pre class="code-block">
<code>from scapy.all import *
import socket

def resolve_DNS(host, dns_server="8.8.8.8"):
    """××‘×¦×¢ DNS resolution ×™×“× ×™"""
    print("="*70)
    print(f"ğŸ” DNS Resolution for: {host}")
    print(f"ğŸ“¡ DNS server: {dns_server}")
    print("="*70 + "\n")
    
    # ×™×¦×™×¨×ª ×©××™×œ×ª×ª DNS (rd=1 means recursion desired)
    dns_query = IP(dst=dns_server) / UDP(dport=53) / DNS(rd=1, qd=DNSQR(qname=host))
    
    print("ğŸ“¤ Sending DNS query...")
    response = sr1(dns_query, timeout=5, verbose=0)
    
    if not response or not response.haslayer(DNS):
        print("âŒ No DNS response")
        return
    
    dns_response = response[DNS]
    
    if dns_response.rcode != 0:
        print(f"âŒ DNS Error - code: {dns_response.rcode}")
        return
    
    print("âœ… DNS Response received!\n")
    
    # × ×™×ª×•×— ×ª×©×•×‘×•×ª
    ip_addresses = []
    
    if dns_response.an:
        for i in range(dns_response.ancount):
            answer = dns_response.an[i]
            
            if answer.type == 1:  # A Record (IPv4)
                ip = answer.rdata
                ip_addresses.append(ip)
                print(f"ğŸŒ A Record: {ip}")
            elif answer.type == 5:  # CNAME
                cname = answer.rdata.decode() if isinstance(answer.rdata, bytes) else answer.rdata
                print(f"ğŸ”— CNAME: {cname}")
            elif answer.type == 28:  # AAAA (IPv6)
                print(f"ğŸŒ AAAA: {answer.rdata}")
    
    # ×¡×™×›×•×
    print(f"\n{'='*70}")
    print(f"ğŸ“Š Summary:")
    print(f"   IPs: {', '.join(ip_addresses)}")
    print(f"{'='*70}")
    
    return ip_addresses

# ×©×™××•×©:
resolve_DNS("google.com")
resolve_DNS("github.com", "1.1.1.1")</code>
                </pre>
            </div>
        </div>

        <!-- Slide 9: ×ª×¨×’×™×œ 4 - Port Scanner -->
        <div class="slide">
            <h1>ğŸ” ×ª×¨×’×™×œ 4: Port Scanner (SYN Scan)</h1>

            <div class="success-box">
                <h2>ğŸ“‹ ×”××©×™××”</h2>
                <p>×›×ª×•×‘ ×¡×•×¨×§ ×¤×•×¨×˜×™× ×©××–×”×” OPEN, CLOSED, FILTERED.</p>
            </div>

            <div class="warning-box">
                <h3>âš ï¸ ××–×”×¨×” ×—×•×§×™×ª!</h3>
                <p>×¡×¨×™×§×ª ×¤×•×¨×˜×™× ×¢×œ ×¨×©×ª×•×ª ×–×¨×•×ª ×”×™× <strong>×‘×œ×ª×™ ×—×•×§×™×ª</strong>!</p>
                <p>×”×©×ª××© ×¨×§ ×¢×œ ×¨×©×ª×•×ª ×©×™×© ×œ×š ×”×¨×©××”!</p>
            </div>

            <button class="demo-button" onclick="toggleSolution('solution4')">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>

            <div id="solution4" class="solution-content">
                <h3 style="color: #28a745;">âœ… ×”×¤×ª×¨×•×Ÿ ×”××œ×:</h3>
                <pre class="code-block">
<code>from scapy.all import *
import time

def synscan(host, ports, timeout=1):
    """××‘×¦×¢ SYN scan ×¢×œ ×¨×©×™××ª ×¤×•×¨×˜×™×"""
    print("="*70)
    print(f"ğŸ” SYN Port Scanner")
    print(f"ğŸ¯ Target: {host}")
    print("="*70 + "\n")
    
    results = {'open': [], 'closed': [], 'filtered': []}
    
    for i, port in enumerate(ports, 1):
        progress = (i / len(ports)) * 100
        print(f"[{progress:5.1f}%] Port {port}...", end=" ")
        
        packet = IP(dst=host) / TCP(dport=port, flags="S")
        response = sr1(packet, timeout=timeout, verbose=0)
        
        if response:
            if response.haslayer(TCP):
                if response[TCP].flags == "SA":  # OPEN
                    results['open'].append(port)
                    print("âœ… OPEN")
                    # RST
                    send(IP(dst=host)/TCP(dport=port, flags="R"), verbose=0)
                elif response[TCP].flags == "RA":  # CLOSED
                    results['closed'].append(port)
                    print("âŒ CLOSED")
            else:
                results['filtered'].append(port)
                print("ğŸ›¡ï¸ FILTERED")
        else:
            results['filtered'].append(port)
            print("ğŸ›¡ï¸ FILTERED")
        
        time.sleep(0.1)
    
    # ×¡×™×›×•×
    print(f"\n{'='*70}")
    print(f"âœ… OPEN: {results['open']}")
    print(f"âŒ CLOSED: {results['closed']}")
    print(f"ğŸ›¡ï¸ FILTERED: {results['filtered']}")
    print(f"{'='*70}")
    
    return results

# ×©×™××•×©:
common_ports = [21, 22, 80, 443, 3306, 8080]
synscan("192.168.1.1", common_ports)</code>
                </pre>
            </div>
        </div>

        <!-- Slide 10: ×ª×¨×’×™×œ 5 - ARP Poisoning -->
        <div class="slide">
            <h1>â˜ ï¸ ×ª×¨×’×™×œ 5: ARP Poisoning</h1>

            <div class="warning-box critical">
                <h2>ğŸš¨ ××–×”×¨×ª ××‘×˜×—×” ×§×¨×™×˜×™×ª!</h2>
                <p><strong>ARP Poisoning ×”×•× ×”×ª×§×¤×”!</strong></p>
                <ul>
                    <li>×©×™××•×© ×¢×œ ×¨×©×ª ×–×¨×” ×”×•× <strong>×¤×œ×™×œ×™</strong></li>
                    <li>×’×•×¨× ×œ×”×¤×¨×¢×” ××©××¢×•×ª×™×ª</li>
                    <li>×¨×§ ×‘×¡×‘×™×‘×ª lab ××‘×•×§×¨×ª</li>
                    <li>×“×•×¨×© ×”×¨×©××” ×‘×›×ª×‘</li>
                </ul>
            </div>

            <h3>ğŸ¯ ××”×• ARP Poisoning?</h3>
            <div class="tip-box">
                <p><strong>ARP:</strong> ×××¤×” IP ×œ-MAC addresses</p>
                <p><strong>ARP Poisoning:</strong> ×©×œ×™×—×ª ARP replies ××–×•×™×¤×•×ª</p>
                <p><strong>×ª×•×¦××”:</strong> ×”×ª×¢×‘×•×¨×” ×¢×•×‘×¨×ª ×“×¨×š ×”×ª×•×§×£ (MITM)</p>
            </div>

            <h3>ğŸ›¡ï¸ ×”×’× ×”:</h3>
            <ul>
                <li>Static ARP entries</li>
                <li>ARP inspection</li>
                <li>× ×™×˜×•×¨ ARP traffic</li>
                <li>×©×™××•×© ×‘-VPN</li>
            </ul>

            <button class="demo-button" onclick="toggleSolution('solution51')">ğŸ”“ ×”×¦×’ ×§×•×“ (×œ×™××•×“×™!)</button>

            <div id="solution51" class="solution-content">
                <h3 style="color: #dc3545;">âš ï¸ ×§×•×“ ×œ×™××•×“×™ - ×œ× ×œ×”×¤×¢×œ×”!</h3>
                <pre class="code-block">
<code>from scapy.all import *

def detect_arp_poisoning(interface="eth0", duration=60):
    """×›×œ×™ ×œ×–×™×”×•×™ × ×™×¡×™×•× ×•×ª ARP Poisoning"""
    print("ğŸ›¡ï¸ ARP Poisoning Detection")
    print(f"Monitoring {interface} for {duration}s...\n")
    
    arp_table = {}
    alerts = []
    
    def analyze_arp(packet):
        if ARP in packet and packet[ARP].op == 2:  # reply
            ip = packet[ARP].psrc
            mac = packet[ARP].hwsrc
            
            # ×‘×“×™×§×ª ×©×™× ×•×™ MAC
            if ip in arp_table:
                if arp_table[ip] != mac:
                    alert = f"ğŸš¨ IP {ip} changed MAC: {arp_table[ip]} â†’ {mac}"
                    print(alert)
                    alerts.append(alert)
            
            arp_table[ip] = mac
    
    sniff(filter="arp", prn=analyze_arp, timeout=duration, iface=interface)
    
    print(f"\n{'='*70}")
    print(f"ğŸ“Š Summary:")
    print(f"   Unique IPs: {len(arp_table)}")
    print(f"   Alerts: {len(alerts)}")
    if alerts:
        print("\nâš ï¸ Suspicious activity!")
        for alert in alerts:
            print(f"   {alert}")
    else:
        print("\nâœ… No suspicious activity")
    print(f"{'='*70}")

# ×©×™××•×© ×‘×˜×•×— - ×–×™×”×•×™ ×‘×œ×‘×“:
detect_arp_poisoning("eth0", 30)

# âš ï¸ NEVER RUN THIS ON PRODUCTION:
"""
def arp_poison(target_ip, gateway_ip):
    # THIS IS ILLEGAL ON NETWORKS YOU DON'T OWN
    # Educational demonstration only
    print("Would poison ARP tables here")
    print("Target would think Gateway MAC is attacker's MAC")
    print("Gateway would think Target MAC is attacker's MAC")
    print("All traffic goes through attacker")
"""</code>
                </pre>
                <div class="warning-box" style="margin-top: 20px;">
                    <h3>ğŸ“ ×œ×§×—×™×:</h3>
                    <ul>
                        <li>ARP ×—×¡×¨ ××™××•×ª - ×§×œ ×œ×–×™×™×£</li>
                        <li>HTTPS/TLS ××’×Ÿ ×’× ×‘× ×•×›×—×•×ª MITM</li>
                        <li>× ×™×˜×•×¨ ×”×›×¨×—×™ ×œ×–×™×”×•×™</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 11: ×©××œ×•×ª ×‘×•×—×Ÿ -->
        <div class="slide">
            <h1>â“ ×©××œ×•×ª ×”×‘× ×”</h1>

            <div class="quiz-container">
                <h2>×©××œ×” 1</h2>
                <p>××” ×”×”×‘×“×œ ×‘×™×Ÿ <code>send()</code> ×œ-<code>sr1()</code>?</p>
                <div class="quiz-option" onclick="checkAnswer(this, true)">
                    ×) sr1() ××—×›×” ×œ×ª×©×•×‘×”, send() ×œ×
                </div>
                <div class="quiz-option" onclick="checkAnswer(this, false)">
                    ×‘) send() ×‘-Layer 2, sr1() ×‘-Layer 3
                </div>
                <div class="quiz-option" onclick="checkAnswer(this, false)">
                    ×’) ××™×Ÿ ×”×‘×“×œ
                </div>
            </div>

            <div class="quiz-container">
                <h2>×©××œ×” 2</h2>
                <p>××™×–×” ×“×’×œ TCP ××¦×™×™×Ÿ "×”×ª×—×œ×ª ×—×™×‘×•×¨"?</p>
                <div class="quiz-option" onclick="checkAnswer(this, false)">
                    ×) ACK
                </div>
                <div class="quiz-option" onclick="checkAnswer(this, true)">
                    ×‘) SYN
                </div>
                <div class="quiz-option" onclick="checkAnswer(this, false)">
                    ×’) RST
                </div>
            </div>

            <div class="quiz-container">
                <h2>×©××œ×” 3</h2>
                <p>××” ×§×•×¨×” ×›×©-TTL ××’×™×¢ ×œ-0?</p>
                <div class="quiz-option" onclick="checkAnswer(this, false)">
                    ×) ×”×¤×§×˜×” ×××©×™×›×” ×”×œ××”
                </div>
                <div class="quiz-option" onclick="checkAnswer(this, true)">
                    ×‘) ×”× ×ª×‘ ×©×•×œ×— ICMP Time Exceeded
                </div>
                <div class="quiz-option" onclick="checkAnswer(this, false)">
                    ×’) ×”×¤×§×˜×” × ×©××¨×ª ×‘× ×ª×‘
                </div>
            </div>

            <div class="quiz-container">
                <h2>×©××œ×” 4</h2>
                <p>××™×–×” ×¤×¨×•×˜×•×§×•×œ ××©××© ×œ-DNS queries?</p>
                <div class="quiz-option" onclick="checkAnswer(this, true)">
                    ×) UDP
                </div>
                <div class="quiz-option" onclick="checkAnswer(this, false)">
                    ×‘) TCP
                </div>

                <div class="quiz-option" onclick="checkAnswer(this, false)">
                    ×’) ICMP
                </div>
            </div>
        </div>

        <!-- Slide 12: Fragmentation Attacks -->
        <div class="slide">
            <h1>ğŸ’¥ ×ª×¨×’×™×œ 5: Fragmentation Attacks</h1>

            <div class="warning-box critical">
                <h2>ğŸš¨ ××–×”×¨×” - ×§×•×“ ×œ×™××•×“×™ ×‘×œ×‘×“!</h2>
                <p>×”×ª×§×¤×•×ª ××œ×” ×™×›×•×œ×•×ª ×œ×’×¨×•× × ×–×§. <strong>××œ ×ª×¨×™×¥ ×¢×œ ××¢×¨×›×•×ª ×™×™×¦×•×¨!</strong></p>
            </div>

            <div class="tip-box">
                <h3>××”×™ ×”×ª×§×¤×ª Fragmentation?</h3>
                <p>× ×™×¦×•×œ ×‘××’×™× ×‘×“×¨×š ×©×‘×” ××¢×¨×›×•×ª ××¨×›×™×‘×•×ª ×¤×§×˜×•×ª ××¤×•×¦×œ×•×ª</p>
                <ul>
                    <li><strong>Ping of Death:</strong> ×—×‘×™×œ×” ×’×“×•×œ×” ××“×™ (>65535 bytes)</li>
                    <li><strong>Teardrop/Nestea:</strong> overlap ×©×œ fragments</li>
                    <li><strong>Land Attack:</strong> src=dst ×’×•×¨× ×œ-loop</li>
                </ul>
            </div>

            <button class="demo-button" onclick="toggleSolution('solution5')">ğŸ”“ ×”×¦×’ ×“×•×’×××•×ª</button>

            <div id="solution5" class="solution-content">
                <h3 style="color: #dc3545;">âš ï¸ ×§×•×“ ×œ×™××•×“×™:</h3>
                <pre class="code-block">
<code>from scapy.all import *

# 1. Ping of Death (×™×©×Ÿ - ××¢×¨×›×•×ª ××•×“×¨× ×™×•×ª ××•×’× ×•×ª)
def ping_of_death_demo(target):
    """×©×œ×™×—×ª ICMP ×’×“×•×œ ×-65535 bytes"""
    print("âš ï¸ Ping of Death - ×ª×™××•×¨×˜×™ ×‘×œ×‘×“")
    
    # load = "X" * 60000
    # for fragment in fragment(IP(dst=target)/ICMP()/load):
    #     send(fragment)
    
    print("âœ… ×”×¡×‘×¨: ×”×—×‘×™×œ×” ×’×•×¨××ª ×œ-buffer overflow")

# 2. Teardrop Attack  
def teardrop_demo(target):
    """Overlapping fragments"""
    print("âš ï¸ Teardrop - fragments ×—×•×¤×¤×™×")
    
    # Fragment ×¢× offset ×—×•×¤×¤×™× ×’×•×¨× ×œ×‘×¢×™×•×ª ×‘×”×¨×›×‘×”
    # send(IP(dst=target, id=42, flags="MF")/UDP()/"X"*10)
    # send(IP(dst=target, id=42, frag=48)/"X"*116)
    
    print("âœ… ×”×¡×‘×¨: ×”××¢×¨×›×ª ×œ× ×™×•×“×¢×ª ××™×š ×œ×”×¨×›×™×‘")

# 3. Land Attack
def land_demo(target):
    """SYN packet ×¢× src=dst"""
    print("âš ï¸ Land Attack - SYN loop")
    
    # packet = IP(src=target, dst=target)/TCP(sport=135, dport=135, flags="S")
    # send(packet)
    
    print("âœ… ×”×¡×‘×¨: ×”××¢×¨×›×ª ×¢×•× ×” ×œ×¢×¦××” â†’ infinite loop")

print("ğŸ”¬ Fragmentation Attacks - ×œ×™××•×“×™ ×‘×œ×‘×“")</code>
                </pre>
            </div>
        </div>

        <!-- Slide 13: Malformed Packets -->
        <div class="slide">
            <h1>ğŸ”§ ×ª×¨×’×™×œ 6: Malformed Packets</h1>

            <div class="tip-box">
                <h3>××”× Malformed Packets?</h3>
                <p>×—×‘×™×œ×•×ª ×¢× ×¢×¨×›×™× ×œ× ×ª×§×™× ×™× ×œ××˜×¨×•×ª ×‘×“×™×§×”</p>
                <ul>
                    <li><strong>Bad checksums:</strong> ×–×™×”×•×™ firewalls ××–×•×™×¤×™×</li>
                    <li><strong>Invalid flags:</strong> ×‘×“×™×§×ª TCP stacks</li>
                    <li><strong>Wrong versions:</strong> fingerprinting</li>
                </ul>
            </div>

            <button class="demo-button" onclick="toggleSolution('solution6')">ğŸ”“ ×”×¦×’ ×“×•×’×××•×ª</button>

            <div id="solution6" class="solution-content">
                <h3 style="color: #28a745;">âœ… ×“×•×’×××•×ª:</h3>
                <pre class="code-block">
<code>from scapy.all import *

# 1. Detect Fake TCP Stack (××”-PDF)
def detect_fake_tcp(target):
    """×–×™×”×•×™ TCP stack ××–×•×™×£"""
    print(f"ğŸ” Testing {target}...\n")
    
    # IP checksum × ×›×•×Ÿ, TCP checksum ×©×’×•×™
    packet = IP(dst=target)/TCP(dport=(1,1024), chksum=0xBAD)
    
    res, unans = sr(packet, timeout=2, verbose=0)
    
    if res:
        print("âš ï¸ Fake TCP responses!")
        res.summary()
    else:
        print("âœ… Legitimate TCP stack")

# 2. XMAS Scan - FIN+URG+PSH
def xmas_scan(target, ports=[80, 443]):
    """×“×’×œ×™× ×©×œ× ×××•×¨×™× ×‘×™×—×“"""
    packet = IP(dst=target)/TCP(dport=ports, flags="FPU")
    res, unans = sr(packet, timeout=2, verbose=0)
    
    # ××™×Ÿ ×ª×’×•×‘×” = ×¤×•×¨×˜ ×¤×ª×•×—/××¡×•× ×Ÿ
    print(f"No response: {[p[TCP].dport for p in unans]}")

# 3. NULL Scan - ×‘×œ×™ ×“×’×œ×™×
def null_scan(target, ports=[80, 443]):
    """TCP ×œ×œ× ×“×’×œ×™×"""
    packet = IP(dst=target)/TCP(dport=ports, flags="")
    res, unans = sr(packet, timeout=2, verbose=0)
    
    print(f"Possible open: {[p[TCP].dport for p in unans]}")

# 4. Invalid IP Version
def invalid_ip_version(target):
    """IP version ×©×’×•×™×”"""
    packet = IP(dst=target, version=3, ihl=2)/ICMP()
    print("Testing with IP version=3 (doesn't exist)")</code>
                </pre>
            </div>
        </div>

        <!-- Slide 14: VLAN Hopping -->
        <div class="slide">
            <h1>ğŸŒ ×ª×¨×’×™×œ 7: VLAN Hopping + ARP Poisoning</h1>

            <div class="warning-box critical">
                <h2>ğŸš¨ ×”×ª×§×¤×” ××ª×§×“××ª - ×œ×™××•×“×™ ×‘×œ×‘×“!</h2>
                <p>×©×™×œ×•×‘ ×©×œ VLAN Hopping ×•-ARP Poisoning</p>
            </div>

            <div class="tip-box">
                <h3>××”×• VLAN Hopping?</h3>
                <p>×¢×§×™×¤×ª ×”×¤×¨×“×ª VLANs ×‘×××¦×¢×•×ª Double Tagging (802.1Q)</p>
                <ul>
                    <li>×©×œ×™×—×ª ×¤×§×˜×” ×¢× 2 ×ª×’×™ VLAN</li>
                    <li>Switch ×¨××©×•×Ÿ ××¡×™×¨ ×ª×’ ××—×“</li>
                    <li>Switch ×©× ×™ ×¨×•××” VLAN ××—×¨</li>
                </ul>
            </div>

            <button class="demo-button" onclick="toggleSolution('solution7')">ğŸ”“ ×”×¦×’ ×§×•×“</button>

            <div id="solution7" class="solution-content">
                <h3 style="color: #dc3545;">âš ï¸ ××”-PDF ×©×œ Philippe Biondi:</h3>
                <pre class="code-block">
<code>from scapy.all import *

# Classic ARP Poisoning
classic_arp = Ether(dst=client_mac) / ARP(
    op="who-has",
    psrc=gateway_ip,  # ×”×ª×—×–×•×ª ×œ×’×™×™×˜×•×•×™
    pdst=client_ip
)

# VLAN Hopping with Double 802.1Q
vlan_hop_arp = Ether(dst=client_mac) / Dot1Q(vlan=1) / Dot1Q(vlan=2) / ARP(
    op="who-has",
    psrc=gateway_ip,
    pdst=client_ip
)

# âš ï¸ Effect:
# Switch 1 removes VLAN 1 â†’ Switch 2 sees VLAN 2
# Client thinks gateway MAC is ours
# All traffic goes through attacker (MITM)

# âš ï¸ ×œ× ×©×•×œ×—×™× ×‘×¤×•×¢×œ!
# send(vlan_hop_arp, inter=RandNum(10,40), loop=1)

# ğŸ›¡ï¸ ×”×’× ×”:
# - Disable DTP
# - Explicit trunk configuration  
# - Native VLAN tagging
# - Port security</code>
                </pre>
            </div>
        </div>

        <!-- Slide 15: IP Protocol Scan -->
        <div class="slide">
            <h1>ğŸ” ×ª×¨×’×™×œ 8: IP Protocol Scan</h1>

            <div class="tip-box">
                <h3>××”×• IP Protocol Scan?</h3>
                <p>×¡×¨×™×§×ª ×›×œ ×”-protocols ×”××¤×©×¨×™×™× (0-255) ×‘×©×“×” IP Protocol</p>
                <ul>
                    <li>ICMP Protocol Unreachable = ×œ× × ×ª××š</li>
                    <li>××™×Ÿ ×ª×©×•×‘×” = protocol ××•×›×¨</li>
                    <li>×©×™××•×©×™ ×œ×’×™×œ×•×™ firewalls</li>
                </ul>
            </div>

            <button class="demo-button" onclick="toggleSolution('solution8')">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>

            <div id="solution8" class="solution-content">
                <h3 style="color: #28a745;">âœ… ××”-PDF:</h3>
                <pre class="code-block">
<code>from scapy.all import *

def ip_protocol_scan(target):
    """×¡×•×¨×§ protocols 0-255"""
    print(f"ğŸ” IP Protocol Scan: {target}\n")
    
    # Payload "XX" ×—×©×•×‘!
    packets = IP(dst=target, proto=(0,255)) / "XX"
    
    res, unans = sr(packets, timeout=2, verbose=0)
    
    recognized = []
    for sent in unans:
        # ×œ× ×§×™×‘×œ× ×• ×ª×©×•×‘×” = ××•×›×¨!
        recognized.append(sent[IP].proto)
    
    print(f"âœ… Recognized: {recognized}")
    return recognized

# ×¢× TTL ××•×ª×× - ×œ×–×™×”×•×™ firewall
def ip_protocol_scan_ttl(target, ttl=7):
    """Protocol scan ×¢× TTL × ××•×š"""
    packets = IP(dst=target, proto=(0,255), ttl=ttl) / "XX"
    
    res, unans = sr(packets, timeout=2, verbose=0, retry=-2)
    
    passed_router = []
    for sent, rcvd in res:
        if rcvd.haslayer(ICMP) and rcvd[ICMP].type == 11:
            # Time Exceeded = ×¢×‘×¨ ×“×¨×š ×”×¨××•×˜×¨
            passed_router.append(sent[IP].proto)
    
    filtered = [s[IP].proto for s in unans]
    
    print(f"âœ… Passed: {passed_router}")
    print(f"ğŸ›¡ï¸ Filtered: {len(filtered)} protocols")</code>
                </pre>
            </div>
        </div>

        <!-- Slide 16: TTL Tricks -->
        <div class="slide">
            <h1>â±ï¸ ×ª×¨×’×™×œ 9: TTL Tricks</h1>

            <div class="tip-box">
                <h3>×˜×¨×™×§×™× ×¢× TTL:</h3>
                <ul>
                    <li><strong>TTL Mapping:</strong> ××™×¤×•×™ topology ×”×¨×©×ª</li>
                    <li><strong>Firewall Detection:</strong> ×–×™×”×•×™ × ×§×•×“×•×ª ×¡×™× ×•×Ÿ</li>
                    <li><strong>OS Fingerprinting:</strong> ×–×™×”×•×™ ××¢×¨×›×•×ª</li>
                </ul>
            </div>

            <button class="demo-button" onclick="toggleSolution('solution9')">ğŸ”“ ×”×¦×’ ×˜×›× ×™×§×•×ª</button>

            <div id="solution9" class="solution-content">
                <h3 style="color: #28a745;">âœ… ×˜×›× ×™×§×•×ª:</h3>
                <pre class="code-block">
<code>from scapy.all import *

# 1. TCP SYN with specific TTL (××”-PDF)
def tcp_syn_ttl_scan(target_net, ttl=10):
    """×‘×“×™×§×” ××™ ×œ× ×©×œ×— Time Exceeded"""
    packets = IP(dst=f"{target_net}/24", ttl=ttl)/TCP(dport=80, flags="S")
    
    res, unans = sr(packets, timeout=2, verbose=0)
    
    got_tcp = [sent[IP].dst for sent, rcvd in res if rcvd.haslayer(TCP)]
    no_response = [sent[IP].dst for sent in unans]
    
    print(f"IPs that didn't send Time Exceeded: {got_tcp + no_response}")

# 2. OS Fingerprinting by TTL
def guess_os_by_ttl(target):
    """× ×™×—×•×© OS ×œ×¤×™ TTL"""
    reply = sr1(IP(dst=target)/ICMP(), timeout=2, verbose=0)
    
    if reply:
        ttl = reply[IP].ttl
        if 62 <= ttl <= 65:
            return "Linux (TTL 64)"
        elif 126 <= ttl <= 129:
            return "Windows (TTL 128)"
        elif 254 <= ttl <= 256:
            return "Cisco (TTL 255)"

# 3. Firewall Detection
def detect_firewall_ttl(target):
    """×–×™×”×•×™ firewall ×¢×œ ×™×“×™ TTL anomalies"""
    for ttl in range(1, 15):
        icmp_reply = sr1(IP(dst=target, ttl=ttl)/ICMP(), timeout=1, verbose=0)
        tcp_reply = sr1(IP(dst=target, ttl=ttl)/TCP(dport=80, flags="S"), timeout=1, verbose=0)
        
        if icmp_reply and not tcp_reply:
            print(f"ğŸš¨ Firewall at hop {ttl}!")
            return ttl</code>
                </pre>
            </div>
        </div>

        <!-- Slide 17: ×¡×™×›×•× -->
        <div class="slide">
            <h1>ğŸ“ ×¡×™×›×•× ×”××¦×’×ª</h1>

            <h2>âœ¨ ××” ×œ××“× ×•?</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="success-box">
                    <h3>×˜×›× ×™×§×•×ª ×‘×¡×™×¡×™×•×ª</h3>
                    <ul>
                        <li>TCP Ping</li>
                        <li>Traceroute</li>
                        <li>DNS Resolution</li>
                        <li>Port Scanning</li>
                    </ul>
                </div>

                <div class="tip-box">
                    <h3>×˜×›× ×™×§×•×ª ××ª×§×“××•×ª</h3>
                    <ul>
                        <li>Fragmentation Attacks</li>
                        <li>Malformed Packets</li>
                        <li>VLAN Hopping</li>
                        <li>IP Protocol Scan</li>
                        <li>TTL Tricks</li>
                    </ul>
                </div>
            </div>

            <div class="warning-box" style="margin-top: 25px;">
                <h2>ğŸ’¡ ×˜×™×¤×™× ×—×©×•×‘×™×</h2>
                <ul>
                    <li><strong>×”×‘×Ÿ ××ª ×”×¤×¨×•×˜×•×§×•×œ:</strong> ×§×¨× RFCs ×œ×¤× ×™ ×¡×¨×™×§×•×ª</li>
                    <li><strong>×‘×“×•×§ ×”×¨×©××•×ª:</strong> sudo/Administrator × ×“×¨×©×™×</li>
                    <li><strong>verbose=0:</strong> ×œ×× ×™×¢×ª ×¤×œ×˜ ××™×•×ª×¨</li>
                    <li><strong>timeout ×—×›×:</strong> ××™×–×•×Ÿ ×‘×™×Ÿ ××”×™×¨×•×ª ×œ×“×™×•×§</li>
                    <li><strong>×©××•×¨ ×ª×•×¦××•×ª:</strong> wrpcap() ×œ×©××™×¨×ª ×—×‘×™×œ×•×ª</li>
                </ul>
            </div>

            <div class="tip-box" style="margin-top: 20px;">
                <h2>ğŸ”§ ×¤×•× ×§×¦×™×•×ª ×©×™××•×©×™×•×ª</h2>
                <pre class="code-block">
<code># ×”×¦×’×ª ×©×“×•×ª
ls(IP)
ls(TCP)

# ×¤×™×œ×˜×¨×™×
lfilter = lambda x: TCP in x and x[TCP].flags == "S"

# ×¢×™×‘×•×“ ×‘×–××Ÿ ×××ª
sniff(prn=lambda x: print(x.summary()), filter="tcp")

# ×©××™×¨×” ×•×˜×¢×™× ×”
wrpcap("file.pcap", packets)
packets = rdpcap("file.pcap")</code>
                </pre>
            </div>
        </div>

        <!-- Slide 18: ××©××‘×™× -->
        <div class="slide">
            <h1>ğŸ“š ××©××‘×™× × ×•×¡×¤×™×</h1>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 25px;">
                <div class="tip-box">
                    <h3>ğŸ“– ×ª×™×¢×•×“ ×¨×©××™</h3>
                    <ul>
                        <li>scapy.net</li>
                        <li>scapy.readthedocs.io</li>
                        <li>github.com/secdev/scapy</li>
                    </ul>
                </div>

                <div class="tip-box">
                    <h3>ğŸ“„ ××××¨×™×</h3>
                    <ul>
                        <li>Philippe Biondi - CanSecWest 2005</li>
                        <li>Scapy in 15 minutes</li>
                        <li>Network Programming with Scapy</li>
                    </ul>
                </div>

                <div class="tip-box">
                    <h3>ğŸ¥ ×•×™×“××•</h3>
                    <ul>
                        <li>Scapy Tutorial - YouTube</li>
                        <li>Network Security courses</li>
                        <li>CTF Write-ups</li>
                    </ul>
                </div>

                <div class="tip-box">
                    <h3>ğŸ› ï¸ ×›×œ×™× × ×•×¡×¤×™×</h3>
                    <ul>
                        <li>Wireshark (× ×™×ª×•×—)</li>
                        <li>tcpdump (×”×¡× ×¤×”)</li>
                        <li>nmap (×¡×¨×™×§×•×ª)</li>
                        <li>hping3 (packet crafting)</li>
                    </ul>
                </div>
            </div>

            <div class="success-box" style="margin-top: 25px;">
                <h2>ğŸš€ ××” ×”×œ××”?</h2>
                <ul>
                    <li>×ª×¨×’×•×œ ×‘××¢×‘×“×” ×•×™×¨×˜×•××œ×™×ª</li>
                    <li>×”×©×ª×ª×¤×•×ª ×‘-CTF challenges</li>
                    <li>×œ××™×“×ª ×¤×¨×•×˜×•×§×•×œ×™× ××ª×§×“××™×</li>
                    <li>×‘× ×™×™×ª ×›×œ×™ automation</li>
                    <li>×ª×¨×•××” ×œ×§×•×“ ×¤×ª×•×—</li>
                </ul>
            </div>

            <div class="warning-box critical" style="margin-top: 25px;">
                <h2>âš–ï¸ ×ª×–×›×•×¨×ª ××—×¨×•× ×”</h2>
                <p><strong>×›×œ ×”×˜×›× ×™×§×•×ª ×›××Ÿ ×”×Ÿ ×œ×—×™× ×•×š ×‘×œ×‘×“!</strong></p>
                <ul>
                    <li>ğŸš« ××œ ×ª×¨×™×¥ ×¢×œ ×¨×©×ª×•×ª ×™×™×¦×•×¨</li>
                    <li>ğŸš« ××œ ×ª×¡×¨×•×§ ×œ×œ× ×”×¨×©××”</li>
                    <li>âœ… ×¨×§ ×‘××¢×‘×“×•×ª ×‘×§×¨×”</li>
                    <li>âœ… ×§×‘×œ ×”×¨×©××” ×‘×›×ª×‘</li>
                </ul>
            </div>

            <div style="text-align: center; margin-top: 50px; font-size: 2em;">
                <p>ğŸ‰ ×ª×•×“×” ×¨×‘×”! ğŸ‰</p>
                <p style="font-size: 0.6em; color: #666; margin-top: 20px;">
                    ××‘×•×¡×¡ ×¢×œ Philippe Biondi - CanSecWest 2005
                </p>
            </div>
        </div>
    </div>

    <div class="controls">
        <button class="btn btn-prev" id="prevBtn" onclick="changeSlide(-1)">â­ï¸ ×”×§×•×“×</button>
        <button class="btn btn-next" id="nextBtn" onclick="changeSlide(1)">×”×‘× â®ï¸</button>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function showSlide(n) {
            slides[currentSlide].classList.remove('active');
            currentSlide = (n + totalSlides) % totalSlides;
            slides[currentSlide].classList.add('active');

            document.getElementById('slideNumber').textContent = `×©×§×•×¤×™×ª ${currentSlide + 1} / ${totalSlides}`;

            document.getElementById('prevBtn').disabled = currentSlide === 0;
            document.getElementById('nextBtn').disabled = currentSlide === totalSlides - 1;
        }

        function changeSlide(direction) {
            showSlide(currentSlide + direction);
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changeSlide(1);
            if (e.key === 'ArrowRight') changeSlide(-1);
        });

        // Toggle solution visibility
        function toggleSolution(solutionId) {
            const solution = document.getElementById(solutionId);
            solution.classList.toggle('visible');
        }

        // Quiz functionality
        function checkAnswer(element, isCorrect) {
            const options = element.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.classList.remove('correct', 'wrong');
            });

            if (isCorrect) {
                element.classList.add('correct');
                setTimeout(() => alert('âœ… × ×›×•×Ÿ! ×›×œ ×”×›×‘×•×“!'), 100);
            } else {
                element.classList.add('wrong');
                setTimeout(() => alert('âŒ ×œ× × ×›×•×Ÿ, × ×¡×” ×©×•×‘!'), 100);
            }
        }

        // Initialize
        showSlide(0);
    </script>
</body>
</html>