<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××ª×’×¨ CTF: × ×™×ª×•×— ×—×‘×™×œ×•×ª ×¨×©×ª ğŸ”</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .emoji {
            font-size: 3em;
            margin: 10px 0;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .mission-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(245, 87, 108, 0.3);
        }

        .mission-box h2 {
            font-size: 1.8em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mission-box p {
            font-size: 1.1em;
            line-height: 1.6;
        }

        .download-section {
            background: #e8f5e9;
            border: 3px solid #4caf50;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            text-align: center;
        }

        .download-btn {
            display: inline-block;
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            text-decoration: none;
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.6);
        }

        .hints-section {
            background: #fff3e0;
            border-right: 5px solid #ff9800;
            padding: 25px;
            border-radius: 10px;
            margin: 30px 0;
        }

        .hints-section h3 {
            color: #f57c00;
            font-size: 1.5em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hint-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            align-items: start;
            gap: 15px;
        }

        .hint-number {
            background: #ff9800;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .code-section {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
            border: 2px solid #ddd;
        }

        .code-section h3 {
            color: #1e3c72;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-box {
            background: #263238;
            color: #aed581;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            direction: ltr;
            text-align: left;
        }

        .code-box .comment {
            color: #78909c;
        }

        .code-box .keyword {
            color: #c792ea;
        }

        .code-box .string {
            color: #c3e88d;
        }

        .code-box .function {
            color: #82aaff;
        }

        .steps-section {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 25px;
            margin: 30px 0;
        }

        .steps-section h3 {
            color: #1565c0;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .step {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-right: 4px solid #2196f3;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .flag-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }

        .flag-section h3 {
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        .flag-input {
            width: 100%;
            max-width: 500px;
            padding: 15px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
            direction: ltr;
        }

        .submit-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .submit-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .result-message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            display: none;
        }

        .success {
            background: #4caf50;
            color: white;
        }

        .error {
            background: #f44336;
            color: white;
        }

        .tip-box {
            background: #fff9c4;
            border: 2px solid #fbc02d;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .tip-box strong {
            color: #f57f17;
            font-size: 1.2em;
        }

        .footer {
            background: #f5f5f5;
            padding: 20px;
            text-align: center;
            color: #666;
            border-top: 2px solid #ddd;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
            
            .code-box {
                font-size: 0.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="emoji">ğŸ”ğŸŒğŸ’»</div>
            <h1>××ª×’×¨ CTF: × ×™×ª×•×— ×—×‘×™×œ×•×ª ×¨×©×ª</h1>
            <p>×›×™×ª×” ×™"× - ××¡×œ×•×œ ×¡×™×™×‘×¨</p>
        </div>

        <div class="content">
            <div class="mission-box">
                <h2>ğŸ¯ ×”×ª×¨×—×™×©</h2>
                <p>×‘×–××Ÿ ×—×§×™×¨×ª ×¨×©×ª ×—×©×•×“×”, ×”×¦×œ×—×ª ×œ×ª×¤×•×¡ ×§×•×‘×¥ <strong>secret_traffic.pcap</strong> ×”××›×™×œ ×ª×¢×‘×•×¨×ª ×¨×©×ª ××¡×ª×•×¨×™×ª.</p>
                <p>×”××•×“×™×¢×™×Ÿ ×©×œ× ×• ××××™×Ÿ ×©×”×§×‘×•×¦×” ×”×–×• ××¢×‘×™×¨×” ××¡×¨×™× ×—×©××™×™× ×‘×ª×•×š ×”×ª×¢×‘×•×¨×ª ×”×¨×’×™×œ×” ×©×œ×”×.</p>
                <p><strong>×”××©×™××” ×©×œ×š:</strong> ×œ××¦×•× ××ª ×”×“×’×œ ×”× ×¡×ª×¨ ×‘×ª×•×š ×”×ª×¢×‘×•×¨×ª!</p>
            </div>

            <div class="download-section">
                <h3>ğŸ“¦ ×”×•×¨×“ ××ª ×§×•×‘×¥ ×”×ª×¢×‘×•×¨×ª</h3>
                <p>×§×•×‘×¥ ×”-PCAP ××›×™×œ ××ª ×›×œ ×”×ª×¢×‘×•×¨×ª ×”×¨×œ×•×•× ×˜×™×ª</p>
                <a href="https://drive.google.com/file/d/11TCLn9YrzFdIgD3vnk-j6halS2HdRWZp/view?usp=sharing"
                   class="download-btn"
                   target="_blank"
                   rel="noopener noreferrer">
                    â¬‡ï¸ ×”×•×¨×“ secret_traffic.pcap
                </a>
            </div>

            <div class="hints-section">
                <h3>ğŸ’¡ ×¨××–×™× ×—×©×•×‘×™×</h3>
                <div class="hint-item">
                    <div class="hint-number">1</div>
                    <div>×”×“×’×œ ××—×•×œ×§ ×œ-<strong>3 ×—×œ×§×™×</strong> ×©×¦×¨×™×š ×œ×—×‘×¨ ×‘×¡×“×¨ ×”× ×›×•×Ÿ</div>
                </div>
                <div class="hint-item">
                    <div class="hint-number">2</div>
                    <div>×—×¤×© ×‘×—×‘×™×œ×•×ª <strong>HTTP</strong> - ×™×© ×©× headers ××™×•×—×“×™×</div>
                </div>
                <div class="hint-item">
                    <div class="hint-number">3</div>
                    <div>×—×¤×© ×‘×©××™×œ×ª×•×ª <strong>DNS</strong> - ×“×•××™×™× ×™× ××¢× ×™×™× ×™×</div>
                </div>
                <div class="hint-item">
                    <div class="hint-number">4</div>
                    <div>×—×¤×© ×¨××–×™× ×œ×¡×“×¨ - ×©××•×ª ×›××• <strong>"part1", "part2", "final"</strong> ×•×›×“×•××”</div>
                </div>
                <div class="hint-item">
                    <div class="hint-number">5</div>
                    <div>×—×œ×§ ××”××™×“×¢ ××§×•×“×“ ×‘-<strong>Base64</strong> - ×ª×¦×˜×¨×š ×œ×¤×¢× ×— ××•×ª×•!</div>
                </div>
            </div>

            <pre class="code-section">
                <h3>ğŸ’» ×§×•×“ ×¢×–×¨ ×œ×”×ª×—×œ×”</h3>
                <div class="code-box">
<span class="keyword">from</span> scapy.all <span class="keyword">import</span> *
<span class="keyword">import</span> base64
<span class="keyword">import</span> re

<span class="comment"># ×§×¨×™××ª ×§×•×‘×¥ pcap</span>
packets = <span class="function">rdpcap</span>(<span class="string">"secret_traffic.pcap"</span>)
<span class="function">print</span>(<span class="string">f"× ××¦××• {len(packets)} ×—×‘×™×œ×•×ª\n"</span>)

<span class="comment"># × ××—×¡×Ÿ ××ª ×”×—×œ×§×™× ×¢× ×”××™×§×•× ×©×œ×”×</span>
flag_parts = {}

<span class="keyword">for</span> i, packet <span class="keyword">in</span> <span class="function">enumerate</span>(packets):
    <span class="function">print</span>(<span class="string">f"×—×‘×™×œ×” {i}:"</span>)
    
    <span class="comment"># ×‘×“×™×§×ª ×—×‘×™×œ×•×ª HTTP</span>
    <span class="keyword">if</span> packet.<span class="function">haslayer</span>(Raw):
        data = packet[Raw].load.<span class="function">decode</span>(<span class="string">'utf-8'</span>, errors=<span class="string">'ignore'</span>)
        
        <span class="comment"># ×—×™×¤×•×© ××—×¨ headers ××™×•×—×“×™×</span>
        <span class="keyword">if</span> <span class="string">"X-Flag-Part"</span> <span class="keyword">in</span> data:
            <span class="function">print</span>(<span class="string">"ğŸš© × ××¦× header ×©×œ ×“×’×œ!"</span>)
            <span class="function">print</span>(<span class="string">f"ğŸ“„ ×ª×•×›×Ÿ: {data[:200]}..."</span>)
        
        <span class="keyword">if</span> <span class="string">"X-Final-Part"</span> <span class="keyword">in</span> data:
            <span class="function">print</span>(<span class="string">"ğŸ¯ × ××¦× ×”×—×œ×§ ×”×¡×•×¤×™!"</span>)
    
    <span class="comment"># ×‘×“×™×§×ª ×©××™×œ×ª×•×ª DNS</span>
    <span class="keyword">if</span> packet.<span class="function">haslayer</span>(DNS) <span class="keyword">and</span> packet[DNS].qd:
        domain = packet[DNS].qd.qname.<span class="function">decode</span>()
        <span class="keyword">if</span> <span class="string">"ctf.com"</span> <span class="keyword">in</span> domain:
            <span class="function">print</span>(<span class="string">f"ğŸŒ DNS ×—×©×•×“: {domain}"</span>)
    
    <span class="comment"># ×©×•×¨×” ×¨×™×§×” ×œ×§×¨×™××•×ª</span>
    <span class="function">print</span>()

<span class="comment"># ×›××Ÿ ×ª×•×¡×™×£ ×§×•×“ ×œ×—×™×œ×•×¥ ×•×œ×¤×¢× ×•×— ×”×—×œ×§×™×...</span>
                </div>
            </pre>

            <div class="steps-section">
                <h3>ğŸ“‹ ××” ×©×›×“××™ ×œ×¢×©×•×ª ×¦×¢×“ ××—×¨ ×¦×¢×“</h3>
                <div class="step">
                    <strong>×©×œ×‘ 1:</strong> ×”×¨×¥ ××ª ×”×§×•×“ ×”×‘×¡×™×¡×™ ×•×¨××” ××™×œ×• ×—×‘×™×œ×•×ª ××¢× ×™×™× ×•×ª ×™×©
                </div>
                <div class="step">
                    <strong>×©×œ×‘ 2:</strong> ×–×”×” ××ª ×©×œ×•×©×ª ×”×—×œ×§×™× ×•××ª ×”×¡×“×¨ ×©×œ×”×
                </div>
                <div class="step">
                    <strong>×©×œ×‘ 3:</strong> ×—×œ×¥ ××ª ×”××™×“×¢ ××›×œ ×—×œ×§
                </div>
                <div class="step">
                    <strong>×©×œ×‘ 4:</strong> ×¤×¢× ×— Base64 ×‘××§×•× ×”× ×¦×¨×š
                </div>
                <div class="step">
                    <strong>×©×œ×‘ 5:</strong> ×—×‘×¨ ××ª ×›×œ ×”×—×œ×§×™× ×‘×¡×“×¨ ×”× ×›×•×Ÿ
                </div>
            </div>

            <div class="tip-box">
                <strong>ğŸ’¡ ×˜×™×¤ ××—×¨×•×Ÿ:</strong><br>
                ×× ××ª×” ×ª×§×•×¢, ×”×“×¤×¡ ××ª ×›×œ ×”-headers ×©×œ HTTP ×•×”×“×•××™×™× ×™× ×©×œ DNS - ×”×¨××–×™× ×©×! ğŸ”
            </div>

            <div class="flag-section">
                <h3>ğŸš© ×”×’×© ××ª ×”×“×’×œ</h3>
                <p>×¤×•×¨××˜ ×”×“×’×œ: <strong>FLAG{something_here}</strong></p>
                <input type="text" id="flagInput" class="flag-input" placeholder="×”×›× ×¡ ××ª ×”×“×’×œ ×›××Ÿ..." />
                <br>
                <button onclick="checkFlag()" class="submit-btn">âœ… ×‘×“×•×§ ×“×’×œ</button>
                <div id="result" class="result-message"></div>
            </div>
        </div>

        <div class="footer">
            <p>×‘×”×¦×œ×—×”! ğŸ‰ | ×‘×™×ª ×¡×¤×¨ ×‘×œ×™×š - ××¡×œ×•×œ ×¡×™×™×‘×¨</p>
            <p style="margin-top: 10px; font-size: 0.9em;">ğŸ’ª ××ª× ×™×›×•×œ×™×!</p>
        </div>
    </div>

    <script>
         async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        async function checkFlag() {
            const input = document.getElementById('flagInput').value.trim();
            const result = document.getElementById('result');

            // ×”××¨×ª ×”×§×œ×˜ ×œ-hash
            const inputHash = await sha256(input);

            // ×›××Ÿ ×ª×•×›×œ ×œ×”×’×“×™×¨ ××ª ×”×“×’×œ ×”× ×›×•×Ÿ
            // ×œ×“×•×’××”: const correctFlag = "FLAG{network_forensics_master}";
            const correctFlag = "FLAG{example_flag_here}"; // ×”×—×œ×£ ×‘×“×’×œ ×”×××™×ª×™
            const correctHashFlag = "f099f57d9c468c22a6e1db81fa0cf89301228dfa080ac42875710795cdd69b17";
            
            result.style.display = 'block';
            
            if (input === '') {
                result.className = 'result-message error';
                result.textContent = 'âš ï¸ ×× × ×”×›× ×¡ ×“×’×œ!';
                return;
            }
            
            if (inputHash === correctHashFlag) {
                result.className = 'result-message success';
                result.textContent = 'ğŸ‰ ××¢×•×œ×”! ×¤×ª×¨×ª ××ª ×”××ª×’×¨! ×”×“×’×œ × ×›×•×Ÿ! ğŸ†';
                
                // ××¤×©×¨ ×œ×”×•×¡×™×£ ×›××Ÿ ×©××™×¨×” ×œ××¢×¨×›×ª ××• ×”×•×“×¢×” ×œ××•×¨×”
                console.log('Student solved the challenge!');
            } else {
                result.className = 'result-message error';
                result.textContent = 'âŒ ×”×“×’×œ ×œ× × ×›×•×Ÿ. × ×¡×” ×©×•×‘! ×¨××–: ×‘×“×•×§ ××ª ×”×¤×•×¨××˜ ×•××ª ×¡×“×¨ ×”×—×œ×§×™×';
            }
        }
        
        // ××¤×©×¨×•×ª ×œ×”×’×©×” ×¢× Enter
        document.getElementById('flagInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                checkFlag();
            }
        });
    </script>
</body>
</html>
